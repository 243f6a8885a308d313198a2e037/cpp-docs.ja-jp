---
title: アンワインド プロシージャ |Microsoft ドキュメント
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-tools
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: 82c5d0ca-70be-4d1a-a306-bfe01c29159f
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 5e2a5af5d8db5974aa10595bbd3bac1cd032a0f4
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/03/2018
---
# <a name="unwind-procedure"></a>アンワインド プロシージャ
アンワインド コード配列は、降順に並べ替えられます。 例外が発生する場合は、完全なコンテキストがコンテキスト レコードのオペレーティング システムで格納されます。 例外のディスパッチ ロジックが呼び出され、例外ハンドラーを検索する次の手順を繰り返し実行します。  
  
1.  コンテキスト レコードに格納されている現在の RIP を使用して、現在の関数 (またはチェーン UNWIND_INFO エントリの場合、関数の部分) を記述する RUNTIME_FUNCTION テーブル エントリを検索します。  
  
2.  関数テーブルのエントリが見つからない場合は、リーフ関数内にあるし、RSP は戻り値のポインターを直接対処します。 [RSP] に戻り値のポインターが更新済みのコンテキストに格納されている、シミュレートされた RSP は 8、ずつインクリメントされ、手順 1. が繰り返されます。  
  
3.  関数のテーブルのエントリが見つかった場合は、RIP が) エピローグ、b) では、プロローグまたは c) に、例外ハンドラーによって処理されるコードの 3 つの領域内にことができます。  
  
    -   大文字、) かどうかは、エピローグ内に、RIP コントロールは、関数のまま、することはできません、この機能は、この例外に関連付けられている例外ハンドラーし、呼び出し元関数のコンテキストを計算する、エピローグの効果を続行する必要があります。 RIP エピローグ、RIP からコード ストリーム内にあるかどうかを調べる検査されます。 そのコード ストリームは、正規のエピローグの末尾部分とを照合できるし、エピローグ内にある、エピローグの残りの部分がシミュレートされる、各命令として更新コンテキスト レコードが処理されます。 その後、手順 1. が繰り返されます。  
  
    -   ケース b) に、RIP が内に、プロローグでは、コントロールがない場合は、関数を入力することはできません、この機能は、この例外に関連付けられている例外ハンドラー、プロローグの効果は、呼び出し元関数のコンテキストの計算に取り消す必要があります。 RIP はプロローグ内では、RIP 関数の開始からの距離がプロローグのアンワインド情報でエンコードされたサイズに等しいまたはそれよりも小さい場合です。 アンワインド コード配列を最初のエントリのオフセットを小さい関数の開始から RIP のオフセットと等しいかそれよりも前方向にスキャンし、アンワインド コード配列内の残りのすべての項目の効果を元に戻すには、プロローグの効果がアンワインドします。 手順 1 が繰り返されます。  
  
    -   ケース c)、RIP がプロローグまたはエピローグと、関数内にない場合 (が存在する UNW_FLAG_EHANDLER が設定されます)、例外ハンドラーを言語固有のハンドラーが呼び出されます。 ハンドラーがそのデータをスキャンし、フィルターとして適切な関数を呼び出します。 例外が処理されたことや、検索で続行するのには、言語固有のハンドラーを返すことができます。 実行することも、アンワインド直接です。  
  
4.  言語固有のハンドラーが処理済みの状態を返すかどうかは、実行が継続元のコンテキスト レコードを使用します。  
  
5.  言語固有のハンドラーがないか、ハンドラーには、[検索を続行する] の状態が返される場合、は、コンテキスト レコードが、呼び出し元の状態をアンワインドしてください。 これは、すべてのそれぞれの効果を元に戻す、アンワインド コード配列要素を処理することで行います。 手順 1 が繰り返されます。  
  
 チェーン アンワインド情報が含まれる、基本的な手順が実行されます。 唯一の違いは、配列の末尾に達した後は、プロローグの効果をアンワインドするアンワインド コード配列をウォーク、しにリンクされている親アンワインド情報と、アンワインド コード配列全体が見つかりましたが走査中にします。 このリンクにより、アンワインド情報 UNW_CHAINED_INFO フラグなしに到着するまで継続され、そのアンワインド コード配列のウォークを終了します。  
  
 最小セットのアンワインド データは 8 バイトです。 これでのみ以下の場合、またはスタックの 128 バイトを割り当て、可能性のある 1 つの不揮発性レジスタを保存して関数を表します。 これは、チェーンのサイズもアンワインド コードを持たないで長さ 0 のプロローグのアンワインド情報。  
  
## <a name="see-also"></a>関連項目  
 [例外処理 (x64)](../build/exception-handling-x64.md)