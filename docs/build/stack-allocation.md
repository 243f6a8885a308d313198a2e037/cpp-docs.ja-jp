---
title: スタック割り当て |Microsoft ドキュメント
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-tools
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: 098e51f2-eda6-40d0-b149-0b618aa48b47
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: caa6d435db98c7177cbf55b866bb8e5a4a110c1d
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/03/2018
---
# <a name="stack-allocation"></a>スタック割り当て
関数のプロローグは、ローカル変数のスタック領域を割り当てるための保存済みレジスタ、スタック パラメーター、およびパラメーターを登録します。  
  
 パラメーター領域は常に、スタックの一番下にある (alloca が使用する) 場合でもは常に、戻り値のアドレスの横にある任意の関数の呼び出し中にするようにします。 少なくとも 4 つのエントリが含まれていますが、すべてのパラメーターを保持するのに十分な領域が常に呼び出すことができるすべての関数が必要があります。 スタックにはパラメーター自体が戻されない場合でも、登録パラメーターの領域が常に割り当てられている注意してください。呼び出し先は、そのすべてのパラメーター領域が割り当てられていることが保証されます。 自宅の住所は、連続した領域では、呼び出された関数が引数リスト (va_list) や個々 の引数のアドレスを取得する必要がある場合にレジスタ引数必要です。 この領域には、サンクの実行中に、デバッグ オプションとして、レジスタ引数を保存する便利な場所も用意されています (たとえば、かなって引数を簡単に見つけ、自宅の住所プロローグ コード内に格納されている場合、デバッグ中に)。 呼び出された関数が 4 未満のパラメーターを持つ場合でも、これらの 4 つのスタックの場所は、呼び出された関数では、効果的が所有し、他の目的でパラメーターのレジスタの値を保存するだけでなく、呼び出された関数で使用可能性があります。  したがって、呼び出し元可能性があります情報を保存できませんスタックのこの領域で、関数呼び出しの間でします。  
  
 領域が動的に割り当てられた場合 (alloca) 関数で、不揮発性レジスタは、スタックの固定部分のベースをマークするフレーム ポインターとして使用する必要があり、そのレジスタを保存してプロローグで初期化する必要があります。 Alloca を使用する場合、同じ呼び出し元から、同じ呼び出し先への呼び出しによって、そのレジスタ パラメーターに対して異なるホーム アドレスが可能性がありますに注意してください。  
  
 スタックが常に保持 16 バイト (たとえば、戻り値のアドレスがプッシュされた後)、プロローグ内し、で示される場合を除くアライン、[関数型](../build/function-types.md)のフレームの関数の特定のクラスです。  
  
 関数、関数呼び出す場合、非リーフ B. 関数 A のプロローグ スタックのレイアウトの例が既にに割り当てられた領域 B が、スタックの一番下に必要なすべてのレジスタとスタック パラメーターを次に示します。 呼び出しは戻り値のアドレスをプッシュし、B のプロローグが、不揮発性レジスタ、および関数を呼び出すために必要な領域のローカル変数の領域を割り当てます。 B alloca を使用する場合は、ローカル変数/不揮発性レジスタ保存領域とパラメーター スタック領域間の領域が割り当てられます。  
  
 ![AMD 変換例](../build/media/vcamd_conv_ex_5.png "vcAmd_conv_ex_5")  
  
 関数 B が別の関数を呼び出すと、戻り値のアドレスが RCX の自宅の住所のすぐ下プッシュされます。  
  
## <a name="see-also"></a>関連項目  
 [スタックの使用](../build/stack-usage.md)