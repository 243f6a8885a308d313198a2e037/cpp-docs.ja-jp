---
title: "インポート ライブラリとエクスポート ファイルの使用 | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "循環エクスポート"
  - "エクスポート ファイル"
  - "インポート ライブラリ, 使用"
ms.assetid: 2634256a-8aa5-4495-8c9e-6cde10e4ed76
caps.latest.revision: 7
caps.handback.revision: 7
author: "corob-msft"
ms.author: "corob"
manager: "ghogen"
---
# インポート ライブラリとエクスポート ファイルの使用
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

プログラム \(実行可能ファイルまたは DLL ファイル\) がほかのプログラムとエクスポートとインポートの両方を行う場合、または 3 つ以上のプログラムで相互にエクスポートとインポートを行う場合は、これらのプログラムをリンクするコマンドを循環エクスポートに対応させる必要があります。  
  
 循環エクスポートを行わない場合は、ほかのプログラムからのエクスポートを使うプログラムをリンクするときに、エクスポート側のプログラムに対してインポート ライブラリを指定する必要があります。  エクスポート側のプログラムに対するインポート ライブラリは、エクスポート側のプログラムをリンクするときに作成されます。  したがって、インポート側のプログラムをリンクする前に、エクスポート側のプログラムをリンクしておく必要があります。  たとえば、TWO.dll が ONE.dll からインポートする場合は、まず ONE.dll をリンクし、インポート ライブラリ ONE.lib を作成します。  次に、ONE.lib を指定して TWO.dll をリンクします。  リンカーでは、TWO.dll の作成時にそのインポート ライブラリ TWO.lib も作成します。  この TWO.lib は、TWO.dll からインポートするプログラムをリンクするときに使用します。  
  
 これに対し、循環エクスポートを行う場合は、ほかのプログラムからのインポート ライブラリだけでは、相互に依存するすべてのプログラムをリンクできません。  前述の例では、TWO.dll から ONE.dll にエクスポートしようとしても、ONE.dll をリンクするときに、TWO.dll のインポート ライブラリが作成されていません。  循環エクスポートを行う場合は、LIB を使用していずれかのプログラムのインポート ライブラリとエクスポート ファイルを作成する必要があります。  
  
 これにはまず、LIB を実行するプログラムを 1 つ選択します。  LIB コマンドで、そのプログラムのオブジェクトとライブラリをすべて指定し、\/DEF オプションを指定します。  そのプログラムで .def ファイルまたは \/EXPORT を使用している場合は、それらも指定します。  
  
 プログラムのインポート ライブラリ \(.lib\) とエクスポート ファイル \(.exp\) を作成したら、そのインポート ライブラリを使ってほかのプログラムをリンクします。  LINK では、エクスポート側のプログラムをビルドするたびに、インポート ライブラリを作成します。  たとえば、ONE.dll のオブジェクトとエクスポートに対して LIB を実行すると、ONE.lib と ONE.exp が作成されます。  この ONE.lib は、TWO.dll をリンクするときに使用します。このとき、インポート ライブラリ TWO.lib も作成されます。  
  
 最後に、最初のプログラムをリンクします。  LINK コマンドで、最初のプログラムのオブジェクトとライブラリ、LIB で作成されたそのプログラムの .exp ファイル、およびそのプログラムで使うエクスポートのインポート ライブラリを指定します。  この例では、ONE.dll の LINK コマンドで、ONE.exp と TWO.lib のほかに、ONE.dll で使うオブジェクトとライブラリも指定します。  .def ファイルまたは \/EXPORT は指定しないでください。エクスポートの定義は .exp ファイルに含まれているため、必要ありません。  .exp ファイルを使ってリンクすると、.exp ファイルの作成時にインポート ライブラリも作成されたものと見なされます。したがって、インポート ライブラリは作成されません。  
  
## 参照  
 [インポート ライブラリとエクスポート ファイル](../../build/reference/working-with-import-libraries-and-export-files.md)