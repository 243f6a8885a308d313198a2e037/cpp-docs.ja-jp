---
title: 'チュートリアル: 作成とスタティック ライブラリ (C++) の使用 |Microsoft Docs'
ms.custom: get-started-article
ms.date: 07/12/2018
ms.technology:
- cpp-windows
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- libraries [C++], static
- static libraries [C++]
ms.assetid: 3cc36411-7d66-4240-851e-dacb9a8fd6ac
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
- uwp
ms.openlocfilehash: d9b71435b4fd2952746b2b097d08008624f8942b
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/19/2018
ms.locfileid: "46412536"
---
# <a name="walkthrough-creating-and-using-a-static-library-c"></a>チュートリアル: スタティック ライブラリの作成と使用 (C++)

このチュートリアルでは、C++ アプリケーションに使用するスタティック ライブラリ (.lib ファイル) を作成する方法について説明します。 スタティック ライブラリを使用すると、コードを有効に再利用できます。 その機能を必要とするアプリケーションごとに同じルーチンを再実装するのではなく、ルーチンを 1 度スタティック ライブラリに記述しておき、アプリケーションからそれを参照します。 スタティック ライブラリからリンクされたコードはアプリケーションの一部となります。コードを使用する別のファイルをインストールする必要はありません。

このチュートリアルでは、次の作業について説明します。

- [スタティック ライブラリ プロジェクトを作成します。](#CreateLibProject)

- [スタティック ライブラリへのクラスの追加](#AddClassToLib)

- [スタティック ライブラリを参照する C++ コンソール アプリケーションの作成](#CreateAppToRefTheLib)

- [アプリでのスタティック ライブラリの機能の使用](#UseLibInApp)

- [アプリの実行](#RunApp)

## <a name="prerequisites"></a>必須コンポーネント

C++ 言語の基本の理解。

##  <a name="CreateLibProject"></a> スタティック ライブラリ プロジェクトを作成します。

### <a name="to-create-a-static-library-project"></a>スタティック ライブラリ プロジェクトを作成するには

1. メニュー バーで、**[ファイル]**  >  **[新規作成]**  >  **[プロジェクト]** を選択します。

2. 左側のウィンドウで、**新しいプロジェクト**] ダイアログ ボックスで、展開**インストールされている、Visual C**、し、[ **Windows デスクトップ**します。

3. 中央のウィンドウで次のように選択します。 **Windows デスクトップ ウィザード**します。

4. プロジェクトの名前を指定 — たとえば、 *MathFuncsLib*-で、**名前**ボックス。 ソリューションの名前を指定 — たとえば、 *StaticLibrary*-で、**ソリューション名**ボックス。 **[OK]** を選択します。

5. **アプリケーションの種類**、スタティック ライブラリ (.lib) を選択します。

6. **追加オプション**、- チェック ボックスをオフ、**プリコンパイル済みヘッダー**チェック ボックスをオンします。

7. その後、**OK** を選択すると、プロジェクトが作成されます。

##  <a name="AddClassToLib"></a> スタティック ライブラリへのクラスの追加

### <a name="to-add-a-class-to-the-static-library"></a>スタティック ライブラリにクラスを追加するには

1. 新しいクラスのヘッダー ファイルを作成するには、ショートカット メニューを開き、 **MathFuncsLib**プロジェクト**ソリューション エクスプ ローラー**を選び、**追加**、**新しい項目**. **[新しい項目の追加]** ダイアログ ボックスの左ウィンドウで、 **[Visual C++]** の下の **[コード]** を選択します。 中央のウィンドウで、 **[ヘッダー ファイル (.h)]** をクリックします。 ヘッダー ファイルの名前を指定 — たとえば、 *MathFuncsLib.h*- 選択し、**追加**ボタン。 空白のヘッダー ファイルが表示されます。

2. という名前のクラスを追加`MyMathFuncs`加算、減算、乗算、および除算などの一般的な数値演算を行います。 コードは次のようになります。

   [!code-cpp[NVC_Walkthrough_Create_Static_Lib#100](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_1.h)]

3. 新しいクラスのソース ファイルを作成するには、ショートカット メニューを開き、 **MathFuncsLib**プロジェクト**ソリューション エクスプ ローラー**、選び、**追加**、**新しい項目**. **[新しい項目の追加]** ダイアログ ボックスの左ウィンドウで、 **[Visual C++]** の下の **[コード]** を選択します。 中央のウィンドウで、 **[C++ ファイル (.cpp)]** をクリックします。 ソース ファイルの名前を指定 — たとえば、 *MathFuncsLib.cpp*- 選択し、**追加**ボタン。 空白のソース ファイルが表示されます。

4. このソース ファイルを使って、 **MyMathFuncs**の機能を実装します。 コードは次のようになります。

   [!code-cpp[NVC_Walkthrough_Create_Static_Lib#110](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_2.cpp)]

5. スタティック ライブラリを選択してコンパイル**ビルド** > **ソリューションのビルド**メニュー バーでします。 これにより、他のプログラムで使用できるスタティック ライブラリが作成されます。

   > [!NOTE]
   > プログラムを Visual Studio のコマンド ラインからビルドする場合、2 つの処理によってビルドする必要があります。 最初に、実行`cl /c /EHsc MathFuncsLib.cpp`コードをコンパイルし、名前は、オブジェクト ファイルを作成する`MathFuncsLib.obj`します。 (`cl` コマンドは、Cl.exe コンパイラを起動し、`/c` オプションはリンクを行わずにコンパイルすることを指定します。 詳細については、次を参照してください[(コンパイル リンクなしの)/c](../build/reference/c-compile-without-linking.md)。)。2 番目に、実行`lib MathFuncsLib.obj`、コードをリンクし、スタティック ライブラリを作成する`MathFuncsLib.lib`します。 (`lib` コマンドは、Lib.exe ライブラリ マネージャーを起動します。 詳細については、「 [LIB Reference](../build/reference/lib-reference.md)」を参照してください)。

##  <a name="CreateAppToRefTheLib"></a> スタティック ライブラリを参照する C++ コンソール アプリケーションの作成

### <a name="to-create-a-c-console-app-that-references-the-static-library"></a>スタティック ライブラリを参照する C++ コンソール アプリケーションを作成するには

1. メニュー バーで、**[ファイル]**  >  **[新規作成]**  >  **[プロジェクト]** を選択します。

2. 左側のウィンドウで、**新しいプロジェクト**] ダイアログ ボックスで、展開**インストールされている、Visual C**、し、[ **Windows デスクトップ**します。

3. 中央のウィンドウで次のように選択します。 **Windows デスクトップ ウィザード**します。

4. プロジェクトの名前を指定 — たとえば、 *MyExecRefsLib*-で、**名前**ボックス。 **[ソリューション]** の横のドロップダウン リストで、 **[ソリューションに追加]** をクリックします。 これにより、スタティック ライブラリを含むソリューションに新しいプロジェクトを追加します。 **[OK]** を選択します。
5. **アプリケーションの種類**、**コンソール アプリケーション (.exe)** します。

6. **Additioal オプション**、- チェック ボックスをオフ、**プリコンパイル済みヘッダー**チェック ボックスをオンします。

7. その後、**OK** を選択すると、プロジェクトが作成されます。

##  <a name="UseLibInApp"></a> アプリでのスタティック ライブラリの機能の使用

### <a name="to-use-the-functionality-from-the-static-library-in-the-app"></a>アプリケーションでのスタティック ライブラリの機能を使用するには

1. コンソール アプリケーションを作成すると、空のプログラムが作成されます。 ソース ファイルの名前は、前の処理で付けた名前と同じになります。 この例では、名前付き`MyExecRefsLib.cpp`します。

2. スタティック ライブラリの数値演算ルーチンを使用するには、それを参照する必要があります。 これを行うには、ショートカット メニューを開き、 **MyExecRefsLib**プロジェクト**ソリューション エクスプ ローラー**、選び、**追加** > **の参照**.

3. **[参照の追加]** ダイアログ ボックスには、参照できるライブラリが表示されます。 **[プロジェクト]** タブでは、現在のソリューション内のプロジェクト、およびそれらに含まれるすべてのライブラリが表示されます。 **[プロジェクト]** タブで、 **MathFuncsLib** のチェック ボックスをオンにし、 **[OK]** ボタンをクリックします。

4. 参照する、`MathFuncsLib.h`ヘッダー ファイルでは、含まれるディレクトリ パスを変更する必要があります。 **MyExecRefsLib** の **[プロパティ ページ]** ダイアログ ボックスで、 **[構成プロパティ]** ノードを展開し、 **[C/C++]** ノードを展開して、 **[全般]** をクリックします。 **[追加のインクルード ディレクトリ]** の横で、 **MathFuncsLib** ディレクトリへのパスを入力するか、参照によって指定します。

   ディレクトリ パスを参照するには、プロパティ値のドロップダウン リスト ボックスを開き、 **[編集]** をクリックします。 **追加のインクルード ディレクトリ** ダイアログ ボックスで、テキスト ボックスで、空白行を選択し、省略記号ボタンを選択し (**.**)、行の末尾。 **[ディレクトリの選択]** ダイアログ ボックスで、 **MathFuncsLib** ディレクトリを選択し、 **[フォルダーの選択]** ボタンをクリックしてその選択を保存し、ダイアログ ボックスを閉じます。 次に **［追加のインクルード ディレクトリ］** ダイアログ ボックスで、 **[OK]** ボタンをクリックし、 **［プロパティ ページ］** ダイアログ ボックスで、 **[OK]** ボタンをクリックしてプロジェクトへの変更を保存します。

5. 使用できるように、`MyMathFuncs`このアプリ内のクラス。 内容を置き換えます`MyExecRefsLib.cpp`次のコードで。

   [!code-cpp[NVC_Walkthrough_Create_Static_Lib#120](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_3.cpp)]

6. 実行可能ファイルを選択してビルド**ビルド** > **ソリューションのビルド**メニュー バーでします。

##  <a name="RunApp"></a> アプリの実行

### <a name="to-run-the-app"></a>アプリケーションを実行するには

1. **ソリューション エクスプローラー** で **MyExecRefsLib** のショートカット メニューを開き、 **[スタートアップ プロジェクトに設定]** をクリックして、 **MyExecRefsLib**が既定のプロジェクトとして選択されていることを確認します。

2. メニュー バーで、プロジェクトを実行するには、**デバッグ** > **デバッグなしで開始**します。 出力は、次のようになります。

    ```Output
    a + b = 106.4
    a - b = -91.6
    a * b = 732.6
    a / b = 0.0747475
    ```

## <a name="see-also"></a>関連項目

[チュートリアル: ダイナミック リンク ライブラリの作成と使用 (C++)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)<br/>
[デスクトップ アプリケーション (Visual C++)](../windows/desktop-applications-visual-cpp.md)