---
title: "MFC ODBC コンシューマー ウィザード | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.codewiz.class.mfc.consumer.overview"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MFC ODBC コンシューマー ウィザード"
  - "ウィザード [MFC]"
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
caps.latest.revision: 7
caps.handback.revision: 4
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# MFC ODBC コンシューマー ウィザード
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

ここに "検索結果" の概要を挿入します。  
  
 このウィザードでは、指定されたデータ ソースへのアクセスに必要な ODBC レコードセット クラスとデータ バインディングを設定します。  
  
## UIElement の一覧  
 **Data Source**  
 **\[データ ソース\]** をクリックすると、指定された ODBC ドライバーを使用して、指定されたデータ ソースを設定できます。  データ ソース ファイル \(DSN\) の詳細については、「[File Data Sources](https://msdn.microsoft.com/en-us/library/ms715401.aspx)」を参照してください。  **\[データ ソースの選択\]** ダイアログ ボックスには、以下の 2 つのタブがあります。  
  
-   **\[ファイル データ ソース\]** タブ: データ ソースとして使用するファイルを選択するディレクトリを、\[検索対象\] ボックスで指定します。  既定では、\\Program Files\\Common Files\\ODBC\\Data Sources になります。  既存のファイル データ ソース \(.dsn ファイル\) がメイン リスト ボックスに表示されます。  [ODBC データ ソース アドミニストレーター](https://msdn.microsoft.com/en-us/library/ms714024.aspx)の **\[ファイル DSN\]** タブでデータ ソースを設定したり、このダイアログ ボックスで新しく作成したりできます。  
  
     このダイアログ ボックスで新しいファイル データ ソースを作成するには、\[新規作成\] をクリックし、表示される \[データ ソースの新規作成\] ダイアログ ボックスで DSN 名を指定します。  \[データ ソースの新規作成\] ダイアログ ボックスで適切なドライバーを選択し、\[次へ\] をクリックします。次に、\[参照\] をクリックしてデータ ソースとして使用するファイルの名前を選択します \(.xls ファイルなど、DSN ファイル以外のファイルを表示するには、\[すべてのファイル\] を選択します\)。次に、\[次へ\] をクリックし、\[完了\] をクリックします。DSN ファイル以外のファイルを選択した場合は、\[ODBC Microsoft Excel セットアップ\] などのドライバー固有のダイアログ ボックスが表示されます。このダイアログ ボックスでファイルが DSN に変換されます。  
  
    > [!NOTE]
    >  ODBC データ ソース アドミニストレーターを使用して、新しいファイル データ ソースを作成しておくこともできます。  **\[スタート\]** メニューの **\[設定\]** をポイントし、**\[コントロール パネル\]** をクリックします。**\[管理ツール\]**、\[データ ソース \(ODBC\)\] の順に選択すると、\[ODBC データ ソース アドミニストレーター\] ダイアログ ボックスが表示されます。  
  
     \[DSN 名\] ボックスではファイル データ ソース名を指定します。  Excel ファイルの場合は .xls、Access ファイルの場合は .mdb など、DSN 名の最後に適切なファイル拡張子が指定されていることを確認してください。  
  
     DSN の詳細については、『ODBC Programmer's Reference』の「[File Data Sources](https://msdn.microsoft.com/en-us/library/ms715401.aspx)」を参照してください。  
  
-   **\[コンピューター データ ソース\]** タブ: このタブには、システム データ ソースおよびユーザー データ ソースが一覧表示されます。  ユーザー データ ソースは、コンピューターのユーザー固有のデータ ソースです。  システム データ ソースは、コンピューターまたはシステム全体のサービスのすべてのユーザーが使用できます。  『ODBC Programmer's Reference』の「[Machine Data Sources](https://msdn.microsoft.com/en-us/library/ms710952.aspx)」を参照してください。  
  
 ODBC データ ソースの詳細については、『ODBC Programmer's Reference』の「[Data Sources](https://msdn.microsoft.com/en-us/library/ms711688.aspx)」を参照してください。  
  
 **\[OK\]** をクリックして終了します。  \[データベース オブジェクトの選択\] ダイアログ ボックスが表示されます。  このダイアログ ボックスでは、コンシューマーが使用するテーブルまたはビューを選択します。  複数のビューまたはテーブルを選択するには、**Ctrl** キーを押しながら各項目をクリックします。  
  
 **Class**  
 コンシューマー クラス名。既定では、選択したファイル名またはコンピューター データ ソース名に基づいた名前になります。  
  
 **\[.h ファイル\]**  
 コンシューマー クラスのヘッダー ファイル名。既定では、選択したファイル名またはマシン データ ソース名に基づいた名前になります。  
  
 **\[.cpp ファイル\]**  
 コンシューマー クラスの実装ファイル名。既定では、選択したファイル名またはマシン データ ソース名に基づいた名前になります。  
  
 **Type**  
 レコードセットがダイナセット \(既定\) とスナップショットのどちらであるのかを指定します。  
  
-   **\[ダイナセット\]**: レコードセットがダイナセットであることを示します。  ダイナセットとは、クエリを実行したデータベースのデータにインデックス付きのビューを提供するクエリの結果です。  ダイナセットは、元のデータのインデックス部分だけをキャッシュに格納するため、スナップショットに比べてパフォーマンスが向上します。  インデックスはクエリの各結果レコードを直接指しており、レコードが削除されるかどうかを示します。  クエリが実行されたレコード内の更新情報にもアクセスできます。  これは、既定の設定です。  
  
-   **\[スナップショット\]**: レコードセットがスナップショットであることを示します。  スナップショットとはクエリ結果であり、ある時点におけるデータベースのビューです。  クエリ結果レコードはすべてキャッシュに格納されるため、元のレコードに対する変更内容は参照できません。  
  
 **\[すべての列をバインド\]**  
 選択したテーブルのすべての列をバインドするかどうかを指定します。  このボックスをオンにすると \(既定\)、すべての列がバインドされます。オンにしない場合は、列がバインドされないため、レコードセット クラスで手動でバインドする必要があります。  
  
## 参照  
 [MFC ODBC コンシューマー](../../mfc/reference/adding-an-mfc-odbc-consumer.md)   
 [コード ウィザードを使用した機能の追加](../../ide/adding-functionality-with-code-wizards-cpp.md)