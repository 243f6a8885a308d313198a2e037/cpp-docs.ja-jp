---
title: "MFC クラス追加ウィザード | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.codewiz.class.mfc.simple.overview"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MFC クラス追加ウィザード"
  - "ウィザード [MFC]"
ms.assetid: ad3b0989-d307-43b2-9417-3f9a78889024
caps.latest.revision: 16
caps.handback.revision: 12
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# MFC クラス追加ウィザード
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

既存の MFC プロジェクト、または MFC をサポートする ATL プロジェクトにクラスを追加するには、このコード ウィザードを使用します。  MFC クラスは、MFC サポートを持つ Win32 プロジェクトにも追加できます。  プロジェクトの作成時に指定した機能によって、このダイアログ ボックスで使用できるオプションが決まります。  
  
## 名前  
 このページでは、新しいクラスのクラス名、基本クラス、およびファイル名を指定します。  
  
 **\[クラス名\]**  
 このページでは、新しいクラスの名前を指定し、ID 名とファイル名の既定値を入力します。  通常、C\+\+ クラスの先頭には "C" が付きます。たとえば、CMyClass は MyClass.h になります。  
  
 **\[基底クラス\]**  
 新しいクラスの基本クラス名を指定します。  既定では、基本クラスは [CWnd](../Topic/CWnd%20Class.md) です。  選択した基本クラスによって、このページでほかにアクティブになるボックスが決まります。  
  
 基本クラスとして設定するクラスの型によって、クラスにダイアログ ID やリソース ID が必要となるかどうかが決まります。  クラスの一般的な型は以下のとおりです。  
  
-   [CButton](../../mfc/reference/cbutton-class.md)、[CWnd](../Topic/CWnd%20Class.md)、[CDocument](../Topic/CDocument%20Class.md) などのクラスには、ダイアログ ID やリソース ID は不要です。  これらのクラスでは、ダイアログ ID もリソース ID も使用されません。  これらのクラスを基本クラスとして選択すると、\[ダイアログ ID\] ボックスと \[DHTML リソース ID\] ボックスが淡色表示になります。  
  
-   [CDialog](../../mfc/reference/cdialog-class.md)、[CFormView](../../mfc/reference/cformview-class.md)、[CPropertyPage](../../mfc/reference/cpropertypage-class.md) などのクラスには、ダイアログ ID が必要です。  
  
-   [CDHtmlDialog](../Topic/CDHtmlDialog%20Class.md) クラスには、ダイアログ ID、DHTML リソース ID、および HTML ファイル名が必要です。  
  
 ダイアログ ID が必要なクラスの場合は、[リソース エディター](../../mfc/resource-editors.md)を使用してダイアログ リソースを作成し、[&#91;プロパティ&#93; ウィンドウ](../Topic/Properties%20Window.md)で ID を割り当ててから、そのリソース ID に関連するクラスを作成する方が効率的です。  Windows の標準ダイアログ ボックスの作成の詳細については、「[ダイアログ ボックスの新規作成](../../mfc/creating-a-new-dialog-box.md)」を参照してください。  
  
> [!NOTE]
>  ダイアログ リソースを最初に作成し、そのダイアログ リソースの新しいクラスを `CDHtmlDialog` から派生させる場合は、既定のダイアログ ボックスに表示される Windows の標準の **\[OK\]** ボタンと \[キャンセル\] ボタンを削除します。  固有の **\[OK\]** ボタンと \[キャンセル\] ボタンの付いた Windows の標準ダイアログ ボックスで、DHTML フォームがホストされます。  
  
 ダイアログ ボックスに Windows コントロールと DHTML コントロールの両方を含めることは避けてください。  
  
 **\[ダイアログ ID\]**  
 \[**基本クラス**\] として \[`CDialog`\]、\[`CFormView`\]、\[`CPropertyPage`\]、または \[`CDHtmlDialog`\] を選択した場合は、ダイアログの ID を指定します。  
  
 **\[.h ファイル\]**  
 新しいオブジェクトのクラスのヘッダー ファイル名を設定します。  既定では、\[クラス名\]に入力した名前に基づいた名前になります。  \[...\] ボタンをクリックし、場所を選択してファイル名を保存するか、クラス宣言を既存のファイルに追加します。  既存のファイルを選択した場合は、ウィザードの **\[完了\]** をクリックするまで、選択した場所にファイルが保存されません。  
  
 ウィザードでは、ファイルは上書きされません。  既存のファイルの名前を選択した場合は、ウィザードの **\[完了\]** をクリックすると、ファイルの内容にクラス宣言を追加するかどうかをたずねるメッセージが表示されます。  **\[はい\]** をクリックしてファイルに追加するか、**\[いいえ\]** をクリックしてウィザードに戻り、他のファイル名を指定します。  
  
 **\[.cpp ファイル\]**  
 新しいオブジェクトのクラスの実装ファイルの名前を設定します。  既定では、\[クラス名\]に入力した名前に基づいた名前になります。  \[...\] ボタンをクリックし、選択した場所にファイル名を保存します。  ウィザードの **\[完了\]** をクリックするまで、ファイルは指定した場所に保存されません。  
  
 ウィザードでは、ファイルは上書きされません。  既存のファイルの名前を選択した場合は、ウィザードの **\[完了\]** をクリックすると、ファイルの内容にクラスの実装を追加するかどうかをたずねるメッセージが表示されます。  **\[はい\]** をクリックしてファイルに追加するか、**\[いいえ\]** をクリックしてウィザードに戻り、他のファイル名を指定します。  
  
 **\[アクティブ アクセシビリティ\]**  
 コンストラクターで [EnableActiveAccessibility](../Topic/CWnd::EnableActiveAccessibility.md) を呼び出すことにより、アクティブ アクセシビリティの MFC サポートを有効にします。  このオプションは [CWnd](../Topic/CWnd%20Class.md) の派生クラスに対して有効です。  
  
 **\[DHTML リソース ID\]**  
 `CDHtmlDialog` の派生クラスだけに有効です。  DHTML ダイアログ ボックスのリソース ID を指定します。  リソース ID は、プロジェクトの .rc ファイルの HTML セクションに、HTML ダイアログ ボックス ファイル名と共に表示されます。  この ID で識別される DHTML リソースは、\[ダイアログ ID\] に指定した ID で識別されるダイアログ ボックスでホストされます。  
  
 **\[.HTM ファイル\]**  
 `CDHtmlDialog` の派生クラスだけに有効です。  HTML ファイル名を DHTML ダイアログ ボックスに設定します。  既定では、このファイル名はクラス名に基いた名前になります。  ファイル名は、プロジェクトの .rc ファイルの HTML セクションに、DHTML ダイアログ ボックス リソース ID と共に表示されます。  
  
 **\[オートメーション\]**  
 [オートメーション](../../mfc/automation.md)に対するクラス レベルのサポートを設定します。  クラス レベルでのオートメーションは、オートメーションをサポートするすべてのクラスで有効です。  オートメーションのサポートで作成されたプロジェクトにも使用できます。  つまり [ATL をサポート](../../atl/reference/mfc-support-in-atl-projects.md)する MFC プロジェクト、または MFC アプリケーション ウィザードの [&#91;高度な機能&#93;](../../mfc/reference/advanced-features-mfc-application-wizard.md) ページの **\[オートメーション\]** チェック ボックスをオンにした MFC プロジェクトに対しても有効です。  
  
|オプション|説明|  
|-----------|--------|  
|**なし。**|クラスがオートメーションをサポートしないことを示します。|  
|**\[オートメーション\]**|クラスがオートメーションをサポートすることを示します。  このオプションを選択すると、Microsoft Visual Basic や Microsoft Excel などのオートメーション クライアント アプリケーションで、新規作成したクラスをプログラミング可能なオブジェクトとして使用できます。  このオプションは、この表の後に挙げる基本クラスには使用できません。|  
|**\[タイプ ID で作成可能\]**|クラスとプロジェクトの両方において、ほかのアプリケーションがオートメーションを使用してこのクラスのオブジェクトを作成することをサポートします。  このオプションを使用すると、オートメーション クライアントはオートメーション オブジェクトを直接作成できます。  テキスト ボックスの型 ID をクライアント アプリケーションが使用して、作成するオブジェクトを指定します。この ID はシステム全体を通じて一意である必要があります。  このオプションは、この表の後に挙げる基本クラスには使用できません。|  
  
 オートメーションは次の基本クラスには使用できません。  
  
-   `CAsyncMonitorFile`  
  
-   `CAsyncSocket`  
  
-   `CCachedDataPathProperty`  
  
-   `CConnectionPoint`  
  
-   `CDatabase`  
  
-   `CDataPathProperty`  
  
-   `CHttpFilter`  
  
-   `CHttpServer`  
  
-   `CInternetSession`  
  
-   `CObject`  
  
-   `CSocket`  
  
 **\[タイプ ID\]**  
 クラスの型 ID を設定します。  **\[型 ID\]** ボックスは次のようにプロジェクト名と新しいクラスの名前を連結する: *MFCProj.MFCClass*。  この ID は、**\[オートメーション\]** の **\[タイプ ID で作成可能\]** オプションがオンになっている場合にだけ変更できます。  
  
 **\[ドキュメント テンプレート リソースの生成\]**  
 アプリケーションで作成したドキュメントに、ドキュメント テンプレート リソースがあることを示します。  このチェック ボックスをオンにするには、プロジェクトで MFC ドキュメント\/ビュー アーキテクチャをサポートし、またこのクラスの基本クラスが [CFormView](../../mfc/reference/cformview-class.md) であることが必要です。  
  
 詳細については、「[ドキュメント テンプレートとドキュメント\/ビューの作成手順](../../mfc/document-templates-and-the-document-view-creation-process.md)」を参照してください。  
  
## 参照  
 [MFC クラス](../../mfc/reference/adding-an-mfc-class.md)   
 [クラスの追加](../Topic/Adding%20a%20Class%20\(Visual%20C++\).md)