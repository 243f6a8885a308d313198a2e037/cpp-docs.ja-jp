---
title: "CTreeCtrl クラス |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
dev_langs:
- C++
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 573b81ce8d78cde67b63579caa5ed96bbe557ae3
ms.sourcegitcommit: 54035dce0992ba5dce0323d67f86301f994ff3db
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/03/2018
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class
Windows コモン ツリー ビュー コントロールの機能が用意されています。  
  
## <a name="syntax"></a>構文  
  
```  
class CTreeCtrl : public CWnd  
```  
  
## <a name="members"></a>メンバー  
  
### <a name="public-constructors"></a>パブリック コンストラクター  
  
|名前|説明|  
|----------|-----------------|  
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|`CTreeCtrl` オブジェクトを構築します。|  
  
### <a name="public-methods"></a>パブリック メソッド  
  
|名前|説明|  
|----------|-----------------|  
|[CTreeCtrl::Create](#create)|ツリー ビュー コントロールを作成し、それにアタッチ、`CTreeCtrl`オブジェクト。|  
|[CTreeCtrl::CreateDragImage](#createdragimage)|指定されたツリー ビューの項目のドラッグ用のビットマップを作成します。|  
|[CTreeCtrl::CreateEx](#createex)|指定された Windows 拡張スタイルのツリー コントロールを作成しにアタッチ、`CTreeCtrl`オブジェクト。|  
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|ツリー ビュー コントロール内のすべての項目を削除します。|  
|[CTreeCtrl::DeleteItem](#deleteitem)|ツリー ビュー コントロールに新しい項目を削除します。|  
|[CTreeCtrl::EditLabel](#editlabel)|指定されたツリー ビューの項目を直接編集を行います。|  
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|現在のツリー ビュー コントロール内のツリー ビューの項目のラベルの編集操作をキャンセルします。|  
|[CTreeCtrl::EnsureVisible](#ensurevisible)|ツリー ビューのアイテムがツリー ビュー コントロールに表示されていることを確認します。|  
|[CTreeCtrl::Expand](#expand)|展開、または、指定されたツリー ビューのアイテムの子項目を折りたたみます。|  
|[CTreeCtrl::GetBkColor](#getbkcolor)|コントロールの現在の背景色を取得します。|  
|[CTreeCtrl::GetCheck](#getcheck)|ツリー コントロール項目のチェックの状態を取得します。|  
|[CTreeCtrl::GetChildItem](#getchilditem)|指定されたツリー ビューのアイテムの子を取得します。|  
|[CTreeCtrl::GetCount](#getcount)|ツリー ビュー コントロールに関連付けられているツリー項目の数を取得します。|  
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|ドラッグ アンド ドロップ操作の対象を取得します。|  
|[CTreeCtrl::GetEditControl](#geteditcontrol)|指定されたツリー ビューの項目を編集するために使用するエディット コントロールのハンドルを取得します。|  
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|現在のツリー ビュー コントロールを使用している拡張スタイルを取得します。|  
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|指定されたツリー ビューのアイテムの最初に表示される項目を取得します。|  
|[CTreeCtrl::GetImageList](#getimagelist)|ツリー ビュー コントロールに関連付けられているイメージ リストのハンドルを取得します。|  
|[CTreeCtrl::GetIndent](#getindent)|親からのオフセット (ピクセル単位) のツリー ビューの項目を取得します。|  
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|ツリー ビューの挿入マークの描画に使用する色を取得します。|  
|[CTreeCtrl::GetItem](#getitem)|指定されたツリー ビューの項目の属性を取得します。|  
|[CTreeCtrl::GetItemData](#getitemdata)|項目に関連付けられている 32 ビット アプリケーションに固有の値を返します。|  
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|現在のツリー ビュー コントロールの指定した項目が展開された状態を表示するイメージのインデックスを取得します。|  
|[CTreeCtrl::GetItemHeight](#getitemheight)|ツリー ビューのアイテムの現在の高さを取得します。|  
|[CTreeCtrl::GetItemImage](#getitemimage)|項目に関連付けられているイメージを取得します。|  
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|現在のツリー ビュー コントロール内の指定した項目の指定された部分の外接する四角形を取得します。|  
|[CTreeCtrl::GetItemRect](#getitemrect)|ツリー ビューの項目の外接する四角形を取得します。|  
|[CTreeCtrl::GetItemState](#getitemstate)|項目の状態を返します。|  
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|現在のツリー ビュー コントロール内の指定した項目の拡張の状態を取得します。|  
|[CTreeCtrl::GetItemText](#getitemtext)|アイテムのテキストを返します。|  
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|現在のツリー ビュー コントロール内の最後の拡張項目を取得します。|  
|[CTreeCtrl::GetLineColor](#getlinecolor)|ツリー ビュー コントロールの現在の線の色を取得します。|  
|[CTreeCtrl::GetNextItem](#getnextitem)|指定されたリレーションシップに一致する次のツリー ビューの項目を取得します。|  
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|指定されたツリー ビューの項目の次の兄弟を取得します。|  
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|指定されたツリー ビューのアイテムの [次へ] に表示される項目を取得します。|  
|[CTreeCtrl::GetParentItem](#getparentitem)|指定されたツリー ビューのアイテムの親を取得します。|  
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|指定されたツリー ビューのアイテムの前の兄弟を取得します。|  
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|指定されたツリー ビューのアイテムの前に表示される項目を取得します。|  
|[CTreeCtrl::GetRootItem](#getrootitem)|指定されたツリー ビューの項目のルートを取得します。|  
|[CTreeCtrl::GetScrollTime](#getscrolltime)|ツリー ビュー コントロールのスクロールの最大時間を取得します。|  
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|現在のツリー ビュー コントロールで選択した項目の数を取得します。|  
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|現在選択されているツリー ビューの項目を取得します。|  
|[CTreeCtrl::GetTextColor](#gettextcolor)|コントロールの現在のテキストの色を取得します。|  
|[CTreeCtrl::GetToolTips](#gettooltips)|子ツリー ビュー コントロールで使用されるツール ヒント コントロールを識別するハンドルを取得します。|  
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|ツリー ビュー コントロールに関連付けられている表示されているツリー項目の数を取得します。|  
|[CTreeCtrl::HitTest](#hittest)|関連する、カーソルの現在位置を返します、`CTreeCtrl`オブジェクト。|  
|[CTreeCtrl::InsertItem](#insertitem)|ツリー ビュー コントロールに新しい項目を挿入します。|  
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|指定した項目に子項目がある場合は 0 以外を返します。|  
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|現在のツリー ビュー コントロール内のツリー ビューの項目を識別するハンドルを指定したユーザー補助機能の識別子をマップします。|  
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|指定したハンドルをアクセシビリティ識別子を現在のツリー ビュー コントロール内のツリー ビューの項目にマップされます。|  
|[CTreeCtrl::Select](#select)|選択、スクロール、表示または指定されたツリー ビューのアイテムを再描画します。|  
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|ツリー項目をドラッグ アンド ドロップ操作の対象として再描画します。|  
|[CTreeCtrl::SelectItem](#selectitem)|指定されたツリー ビューの項目を選択します。|  
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|最初に表示される項目として指定されたツリー ビューの項目を選択します。|  
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|現在のツリー ビュー コントロールのスクロール率を設定します。|  
|[CTreeCtrl::SetBkColor](#setbkcolor)|コントロールの背景色を設定します。|  
|[CTreeCtrl::SetCheck](#setcheck)|ツリー コントロール項目のチェックの状態を設定します。|  
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|現在のツリー ビュー コントロールの拡張スタイルを設定します。|  
|[CTreeCtrl::SetImageList](#setimagelist)|ツリー ビュー コントロールに関連付けられているイメージ リストのハンドルを設定します。|  
|[CTreeCtrl::SetIndent](#setindent)|親からのオフセット (ピクセル単位) のツリー ビューのアイテムを設定します。|  
|[CTreeCtrl::SetInsertMark](#setinsertmark)|ツリー ビュー コントロールの挿入マークを設定します。|  
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|ツリー ビューの挿入マークの描画に使用する色を設定します。|  
|[CTreeCtrl::SetItem](#setitem)|指定されたツリー ビューの項目の属性を設定します。|  
|[CTreeCtrl::SetItemData](#setitemdata)|項目に関連付けられている 32 ビット アプリケーションに固有の値を設定します。|  
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|現在のツリー ビュー コントロールの指定した項目が展開された状態を表示するイメージのインデックスを設定します。|  
|[CTreeCtrl::SetItemHeight](#setitemheight)|アイテムの表示、ツリーの高さを設定します。|  
|[CTreeCtrl::SetItemImage](#setitemimage)|イメージを項目に関連付けます。|  
|[CTreeCtrl::SetItemState](#setitemstate)|項目の状態を設定します。|  
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|現在のツリー ビュー コントロールの指定した項目の拡張の状態を設定します。|  
|[CTreeCtrl::SetItemText](#setitemtext)|項目のテキストを設定します。|  
|[CTreeCtrl::SetLineColor](#setlinecolor)|ツリー ビュー コントロールの現在の線の色を設定します。|  
|[CTreeCtrl::SetScrollTime](#setscrolltime)|ツリー ビュー コントロールのスクロールの最大時間を設定します。|  
|[CTreeCtrl::SetTextColor](#settextcolor)|コントロールのテキストの色を設定します。|  
|[CTreeCtrl::SetToolTips](#settooltips)|ツール ヒント コントロールのツリー ビュー コントロールの子を設定します。|  
|[CTreeCtrl::ShowInfoTip](#showinfotip)|現在のツリー ビュー コントロール内の指定したアイテムのヒントを表示します。|  
|[CTreeCtrl::SortChildren](#sortchildren)|指定された親アイテムの子を並べ替えます。|  
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|アプリケーション定義の並べ替え関数を使用して指定された親アイテムの子を並べ替えます。|  
  
## <a name="remarks"></a>コメント  
 「ツリー ビュー コントロール」は、ディスク上の文書の見出し、インデックス、または、ファイルおよびディレクトリ内のエントリなどのアイテムの階層リストを表示するウィンドウです。 各項目がラベルとオプションのビットマップ イメージで構成され、各項目に関連付けられているサブ項目のリストを持つことができます。 項目をクリックすると、ユーザーは展開したり、サブ項目の関連付けられているリストを折りたたむできます。  
  
 このコントロール (したがって、`CTreeCtrl`クラス) は、Windows 98 および Windows NT の version 4 で実行されているプログラムにのみ使用可能な以降。  
  
 使用する方法についての`CTreeCtrl`を参照してください。  
  
- [コントロール](../../mfc/controls-mfc.md)  
  
- [CTreeCtrl の使い方](../../mfc/using-ctreectrl.md)  
  
- [ツリー ビュー コントロールへの参照](http://msdn.microsoft.com/library/windows/desktop/bb759988)Windows SDK にします。  
  
-   サポート技術情報の記事 Q222905: HOWTO: CTreeCtrl のコンテキスト メニューを表示  
  
## <a name="inheritance-hierarchy"></a>継承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `CTreeCtrl`  
  
## <a name="requirements"></a>必要条件  
 **ヘッダー:** afxcmn.h  
  
##  <a name="create"></a>CTreeCtrl::Create  
 ダイアログ ボックス テンプレートで、ツリー コントロールを指定する場合、またはを使用している場合[CTreeView](../../mfc/reference/ctreeview-class.md)、ダイアログ ボックスまたはビューの作成時に、ツリー コントロールが自動的に作成します。  
  
```  
virtual BOOL Create(
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwStyle`  
 ツリー ビュー コントロールのスタイルを指定します。 説明されているウィンドウ スタイルを適用[CreateWindow](http://msdn.microsoft.com/library/windows/desktop/ms632679)との任意の組み合わせ[ツリー ビュー コントロールのスタイル](http://msdn.microsoft.com/library/windows/desktop/bb760013)Windows SDK」の説明に従ってします。  
  
 `rect`  
 ツリー ビュー コントロールのサイズと位置を指定します。 いずれかになります、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)構造体。  
  
 `pParentWnd`  
 ツリー ビュー コントロールの親ウィンドウを通常を指定します、`CDialog`です。 なければなりません**NULL**です。  
  
 `nID`  
 ツリー ビュー コントロールの ID を指定します  
  
### <a name="return-value"></a>戻り値  
 初期化が成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 その他のいくつかのウィンドウの子ウィンドウとしてツリーのコントロールを作成する場合を使用して、**作成**メンバー関数。 ツリー コントロールを使用して、作成した場合**作成**に渡す必要があります**WS_VISIBLE**、他のツリー ビューのスタイルに加え、します。  
  
 構築する、 `CTreeCtrl` 2 つの手順でします。 最初の呼び出し、コンス トラクターを呼び出す**作成**、ツリー ビュー コントロールを作成しにアタッチする、`CTreeCtrl`オブジェクト。  
  
 拡張ウィンドウ スタイルを使用して、ツリー コントロールを作成するには、呼び出す[CreateEx](#createex)の代わりに**作成**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]  
  
##  <a name="createex"></a>CTreeCtrl::CreateEx  
 コントロールを作成し、(子ウィンドウ) でそれを関連付けるには、この関数を呼び出して、`CTreeCtrl`オブジェクト。  
  
```  
virtual BOOL CreateEx(
    DWORD dwExStyle,  
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwExStyle`  
 作成されるコントロールの拡張スタイルを指定します。 拡張ウィンドウ スタイルの一覧は、次を参照してください。、`dwExStyle`パラメーターを[について](http://msdn.microsoft.com/library/windows/desktop/ms632680)Windows SDK に含まれています。  
  
 `dwStyle`  
 ツリー ビュー コントロールのスタイルを指定します。 説明されているウィンドウ スタイルを適用[CreateWindow](http://msdn.microsoft.com/library/windows/desktop/ms632679)との任意の組み合わせ[ツリー ビュー コントロールのスタイル](http://msdn.microsoft.com/library/windows/desktop/bb760013)Windows SDK」の説明に従ってします。  
  
 `rect`  
 参照、 [RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)のクライアント座標で、作成するウィンドウの位置とサイズを記述する構造体`pParentWnd`です。  
  
 `pParentWnd`  
 コントロールの親であるウィンドウへのポインター。  
  
 `nID`  
 コントロールの子ウィンドウ ID  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外。 それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 使用して`CreateEx`の代わりに[作成](#create)Windows 拡張スタイル「はじめに」で指定された Windows の拡張スタイルを適用する**ws_ex**です。  
  
##  <a name="createdragimage"></a>CTreeCtrl::CreateDragImage  
 この関数では、ツリー ビュー コントロールで指定したアイテムのドラッグ用のビットマップを作成し、ビットマップのイメージ リストを作成して、ビットマップ イメージ リストを追加します。  
  
```  
CImageList* CreateDragImage(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目をドラッグできるのハンドルです。  
  
### <a name="return-value"></a>戻り値  
 成功した場合は、ドラッグ用のビットマップが追加されたイメージ リストへのポインターそれ以外の場合**NULL**です。  
  
### <a name="remarks"></a>コメント  
 アプリケーションでは、アイテムがドラッグされているときに、イメージを表示するのにイメージ リスト機能を使用します。  
  
 `CImageList`オブジェクトが保存され、作業完了後に削除する必要があります。 例:  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]  
  
##  <a name="ctreectrl"></a>CTreeCtrl::CTreeCtrl  
 `CTreeCtrl` オブジェクトを構築します。  
  
```  
CTreeCtrl();
```  
  
##  <a name="deleteallitems"></a>CTreeCtrl::DeleteAllItems  
 ツリー ビュー コントロールからすべての項目を削除するには、この関数を呼び出します。  
  
```  
BOOL DeleteAllItems();
```  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]  
  
##  <a name="deleteitem"></a>CTreeCtrl::DeleteItem  
 ツリー ビュー コントロールから項目を削除するには、この関数を呼び出します。  
  
```  
BOOL DeleteItem(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 削除するアイテムのハンドルです。 場合*hitem*が、 **TVI_ROOT**値、すべてのアイテムがツリー ビュー コントロールから削除されます。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]  
  
##  <a name="editlabel"></a>CTreeCtrl::EditLabel  
 インプレースでは、指定した項目のテキストの編集を開始するには、この関数を呼び出します。  
  
```  
CEdit* EditLabel(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目を編集することのハンドルです。  
  
### <a name="return-value"></a>戻り値  
 成功した場合へのポインター、`CEdit`項目テキストの編集に使用されます。 それ以外の場合は、オブジェクト**NULL**です。  
  
### <a name="remarks"></a>コメント  
 編集操作は、テキストを含む単一行エディット コントロールで項目のテキストを置き換えることで行います。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]  
  
##  <a name="endeditlabelnow"></a>CTreeCtrl::EndEditLabelNow  
 現在のツリー ビュー コントロール内のツリー ビューの項目のラベルの編集操作を終了します。  
  
```  
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `fCancelWithoutSave`|`true`編集操作が完了するとする前に、ツリー ビューの項目への変更を破棄するか、`false`操作が完了するとする前に、ツリー ビューの項目に変更を保存します。|  
  
### <a name="return-value"></a>戻り値  
 `true`このメソッドが成功した場合それ以外の場合、`false`です。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_ENDEDITLABELNOW](http://msdn.microsoft.com/library/windows/desktop/bb773564) Windows SDK で説明するメッセージ。  
  
##  <a name="ensurevisible"></a>CTreeCtrl::EnsureVisible  
 この関数では、ツリー ビューのアイテムが表示されていることを確認します。  
  
```  
BOOL EnsureVisible(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 認識される、ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 返します**TRUE**指定した項目が表示されていることを確認するツリー ビュー コントロール内の項目がスクロールします。 それ以外の場合、戻り値は**FALSE**です。  
  
### <a name="remarks"></a>コメント  
 必要に応じて、関数は親アイテムを展開または項目が表示されるように、ツリー ビュー コントロールをスクロールします。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]  
  
##  <a name="expand"></a>CTreeCtrl::Expand  
 指定された親アイテムに関連付けられている場合は、展開または折りたたみ、子項目の一覧には、この関数を呼び出します。  
  
```  
BOOL Expand(
    HTREEITEM hItem,  
    UINT nCode);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目を展開するのハンドルです。  
  
 `nCode`  
 実行されるアクションの種類を示すフラグです。 このフラグは、次の値のいずれかを持つことができます。  
  
- `TVE_COLLAPSE`一覧を折りたたみます。  
  
- `TVE_COLLAPSERESET`一覧を解除し、子項目を削除します。 **TVIS_EXPANDEDONCE**状態を示すフラグをリセットします。 このフラグはと共に使用する必要があります、`TVE_COLLAPSE`フラグ。  
  
- `TVE_EXPAND`リストを展開します。  
  
- `TVE_TOGGLE`現在展開されているか、またはどのように展開される場合は現在折りたたまれている場合は、一覧を折りたたみます。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::EnsureVisible](#ensurevisible)です。  
  
##  <a name="getbkcolor"></a>CTreeCtrl::GetBkColor  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_GETBKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773570)Windows SDK で説明されている。  
  
```  
COLORREF GetBkColor() const;  
```  
  
### <a name="return-value"></a>戻り値  
 A **COLORREF**コントロールの現在のウィンドウの背景色を表す値です。 この値が-1 の場合は、コントロールはシステム ウィンドウの色を使用しています。 この場合、使用することができます`::GetSysColor(COLOR_WINDOW)`コントロールを使用している現在のシステム カラーを取得します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetTextColor](#settextcolor)です。  
  
##  <a name="getcheck"></a>CTreeCtrl::GetCheck  
 項目のチェック状態を取得するには、このメンバー関数を呼び出します。  
  
```  
BOOL GetCheck(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 **HTREEITEM**に関する状態情報を受信します。  
  
### <a name="return-value"></a>戻り値  
 ツリー コントロール項目がチェックされている場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetCheck](#setcheck)です。  
  
##  <a name="getchilditem"></a>CTreeCtrl::GetChildItem  
 コール ツリーを取得するには、この関数のビュー項目ですで指定した項目の子`hItem`です。  
  
```  
HTREEITEM GetChildItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は、子項目のハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]  
  
##  <a name="getcount"></a>CTreeCtrl::GetCount  
 この関数では、ツリー ビュー コントロール内の項目の数を取得します。  
  
```  
UINT GetCount() const;  
```  
  
### <a name="return-value"></a>戻り値  
 ツリー ビュー コントロール内の項目の数。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]  
  
##  <a name="getdrophilightitem"></a>CTreeCtrl::GetDropHilightItem  
 この関数では、ドラッグ アンド ドロップ操作の対象となっている項目を取得します。  
  
```  
HTREEITEM GetDropHilightItem() const;  
```  
  
### <a name="return-value"></a>戻り値  
 成功した場合、アイテムのハンドルが削除されます。それ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]  
  
##  <a name="geteditcontrol"></a>CTreeCtrl::GetEditControl  
 この関数では、ツリー ビュー アイテムのテキストを編集するために使用される編集コントロールのハンドルを取得します。  
  
```  
CEdit* GetEditControl() const;  
```  
  
### <a name="return-value"></a>戻り値  
 成功した場合、項目のテキストを編集するために使用するエディット コントロールへのポインターそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]  
  
##  <a name="getextendedstyle"></a>CTreeCtrl::GetExtendedStyle  
 現在のツリー ビュー コントロールを使用している拡張スタイルを取得します。  
  
```  
DWORD GetExtendedStyle() const;  
```  
  
### <a name="return-value"></a>戻り値  
 現在のツリー ビュー コントロールのビットごとの組み合わせ (OR) を格納する値での拡張スタイルを使用します。 詳細については、次を参照してください。[ツリー ビュー コントロールの拡張スタイル](http://msdn.microsoft.com/library/windows/desktop/bb759981)です。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_GETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb773580) Windows SDK で説明するメッセージ。  
  
##  <a name="getfirstvisibleitem"></a>CTreeCtrl::GetFirstVisibleItem  
 この関数では、最初に表示されるツリー ビュー コントロールの項目を取得します。  
  
```  
HTREEITEM GetFirstVisibleItem() const;  
```  
  
### <a name="return-value"></a>戻り値  
 最初に表示される項目のハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetCheck](#setcheck)です。  
  
##  <a name="getimagelist"></a>CTreeCtrl::GetImageList  
 法線のハンドルまたはツリー ビュー コントロールに関連付けられているイメージ リストを取得するには、この関数を呼び出します。  
  
```  
CImageList* GetImageList(UINT nImageList) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `nImageList`  
 取得するイメージ リストの種類です。 イメージ リストには、次の値のいずれかを指定できます。  
  
- `TVSIL_NORMAL`ツリー ビューのアイテムを選択し、選択されていないイメージを含む通常のイメージの一覧を取得します。  
  
- `TVSIL_STATE`ユーザー定義の状態にあるツリー ビューのアイテムの画像が含まれている状態のイメージ リストを取得します。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は、コントロールのイメージ リストへのポインターそれ以外の場合**NULL**です。  
  
### <a name="remarks"></a>コメント  
 ツリー ビュー コントロール内の各項目には、関連付けられているビットマップ イメージのペアを持つことができます。 項目が選択されているし、項目が選択されていないときに表示されたら、他の 1 つのイメージが表示されます。 たとえば、項目が選択されていないときに、開いているフォルダーを選択すると閉じたフォルダーを表示できます。  
  
 イメージ リストの詳細については、次を参照してください。、 [CImageList](../../mfc/reference/cimagelist-class.md)クラスです。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]  
  
##  <a name="getindent"></a>CTreeCtrl::GetIndent  
 この関数では、金額を取得する、(ピクセル単位) を子項目がその親アイテムの基準とした分だけインデントされます。  
  
```  
UINT GetIndent() const;  
```  
  
### <a name="return-value"></a>戻り値  
 インデント幅はピクセル単位で測定されます。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]  
  
##  <a name="getinsertmarkcolor"></a>CTreeCtrl::GetInsertMarkColor  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_GETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773590)Windows SDK で説明されている。  
  
```  
COLORREF GetInsertMarkColor() const;  
```  
  
### <a name="return-value"></a>戻り値  
 A **COLORREF**挿入マークの現在の色を表す値です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]  
  
##  <a name="getitem"></a>CTreeCtrl::GetItem  
 指定されたツリー ビューのアイテムの属性を取得するには、この関数を呼び出します。  
  
```  
BOOL GetItem(TVITEM* pItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `pItem`  
 ポインター、 [TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456) Windows SDK」の説明に従って、構造体します。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::DeleteItem](#deleteitem)です。  
  
##  <a name="getitemdata"></a>CTreeCtrl::GetItemData  
 指定した項目に関連付けられている 32 ビット アプリケーションに固有の値を取得するには、この関数を呼び出します。  
  
```  
DWORD_PTR GetItemData(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 テーブルのデータを取得するアイテムのハンドル。  
  
### <a name="return-value"></a>戻り値  
 指定した項目に関連付けられている 32 ビット アプリケーションに固有の値`hItem`です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]  
  
##  <a name="getitemexpandedimageindex"></a>CTreeCtrl::GetItemExpandedImageIndex  
 現在のツリー ビュー コントロールの指定した項目が展開された状態を表示するイメージのインデックスを取得します。  
  
```  
int GetItemExpandedImageIndex(HTREEITEM hItem)const;  
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|ツリー ビュー コントロールの項目へのハンドルします。|  
  
### <a name="return-value"></a>戻り値  
 指定した項目が展開された状態を表示するイメージのインデックス。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_GETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773596) Windows SDK で説明するメッセージ。 返しますのメッセージを[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)ツリー ビュー コントロールの項目と、このメソッドを記述する構造体を取得、`iExpandedImage`構造体のメンバーです。  
  
##  <a name="getitemheight"></a>CTreeCtrl::GetItemHeight  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_GETITEMHEIGHT](http://msdn.microsoft.com/library/windows/desktop/bb773599)Windows SDK で説明されている。  
  
```  
SHORT GetItemHeight() const;  
```  
  
### <a name="return-value"></a>戻り値  
 ピクセル単位で、アイテムの高さ。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]  
  
##  <a name="getitemimage"></a>CTreeCtrl::GetItemImage  
 ツリー ビュー コントロール内の各項目には、関連付けられているビットマップ イメージのペアを持つことができます。  
  
```  
BOOL GetItemImage(
    HTREEITEM hItem,  
    int& nImage,  
    int& nSelectedImage) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 イメージを取得するアイテムのハンドル。  
  
 `nImage`  
 ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックスを受け取る整数。  
  
 `nSelectedImage`  
 ツリー ビュー コントロールのイメージ リスト内のアイテムの選択したイメージのインデックスを受け取る整数。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 項目のラベルの左側にある、画像が表示されます。 項目が選択されているし、項目が選択されていないときに表示されたら、他の 1 つのイメージが表示されます。 たとえば、項目が選択されていないときに、開いているフォルダーを選択すると閉じたフォルダーを表示できます。  
  
 この関数では、項目のイメージ、およびツリー ビュー コントロールのイメージ リスト内で選択したイメージのインデックスを取得します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]  
  
##  <a name="getitempartrect"></a>CTreeCtrl::GetItemPartRect  
 現在のツリー ビュー コントロール内の指定した項目の指定された部分の外接する四角形を取得します。  
  
```  
BOOL GetItemPartRect(
    HTREEITEM hItem,   
    int nPart,   
    LPRECT lpRect)const;  
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|ツリー ビュー コントロールの項目へのハンドルします。|  
|[入力] `nPart`|一部の識別子。 設定する必要があります`TVGIPR_BUTTON`です。|  
|[出力] `lpRect`|ポインター、 [RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)構造体。 このメソッドが成功するが構造体で指定された一部の四角形の座標`hItem`と`nPart`です。|  
  
### <a name="return-value"></a>戻り値  
 `true`このメソッドが成功した場合それ以外の場合、`false`です。  
  
### <a name="remarks"></a>コメント  
 各ツリーのコントロールの項目は、グラフィックスの四角形によって制限されます。 その四角形内のポイントがクリックしたときに、アイテムと呼ばれます*ヒット*です。 このメソッドは、特定の時点に四角形をクリックしたときで識別される項目になるように最も大きな四角形を返します、`hItem`パラメーターがヒットします。  
  
 このメソッドは、送信、 `TVM_GETITEMPARTRECT` Windows SDK で説明するメッセージ。 詳細については、次を参照してください。、 [TreeView_GetItemPartRect](http://msdn.microsoft.com/library/windows/desktop/bb773847)マクロです。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例は、ユーザー補助機能識別子を使用して、 [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)ルート ツリー ビューの項目へのハンドルを取得します。 例では、ハンドルを使用して、および[CTreeCtrl::GetItemPartRect](#getitempartrect)そのアイテムの周囲の 3D の四角形を描画するメソッド。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。 使用して、 [CTreeCtrl::MapItemToAccID](#mapitemtoaccid)項目に関連付けるルート ツリー ビュー、ユーザー補助機能の識別子を持つメソッドです。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]  
  
##  <a name="getitemrect"></a>CTreeCtrl::GetItemRect  
 外接する四角形を取得するには、この関数を呼び出す`hItem`かどうかが表示されるかを決定します。  
  
```  
BOOL GetItemRect(
    HTREEITEM hItem,  
    LPRECT lpRect,  
    BOOL bTextOnly) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー ビュー コントロールのアイテムのハンドルです。  
  
 `lpRect`  
 ポインター、 [RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)外接する四角形を受け取る。 座標は、ツリー ビュー コントロールの左上隅に対して相対的です。  
  
 *bTextOnly*  
 このパラメーターが 0 以外の場合は、外接する四角形には、項目のテキストのみが含まれています。 それ以外の場合、ツリー ビュー コントロールのアイテムが占有する行全体が含まれます。  
  
### <a name="return-value"></a>戻り値  
 外接する四角形に含まれているアイテムが表示される場合は 0 以外`lpRect`です。 それ以外の場合、0 を`lpRect`初期化されていません。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]  
  
##  <a name="getitemstate"></a>CTreeCtrl::GetItemState  
 指定した項目の状態を返す`hItem`です。  
  
```  
UINT GetItemState(
    HTREEITEM hItem,  
    UINT nStateMask) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 状態を取得するアイテムのハンドル。  
  
 `nStateMask`  
 取得する 1 つまたは複数の状態を示すマスクです。 詳細に指定できる値について`nStateMask`の説明を参照して、**状態**と**対象**のメンバー、 [TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456) Windows SDK 内の構造。  
  
### <a name="return-value"></a>戻り値  
 A **UINT**取得で指定された値のビットごとの OR を保持します。 使用可能な値については、次を参照してください。 [CTreeCtrl::GetItem](#getitem)です。 特定の状態の値を検索するには、次の例で示すように、状態の値と戻り値のビットごとの AND 演算を実行します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]  
  
##  <a name="getitemstateex"></a>CTreeCtrl::GetItemStateEx  
 現在のツリー ビュー コントロール内の指定した項目の拡張の状態を取得します。  
  
```  
UINT GetItemStateEx(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|ツリー ビュー コントロールの項目へのハンドルします。|  
  
### <a name="return-value"></a>戻り値  
 項目の拡張の状態。 詳細については、次を参照してください。、`uStateEx`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_GETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773596) Windows SDK で説明するメッセージ。 返しますのメッセージを[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)ツリー ビュー コントロールの項目、このメソッドを記述する構造体を取得、`uStateEx`構造体のメンバーです。  
  
##  <a name="getitemtext"></a>CTreeCtrl::GetItemText  
 指定した項目のテキストを返します`hItem`です。  
  
```  
CString GetItemText(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 テキストを取得するアイテムのハンドル。  
  
### <a name="return-value"></a>戻り値  
 A`CString`項目のテキストを含むオブジェクト。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetNextItem](#getnextitem)です。  
  
##  <a name="getlastvisibleitem"></a>CTreeCtrl::GetLastVisibleItem  
 現在のツリー ビュー コントロール内の最後のノードが展開されていない項目を取得します。  
  
```  
HTREEITEM GetLastVisibleItem() const;  
```  
  
### <a name="return-value"></a>戻り値  
 メソッドが成功した場合の最後のノードが展開されていない項目を識別するハンドルそれ以外の場合、`NULL`です。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_GETNEXTITEM](http://msdn.microsoft.com/library/windows/desktop/bb773622) Windows SDK で説明するメッセージ。 詳細については、次を参照してください。、`TVGN_LASTVISIBLE`フラグ、`flag`そのメッセージのパラメーターです。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 1 つ以上のこれらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例では、最後の展開されていないツリー ビュー ノードのアイテムへのハンドルを取得し、そのアイテムの周囲の 3D の四角形を描画します。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]  
  
##  <a name="getlinecolor"></a>CTreeCtrl::GetLineColor  
 このメンバー関数は、win32 メッセージの動作を実装して[TVM_GETLINECOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773619)Windows SDK で説明されている。  
  
```  
COLORREF GetLineColor() const;  
```  
  
### <a name="return-value"></a>戻り値  
 現在の行の色。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]  
  
##  <a name="getnextitem"></a>CTreeCtrl::GetNextItem  
 ツリーを取得するには、この関数のビュー項目です呼び出しによって示される、指定されたリレーションシップでは、`nCode`パラメーターを`hItem`です。  
  
```  
HTREEITEM GetNextItem(
    HTREEITEM hItem,  
    UINT nCode) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
 `nCode`  
 リレーションシップの種類を示すフラグを`hItem`です。 このフラグは、次の値のいずれかになります。  
  
- `TVGN_CARET`現在選択されている項目を取得します。  
  
- `TVGN_CHILD`指定した項目の最初の子項目を取得、`hItem`パラメーター。  
  
- `TVGN_DROPHILITE`ドラッグ アンド ドロップ操作の対象となっている項目を取得します。  
  
- `TVGN_FIRSTVISIBLE`最初に表示される項目を取得します。  
  
- `TVGN_LASTVISIBLE`ツリー内の最後の拡張項目を取得します。 これには、ツリー ビュー ウィンドウに表示されている最後の項目は取得しません。  
  
- `TVGN_NEXT`次の兄弟アイテムを取得します。  
  
- `TVGN_NEXTVISIBLE`指定した項目に続く次に表示される項目を取得します。  
  
- `TVGN_PARENT`指定した項目の親を取得します。  
  
- `TVGN_PREVIOUS`前の兄弟の項目を取得します。  
  
- `TVGN_PREVIOUSVISIBLE`最初に指定した項目の前に表示される項目を取得します。  
  
- `TVGN_ROOT`指定した項目が一部であるルート項目の最初の子項目を取得します。  
  
### <a name="return-value"></a>戻り値  
 成功した場合は、次のアイテムのハンドルそれ以外の場合**NULL**です。  
  
### <a name="remarks"></a>コメント  
 この関数は**NULL**取得する項目が、ツリーのルート ノードである場合。 たとえば、このメッセージで使用する場合、`TVGN_PARENT`フラグ ツリー ビューのルート ノードでは、最初のレベルの子をメッセージが返されます**NULL**です。  
  
### <a name="example"></a>例  
 使用する例については`GetNextItem`、ループ内で、次を参照してください。 [CTreeCtrl::DeleteItem](#deleteitem)です。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]  
  
##  <a name="getnextsiblingitem"></a>CTreeCtrl::GetNextSiblingItem  
 次の兄弟を取得するには、この関数を呼び出す`hItem`です。  
  
```  
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 次の兄弟アイテムのハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]  
  
##  <a name="getnextvisibleitem"></a>CTreeCtrl::GetNextVisibleItem  
 [次へ] に表示される項目を取得するには、この関数を呼び出す`hItem`です。  
  
```  
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 [次へ] に表示される項目のハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetCheck](#setcheck)です。  
  
##  <a name="getparentitem"></a>CTreeCtrl::GetParentItem  
 親を取得するには、この関数を呼び出す`hItem`です。  
  
```  
HTREEITEM GetParentItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 親アイテムのハンドルそれ以外の場合**NULL**です。  
  
### <a name="remarks"></a>コメント  
 この関数は**NULL**場合は、指定した項目の親は、ツリーのルート ノードです。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::EnsureVisible](#ensurevisible)です。  
  
##  <a name="getprevsiblingitem"></a>CTreeCtrl::GetPrevSiblingItem  
 前の兄弟を取得するには、この関数を呼び出す`hItem`です。  
  
```  
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 前の兄弟のハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]  
  
##  <a name="getprevvisibleitem"></a>CTreeCtrl::GetPrevVisibleItem  
 前に表示される項目を取得するには、この関数を呼び出す`hItem`です。  
  
```  
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 前の表示項目のハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]  
  
##  <a name="getrootitem"></a>CTreeCtrl::GetRootItem  
 ツリー ビュー コントロールのルート項目を取得するには、この関数を呼び出します。  
  
```  
HTREEITEM GetRootItem() const;  
```  
  
### <a name="return-value"></a>戻り値  
 ルート アイテムのハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::EditLabel](#editlabel)です。  
  
##  <a name="getscrolltime"></a>CTreeCtrl::GetScrollTime  
 ツリー ビュー コントロールの最大スクロール時刻を取得するには、このメンバー関数を呼び出します。  
  
```  
UINT GetScrollTime() const;  
```  
  
### <a name="return-value"></a>戻り値  
 最大スクロールの時間 (ミリ秒)。  
  
### <a name="remarks"></a>コメント  
 このメンバー関数は、win32 メッセージの動作を実装して[TVM_GETSCROLLTIME](http://msdn.microsoft.com/library/windows/desktop/bb773625)Windows SDK で説明されている。  
  
##  <a name="getselectedcount"></a>CTreeCtrl::GetSelectedCount  
 現在のツリー ビュー コントロールで選択した項目の数を取得します。  
  
```  
UINT GetSelectedCount();
```  
  
### <a name="return-value"></a>戻り値  
 選択した項目の数。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_GETSELECTEDCOUNT](http://msdn.microsoft.com/library/windows/desktop/bb773629) Windows SDK で説明するメッセージ。  
  
##  <a name="getselecteditem"></a>CTreeCtrl::GetSelectedItem  
 この関数では、ツリー ビュー コントロールの現在選択されている項目を取得します。  
  
```  
HTREEITEM GetSelectedItem() const;  
```  
  
### <a name="return-value"></a>戻り値  
 選択したアイテムのハンドルそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]  
  
##  <a name="gettextcolor"></a>CTreeCtrl::GetTextColor  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_GETTEXTCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773633)Windows SDK で説明されている。  
  
```  
COLORREF GetTextColor() const;  
```  
  
### <a name="return-value"></a>戻り値  
 A **COLORREF**を現在のテキストの色を表す値です。 この値が-1 の場合は、コントロールがテキストの色のシステム カラーを使用します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetTextColor](#settextcolor)です。  
  
##  <a name="gettooltips"></a>CTreeCtrl::GetToolTips  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_GETTOOLTIPS](http://msdn.microsoft.com/library/windows/desktop/bb773729)Windows SDK で説明されている。  
  
```  
CToolTipCtrl* GetToolTips() const;  
```  
  
### <a name="return-value"></a>戻り値  
 ポインター、 [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)ツリー コントロールで使用するオブジェクト。 場合、[作成](#create)メンバー関数は、スタイルを使用して**TVS_NOTOOLTIPS**、ツールヒントを使用しないと**NULL**が返されます。  
  
### <a name="remarks"></a>コメント  
 MFC 実装の`GetToolTips`を返します、`CToolTipCtrl`ツールヒント コントロールへのハンドルではなく、ツリー コントロールで使用されるオブジェクト。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]  
  
##  <a name="getvisiblecount"></a>CTreeCtrl::GetVisibleCount  
 この関数では、ツリー ビュー コントロールに表示される項目の数を取得します。  
  
```  
UINT GetVisibleCount() const;  
```  
  
### <a name="return-value"></a>戻り値  
 ツリー ビュー コントロールに表示される項目の数それ以外の場合 - 1。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetCheck](#setcheck)です。  
  
##  <a name="hittest"></a>CTreeCtrl::HitTest  
 ツリー ビュー コントロールのクライアント領域に対する指定されたポイントの場所を特定するには、この関数を呼び出します。  
  
```  
HTREEITEM HitTest(
    CPoint pt,  
    UINT* pFlags = NULL) const;  
  
HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `pt`  
 クライアントをテストするには、点の座標。  
  
 `pFlags`  
 ヒット テストの結果に関する情報を受け取る整数へのポインター。 いずれかまたは複数の値の下に表示される、**フラグ**「解説」セクション内のメンバーです。  
  
 `pHitTestInfo`  
 アドレス、 [TVHITTESTINFO](http://msdn.microsoft.com/library/windows/desktop/bb773448)ヒット テストする位置を格納する構造体がヒット テストの結果に関する情報を受け取ります。  
  
### <a name="return-value"></a>戻り値  
 指定したポイントを占有するツリー ビューのアイテムのハンドルまたは**NULL**場合は項目が、ポイントを使用しません。  
  
### <a name="remarks"></a>コメント  
 この関数が呼び出されたときに、`pt`パラメーターをテストする点の座標を指定します。 指定した位置に項目のハンドルを返しますまたは**NULL**場合は項目が、ポイントを使用しません。 さらに、`pFlags`パラメーターには指定した点の位置を示す値が含まれています。 指定できる値は次のとおりです。  
  
|||  
|-|-|  
|[値]|説明|  
|TVHT_ABOVE|クライアント領域の上にします。|  
|TVHT_BELOW|クライアント領域の下。|  
|TVHT_NOWHERE|クライアント領域では、最後の項目の下。|  
|TVHT_ONITEM|ビットマップまたはアイテムに関連付けられたラベル。|  
|TVHT_ONITEMBUTTON|項目に関連付けられているボタンです。|  
|TVHT_ONITEMICON|項目に関連付けられているビットマップ。|  
|TVHT_ONITEMINDENT|内の項目に関連付けられているインデントします。|  
|TVHT_ONITEMLABEL|項目に関連付けられているラベル (string)。|  
|TVHT_ONITEMRIGHT|アイテムの右側に領域。|  
|TVHT_ONITEMSTATEICON|ユーザー定義の状態にあるツリー ビューの項目の状態アイコンでします。|  
|TVHT_TOLEFT|クライアント領域の左側のです。|  
|TVHT_TORIGHT|クライアント領域の桁数。|  
|||  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]  
  
##  <a name="insertitem"></a>CTreeCtrl::InsertItem  
 ツリー ビュー コントロールに新しい項目を挿入するには、この関数を呼び出します。  
  
```  
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

 
HTREEITEM InsertItem(
    UINT nMask,  
    LPCTSTR lpszItem,  
    int nImage,  
    int nSelectedImage,  
    UINT nState,  
    UINT nStateMask,  
    LPARAM lParam,  
    HTREEITEM hParent,  
    HTREEITEM hInsertAfter);

 
HTREEITEM InsertItem(
    LPCTSTR lpszItem,  
    HTREEITEM hParent = TVI_ROOT,  
    HTREEITEM hInsertAfter = TVI_LAST);

 
HTREEITEM InsertItem(
    LPCTSTR lpszItem,  
    int nImage,  
    int nSelectedImage,  
    HTREEITEM hParent = TVI_ROOT,  
    HTREEITEM hInsertAfter = TVI_LAST);
```  
  
### <a name="parameters"></a>パラメーター  
 *lpInsertStruct*  
 ポインター、`TVINSERTSTRUCT`挿入される、ツリー ビューの項目の属性を指定します。  
  
 `nMask`  
 設定する属性を指定する整数。 参照してください、 `TVITEM` Windows SDK 内の構造。  
  
 `lpszItem`  
 アイテムのテキストを含む文字列のアドレスです。  
  
 `nImage`  
 ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックス。  
  
 `nSelectedImage`  
 ツリー ビュー コントロールのイメージ リスト内のアイテムの選択したイメージのインデックス。  
  
 `nState`  
 項目の状態の値を指定します。 「」を参照ツリー ビュー コントロール項目の状態の適切な状態の一覧については、Windows SDK でします。  
  
 `nStateMask`  
 設定する状態を指定します。 参照してください、 `TVITEM` Windows SDK 内の構造。  
  
 `lParam`  
 アイテムに関連付けられている 32 ビット アプリケーションに固有の値。  
  
 `hParent`  
 挿入されたアイテムの親のハンドルです。  
  
 *hInsertAfter*  
 その後、新しい項目を挿入するアイテムのハンドル。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は、新しいアイテムのハンドルそれ以外の場合**NULL**です。  
  
### <a name="remarks"></a>コメント  
 この例では、ツリー コントロール項目を挿入するときに、関数の各バージョンを使用する状況を示します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]  
  
##  <a name="itemhaschildren"></a>CTreeCtrl::ItemHasChildren  
 この関数を使用して、ツリー項目がで指定されたかどうかを決定する`hItem`子項目があります。  
  
```  
BOOL ItemHasChildren(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 ツリー項目で指定する場合は 0 以外`hItem`子項目です。 そうでない場合は 0 です。  
  
### <a name="remarks"></a>コメント  
 そのため、使用できる場合、 [CTreeCtrl::GetChildItem](#getchilditem)それらの子項目を取得します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetSelectedItem](#getselecteditem)です。  
  
##  <a name="mapaccidtoitem"></a>CTreeCtrl::MapAccIdToItem  
 現在のツリー ビュー コントロール内のツリー ビュー アイテムのハンドルに指定されたアクセシビリティの識別子をマップします。  
  
```  
HTREEITEM MapAccIdToItem(UINT uAccId) const;  
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `uAccId`|ツリー ビュー項目内の要素に対してユーザー補助識別子です。|  
  
### <a name="return-value"></a>戻り値  
 ツリー ビューのアイテムへのハンドル ( `HTREEITEM`) に対応する、`uAccId`パラメーター。 詳細については、次を参照してください。、`hItem`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体。  
  
### <a name="remarks"></a>コメント  
 ユーザー補助機能は、障碍を持つユーザーを支援するアプリケーションがコンピューターを使用します。 ユーザー補助機能識別子を使用して、`IAccessible`インターフェイスのウィンドウで要素を一意に指定します。 ユーザー補助機能の識別子の詳細についてで「に関する Active Accessibility のサポート」トピックを検索[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)です。  
  
 このメソッドは、送信、 [TVM_MAPACCIDTOHTREEITEM](http://msdn.microsoft.com/library/windows/desktop/bb773734) Windows SDK で説明するメッセージ。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例は、ユーザー補助機能識別子を使用して、 [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)ルート ツリー ビューの項目へのハンドルを取得します。 例では、ハンドルを使用して、 [CTreeCtrl::GetItemPartRect](#getitempartrect)そのアイテムの周囲の 3D の四角形を描画するメソッド。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。 使用して、 [CTreeCtrl::MapItemToAccID](#mapitemtoaccid)項目に関連付けるルート ツリー ビュー、ユーザー補助機能の識別子を持つメソッドです。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]  
  
##  <a name="mapitemtoaccid"></a>CTreeCtrl::MapItemToAccID  
 現在のツリー ビュー コントロール内のツリー ビューの項目の指定したハンドルをユーザー補助識別子に割り当てます。  
  
```  
UINT MapItemToAccID(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|コントロール内のツリー ビューのアイテムのハンドル。 詳細については、次を参照してください。、`hItem`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体。|  
  
### <a name="return-value"></a>戻り値  
 対応するユーザー補助識別子、`hItem`パラメーター。  
  
### <a name="remarks"></a>コメント  
 ユーザー補助機能は、障碍を持つユーザーを支援するアプリケーションがコンピューターを使用します。 ユーザー補助機能識別子を使用して、`IAccessible`インターフェイスのウィンドウで要素を一意に指定します。 ユーザー補助機能の識別子の詳細についてで「に関する Active Accessibility のサポート」トピックを検索[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)です。  
  
 このメソッドは、送信、 [TVM_MAPHTREEITEMTOACCID](http://msdn.microsoft.com/library/windows/desktop/bb773735) Windows SDK で説明するメッセージ。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例では、ツリー ビュー コントロールの項目の識別番号を取得します。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。 このコード例では、国/地域のルート ノードの一意な識別番号を取得します。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]  
  
##  <a name="select"></a>CTreeCtrl::Select  
 この関数では、指定されたツリー ビューのアイテムを選択、項目をスクロールして表示、またはアイテムをドラッグ アンド ドロップ操作の対象を示すために使用されるスタイルに再描画します。  
  
```  
BOOL Select(
    HTREEITEM hItem,  
    UINT nCode);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
 `nCode`  
 実行するアクションの種類。 このパラメーターには、次の値のいずれかを指定できます。  
  
- `TVGN_CARET`指定した項目を選択範囲を設定します。  
  
- `TVGN_DROPHILITE`ドラッグ アンド ドロップ操作の対象を示すために使用されるスタイルで指定したアイテムを再描画します。  
  
- `TVGN_FIRSTVISIBLE`ツリー ビューを垂直方向にスクロールできるように、指定された項目が最初に表示される項目。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 場合`nCode`値を含む`TVGN_CARET`、親ウィンドウが、 **TVN_SELCHANGING**と**TVN_SELCHANGED**通知メッセージです。 さらに、指定した項目が、折りたたまれた親アイテムの子である場合は、子項目の親のリストを展開すると、指定した項目を表示することがします。 この場合、親ウィンドウを受け取る、 **TVN_ITEMEXPANDING**と**TVN_ITEMEXPANDED**通知メッセージです。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::HitTest](#hittest)です。  
  
##  <a name="selectdroptarget"></a>CTreeCtrl::SelectDropTarget  
 この関数では、ドラッグ アンド ドロップ操作の対象を示すために使用されるスタイルでアイテムを再描画します。  
  
```  
BOOL SelectDropTarget(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]  
  
##  <a name="selectitem"></a>CTreeCtrl::SelectItem  
 この関数では、指定されたツリー ビューの項目を選択します。  
  
```  
BOOL SelectItem(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 ツリー項目のハンドルです。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 場合`hItem`は**NULL**、この関数に項目が選択されません。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]  
  
##  <a name="selectsetfirstvisible"></a>CTreeCtrl::SelectSetFirstVisible  
 この関数では、指定したアイテムが最初に表示される項目をされるように、ツリー ビューを垂直方向にスクロールします。  
  
```  
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 最初に表示される項目として設定するアイテムのハンドルです。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 関数がウィンドウにメッセージを送信、`TVM_SELECTITEM`と`TVGN_FIRSTVISIBLE`メッセージのパラメーターです。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]  
  
##  <a name="setautoscrollinfo"></a>CTreeCtrl::SetAutoscrollInfo  
 現在のツリー ビュー コントロールのスクロール率を設定します。  
  
```  
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,   
    UINT uUpdateTime);
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `uPixelsPerSec`|スクロールする 1 秒あたりのピクセルの数。|  
|[入力] `uUpdateTime`|コントロールの更新の時間間隔。|  
  
### <a name="return-value"></a>戻り値  
 常に `true` を返します。  
  
### <a name="remarks"></a>コメント  
 自動スクロール パラメーターは、現在表示されていない項目をスクロールして表示に使用されます。 ツリー ビュー コントロールがあります、`TVS_EX_AUTOHSCROLL`拡張に説明されているスタイル[ツリー ビュー コントロールの拡張スタイル](http://msdn.microsoft.com/library/windows/desktop/bb759981)です。  
  
 このメソッドは、送信、 [TVM_SETAUTOSCROLLINFO](http://msdn.microsoft.com/library/windows/desktop/bb773738) Windows SDK で説明するメッセージ。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例では、現在のツリー ビュー コントロールのスクロール動作を設定します。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。 意図的に行いましたツリー ビュー コントロール ナローが自動的にフォーカスを持っているツリー項目を表示するスクロールできるようにします。 コード例では、ツリー項目がビューに表示されるまで、5 秒ごとの 1 秒あたり 30 ピクセルを自動的にスクロールするツリー ビュー コントロールを設定します。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]  
  
##  <a name="setbkcolor"></a>CTreeCtrl::SetBkColor  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_SETBKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773741)Windows SDK で説明されている。  
  
```  
COLORREF SetBkColor(COLORREF clr);
```  
  
### <a name="parameters"></a>パラメーター  
 `clr`  
 A **COLORREF**新しい背景色を表す値です。 この値が-1 の場合は、コントロールは、背景色のシステム カラーを使用してに戻ります。  
  
### <a name="return-value"></a>戻り値  
 A **COLORREF**を現在のテキストの色を表す値です。 この値が-1 の場合は、コントロールがテキストの色のシステム カラーを使用します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::SetTextColor](#settextcolor)です。  
  
##  <a name="setcheck"></a>CTreeCtrl::SetCheck  
 ツリー コントロールの項目のチェック状態を設定するには、このメンバー関数を呼び出します。  
  
```  
BOOL SetCheck(
    HTREEITEM hItem,  
    BOOL fCheck = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 **HTREEITEM**チェック状態の変更を受信します。  
  
 `fCheck`  
 ツリー コントロール項目をオンまたはオフにするかどうかを示します。 既定では、`SetCheck`チェックする項目を設定します。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 ツリー コントロール項目がチェックされるとき (`fCheck`に設定**TRUE**)、項目の隣にチェック マークが表示されます。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]  
  
### <a name="example"></a>例  
 チェック ボックスを使用するのには、ツリー コントロールを設定する前に TVS_CHECKBOXES を設定します。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]  
  
##  <a name="setextendedstyle"></a>CTreeCtrl::SetExtendedStyle  
 現在のツリー ビュー コントロールの拡張スタイルを設定します。  
  
```  
DWORD SetExtendedStyle(
    DWORD dwExMask,   
    DWORD dwExStyles);
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `dwExMask`|現在のツリー ビュー コントロールのスタイルがこのメソッドによって影響を受けたを指定するビットマスク。 このパラメーターが 0 の場合は無視されますとの値、`dwExStyles`パラメーターがツリー ビュー コントロールに割り当てられます。<br /><br /> 0 またはで説明されているスタイルのビットごとの組み合わせ (OR) を指定して[ツリー ビュー コントロールの拡張スタイル](http://msdn.microsoft.com/library/windows/desktop/bb759981)です。|  
|[入力] `dwExStyles`|現在のツリー ビューのスタイルを設定または解除に制御を指定するビットマスク。<br /><br /> スタイルの組み合わせを設定するで説明されているスタイルのビットごとの組み合わせ (OR) を指定[ツリー ビュー コントロールの拡張スタイル](http://msdn.microsoft.com/library/windows/desktop/bb759981)です。 一連のスタイルをクリアするには、0 を指定します。|  
  
### <a name="return-value"></a>戻り値  
 前のコントロールのスタイルの拡張を含む値です。  
  
### <a name="remarks"></a>コメント  
 このメソッドで指定されたスタイルをクリアする、`dwExMask`パラメーターで指定されたスタイルを設定し、`dwExStyles`パラメーター。 内のビットに対応する拡張スタイル`dwExMask`を変更します。  
  
 このメソッドは、送信、 [TVM_SETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb773744) Windows SDK で説明するメッセージ。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例では追加、`TVS_EX_AUTOHSCROLL`現在のツリー ビュー コントロールにスタイルを拡張します。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。 意図的に行いましたツリー ビュー コントロール ナローが自動的にフォーカスを持っているツリー項目を表示するスクロールできるようにします。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]  
  
##  <a name="setimagelist"></a>CTreeCtrl::SetImageList  
 法線を設定するには、この関数を呼び出すまたはツリーの状態のイメージ リスト コントロールを表示し、新しいイメージを使用してコントロールを再描画します。  
  
```  
CImageList* SetImageList(
    CImageList* pImageList,  
    int nImageListType);
```  
  
### <a name="parameters"></a>パラメーター  
 `pImageList`  
 割り当てるイメージ リストへのポインター。 場合`pImageList`は**NULL**、すべてのイメージがツリー ビュー コントロールから削除されます。  
  
 `nImageListType`  
 設定するイメージ リストの種類です。 イメージ リストには、次の値のいずれかを指定できます。  
  
- `TVSIL_NORMAL`イメージ リストには、ツリー ビューのアイテムを選択し、選択されていないイメージを含むを設定します。 イメージのオーバーレイは、この状態を使用する必要があります。  
  
- `TVSIL_STATE`ユーザー定義の状態にあるツリー ビューのアイテムの画像が含まれている状態のイメージ リストを設定します。  
  
### <a name="return-value"></a>戻り値  
 存在する場合は前のイメージ リストへのポインターそれ以外の場合**NULL**です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetImageList](#getimagelist)です。  
  
##  <a name="setindent"></a>CTreeCtrl::SetIndent  
 ツリー ビュー コントロールのインデントの幅を設定し、新しい幅を反映するようにコントロールを再描画するには、この関数を呼び出します。  
  
```  
void SetIndent(UINT nIndent);
```  
  
### <a name="parameters"></a>パラメーター  
 `nIndent`  
 インデントのピクセル単位の幅。 場合`nIndent`が小さいシステム定義の最小幅よりも新しい幅がシステム定義の最小値に設定します。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetIndent](#getindent)です。  
  
##  <a name="setinsertmark"></a>CTreeCtrl::SetInsertMark  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_SETINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb773753)Windows SDK で説明されている。  
  
```  
BOOL SetInsertMark(
    HTREEITEM hItem,  
    BOOL fAfter = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 **HTREEITEM**挿入マークの配置先アイテムを指定します。 この引数は場合**NULL**、挿入マークを削除します。  
  
 *fAfter*  
 **BOOL**指定した項目の前後に挿入マークは、配置を指定する値。 この引数が 0 以外の場合は、挿入マークは、項目の後に配置されます。 この引数がゼロの場合、挿入マークは、項目の前に配置されます。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]  
  
##  <a name="setinsertmarkcolor"></a>CTreeCtrl::SetInsertMarkColor  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_SETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773755)Windows SDK で説明されている。  
  
```  
COLORREF SetInsertMarkColor(COLORREF clrNew);
```  
  
### <a name="parameters"></a>パラメーター  
 `clrNew`  
 A **COLORREF**新しい挿入マークの色を表す値です。  
  
### <a name="return-value"></a>戻り値  
 A **COLORREF**挿入マークの以前の色を表す値です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)です。  
  
##  <a name="setitem"></a>CTreeCtrl::SetItem  
 指定されたツリー ビューのアイテムの属性を設定するには、この関数を呼び出します。  
  
```  
BOOL SetItem(TVITEM* pItem);

 
BOOL SetItem(
    HTREEITEM hItem,  
    UINT nMask,  
    LPCTSTR lpszItem,  
    int nImage,  
    int nSelectedImage,  
    UINT nState,  
    UINT nStateMask,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>パラメーター  
 `pItem`  
 ポインター、 [TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456) Windows SDK」の説明に従って、新しい項目を格納する構造体の属性です。  
  
 `hItem`  
 属性を設定するアイテムのハンドルです。 参照してください、 **hItem**のメンバー、 `TVITEM` Windows SDK 内の構造。  
  
 `nMask`  
 設定する属性を指定する整数。 参照してください、**マスク**のメンバー、`TVITEM`構造体。  
  
 `lpszItem`  
 アイテムのテキストを含む文字列のアドレスです。  
  
 `nImage`  
 ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックス。 参照してください、`iImage`のメンバー、`TVITEM`構造体。  
  
 `nSelectedImage`  
 ツリー ビュー コントロールのイメージ リスト内のアイテムの選択したイメージのインデックス。 参照してください、 **iSelectedImage**のメンバー、`TVITEM`構造体。  
  
 `nState`  
 項目の状態の値を指定します。 参照してください、**状態**のメンバー、`TVITEM`構造体。  
  
 `nStateMask`  
 設定する状態を指定します。 参照してください、**対象**のメンバー、`TVITEM`構造体。  
  
 `lParam`  
 アイテムに関連付けられている 32 ビット アプリケーションに固有の値。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 `TVITEM`構造体、 **hItem**メンバーは、項目を識別し、**マスク**メンバーを設定する属性を指定します。  
  
 場合、**マスク**メンバーまたは`nMask`パラメーターを指定します、`TVIF_TEXT`値、 **pszText**メンバーまたは`lpszItem`null で終わる文字列と、のアドレスは、**cchTextMax**メンバーは無視されます。 場合**マスク**(または`nMask`) を指定します、`TVIF_STATE`値、**対象**メンバーまたは`nStateMask`パラメーターを指定する項目の状態を変更して、**状態**メンバーまたは`nState`パラメーターには、これらの状態の値が含まれています。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]  
  
##  <a name="setitemdata"></a>CTreeCtrl::SetItemData  
 指定した項目に関連付けられている 32 ビット アプリケーションに固有の値を設定するには、この関数を呼び出します。  
  
```  
BOOL SetItemData(
    HTREEITEM hItem,  
    DWORD_PTR dwData);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 テーブルのデータを取得するアイテムのハンドル。  
  
 `dwData`  
 指定した項目に関連付けられている 32 ビット アプリケーションに固有の値`hItem`です。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]  
  
##  <a name="setitemexpandedimageindex"></a>CTreeCtrl::SetItemExpandedImageIndex  
 現在のツリー ビュー コントロールの指定した項目が展開された状態を表示するイメージのインデックスを設定します。  
  
```  
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,   
    int iExpandedImage);
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|ツリー ビュー コントロールの項目へのハンドルします。|  
|[入力] `iExpandedImage`|指定した項目が展開された状態を表示するイメージのインデックス。|  
  
### <a name="return-value"></a>戻り値  
 `true`このメソッドが成功した場合それ以外の場合、`false`です。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_SETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773758) Windows SDK で説明するメッセージ。 このメソッドは割り当てます、`iExpandedImage`パラメーターを`iExpandedImage`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体、および、メッセージの構造体を使用します。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例は、単純なテストを決定するかどうか、 [CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)メソッドによって設定された値が返されます、 [CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)メソッドです。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]  
  
##  <a name="setitemheight"></a>CTreeCtrl::SetItemHeight  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_SETITEMHEIGHT](http://msdn.microsoft.com/library/windows/desktop/bb773761)Windows SDK で説明されている。  
  
```  
SHORT SetItemHeight(SHORT cyHeight);
```  
  
### <a name="parameters"></a>パラメーター  
 `cyHeight`  
 ピクセル単位で、ツリー ビュー内のすべての項目の新しい高さを指定します。 この引数が、イメージの高さよりも小さい場合は、イメージの高さに設定されます。 この引数があってもがない場合に切り捨てられますが、最も近い偶数値。 この引数が-1 の場合は、コントロールは、既定の項目の高さを使用してに戻ります。  
  
### <a name="return-value"></a>戻り値  
 ピクセル単位で、項目の前の高さ。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetItemHeight](#getitemheight)です。  
  
##  <a name="setitemimage"></a>CTreeCtrl::SetItemImage  
 イメージを項目に関連付けます。  
  
```  
BOOL SetItemImage(
    HTREEITEM hItem,  
    int nImage,  
    int nSelectedImage);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 イメージを設定するアイテムのハンドル。  
  
 `nImage`  
 ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックス。  
  
 `nSelectedImage`  
 ツリー ビュー コントロールのイメージ リスト内のアイテムの選択したイメージのインデックス。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 ツリー ビュー コントロール内の各項目には、関連付けられているビットマップ イメージのペアを持つことができます。 項目のラベルの左側にある、画像が表示されます。 項目が選択されているし、項目が選択されていないときに表示されたら、他の 1 つのイメージが表示されます。 たとえば、項目が選択されていないときに、開いているフォルダーを選択すると閉じたフォルダーを表示できます。  
  
 この関数では、項目のイメージ、およびツリー ビュー コントロールのイメージ リスト内で選択したイメージのインデックスを設定します。  
  
 イメージの詳細については、次を参照してください。 [CImageList](../../mfc/reference/cimagelist-class.md)です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetItemImage](#getitemimage)です。  
  
##  <a name="setitemstate"></a>CTreeCtrl::SetItemState  
 指定した項目の状態を設定`hItem`です。  
  
```  
BOOL SetItemState(
    HTREEITEM hItem,  
    UINT nState,  
    UINT nStateMask);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 状態を設定するアイテムのハンドルです。  
  
 `nState`  
 項目の新しい状態を指定します。  
  
 `nStateMask`  
 どの状態が変更するかを指定します。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 状態については、次を参照してください。 [CTreeCtrl::GetItem](#getitem)です。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetItemState](#getitemstate)です。  
  
##  <a name="setitemstateex"></a>CTreeCtrl::SetItemStateEx  
 現在のツリー ビュー コントロールの指定した項目の拡張の状態を設定します。  
  
```  
BOOL SetItemStateEx(
    HTREEITEM hItem,   
    UINT uStateEx);
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|ツリー ビュー コントロールの項目へのハンドルします。|  
|[入力] `uStateEx`|項目の拡張の状態。 詳細については、次を参照してください。、`uStateEx`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体。|  
  
### <a name="return-value"></a>戻り値  
 `true`このメソッドが成功した場合それ以外の場合、`false`です。  
  
### <a name="remarks"></a>コメント  
 このメソッドは、送信、 [TVM_SETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773758) Windows SDK で説明するメッセージ。 このメソッドは割り当てます、`uStateEx`パラメーターを`uStateEx`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体、および、メッセージの構造体を使用します。  
  
### <a name="example"></a>例  
 次のコード例の変数を定義`m_treeCtrl`、つまり現在のツリー ビュー コントロールにアクセスするために使用します。 このコード例は、符号なし整数といくつかの HTREEITEM 変数にも定義します。 これらの変数は、次の例で使用されます。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>例  
 次のコード例は、ツリー ビューの項目を無効の状態を設定します。 コード例は、示されていませんが、前のセクションでは、米国の国/地域ルート ノード、ペンシルベニアおよびワシントン州の状態を表すサブノードおよびこれらの州の都市のツリー項目で構成されるツリー ビューを作成しました。 このコード例では、無効の状態をペンシルベニア ノードを設定します。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]  
  
##  <a name="setitemtext"></a>CTreeCtrl::SetItemText  
 指定した項目のテキストを設定`hItem`です。  
  
```  
BOOL SetItemText(
    HTREEITEM hItem,  
    LPCTSTR lpszItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 テキストを設定するアイテムのハンドルです。  
  
 `lpszItem`  
 項目の新しいテキストを含む文字列のアドレス  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]  
  
##  <a name="setlinecolor"></a>CTreeCtrl::SetLineColor  
 ツリー ビュー コントロールの現在の線の色を設定するには、このメンバー関数を呼び出します。  
  
```  
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```  
  
### <a name="parameters"></a>パラメーター  
 `clrNew`  
 新しい行の色。  
  
### <a name="return-value"></a>戻り値  
 以前の線の色。  
  
### <a name="remarks"></a>コメント  
 このメンバー関数は、win32 メッセージの動作を実装して[TVM_SETLINECOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773764)Windows SDK で説明されている。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]  
  
##  <a name="setscrolltime"></a>CTreeCtrl::SetScrollTime  
 ツリー ビュー コントロールのスクロールの最大時間を設定するには、このメンバー関数を呼び出します。  
  
```  
UINT SetScrollTime(UINT uScrollTime);
```  
  
### <a name="parameters"></a>パラメーター  
 *uScrollTime*  
 新しいの最大スクロール時間 (ミリ秒)。 この値が 100 未満の場合は、ことが 100 に切り上げです。  
  
### <a name="return-value"></a>戻り値  
 以前の最大スクロール時間 (ミリ秒)。  
  
### <a name="remarks"></a>コメント  
 このメンバー関数は、win32 メッセージの動作を実装して[TVM_SETSCROLLTIME](http://msdn.microsoft.com/library/windows/desktop/bb773767)Windows SDK で説明されている。  
  
##  <a name="settextcolor"></a>CTreeCtrl::SetTextColor  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_SETTEXTCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773769)Windows SDK で説明されている。  
  
```  
COLORREF SetTextColor(COLORREF clr);
```  
  
### <a name="parameters"></a>パラメーター  
 `clr`  
 A **COLORREF**新しいテキストの色を表す値です。 この引数が-1 の場合は、コントロールはテキストの色のシステム カラーを使用してに戻ります。  
  
### <a name="return-value"></a>戻り値  
 A **COLORREF**を以前のテキストの色を表す値です。 この値が-1 の場合は、コントロール テキストの色のシステム カラーが使用されました。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]  
  
##  <a name="settooltips"></a>CTreeCtrl::SetToolTips  
 このメンバー関数は、Win32 メッセージの動作を実装して[TVM_SETTOOLTIPS](http://msdn.microsoft.com/library/windows/desktop/bb773772)Windows SDK で説明されている。  
  
```  
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```  
  
### <a name="parameters"></a>パラメーター  
 `pWndTip`  
 ポインター、 [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)ツリー コントロールで使用するオブジェクト。  
  
### <a name="return-value"></a>戻り値  
 ポインター、 [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)コントロールによって使用されていたヒントを含むオブジェクトまたは**NULL**ツールヒントを使用していません以前場合。  
  
### <a name="remarks"></a>コメント  
 ツール ヒントを使用するには、 **TVS_NOTOOLTIPS**スタイルを作成するとき、`CTreeCtrl`オブジェクト。  
  
### <a name="example"></a>例  
  例を参照して[CTreeCtrl::GetToolTips](#gettooltips)です。  
  
##  <a name="showinfotip"></a>CTreeCtrl::ShowInfoTip  
 現在のツリー ビュー コントロール内の指定したアイテムのヒントを表示します。  
  
```  
void ShowInfoTip(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
  
|パラメーター|説明|  
|---------------|-----------------|  
|[入力] `hItem`|コントロール内のツリー ビューのアイテムへのハンドル。 詳細については、次を参照してください。、`hItem`のメンバー、 [TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)構造体。|  
  
### <a name="remarks"></a>コメント  
 ヒントの違いの詳細についてで「ツールヒントとヒント」トピックを検索[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)です。  
  
 このメソッドは、送信、 [TVM_SHOWINFOTIP](http://msdn.microsoft.com/library/windows/desktop/bb773779) Windows SDK で説明するメッセージ。  
  
##  <a name="sortchildren"></a>CTreeCtrl::SortChildren  
 ツリー ビュー コントロール内の指定された親項目の子項目をアルファベット順に並べ替えるには、この関数を呼び出します。  
  
```  
BOOL SortChildren(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>パラメーター  
 `hItem`  
 子項目が並べ替えられますが、親アイテムのハンドルです。 場合`hItem`は**NULL**、並べ替えは、ツリーのルートから続行されます。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 `SortChildren`ツリーを再帰的に参照できません直接の子のみ`hItem`並べ替えられます。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]  
  
##  <a name="sortchildrencb"></a>CTreeCtrl::SortChildrenCB  
 アイテムを比較するアプリケーション定義のコールバック関数を使用してツリー ビューの項目を並べ替えるには、この関数を呼び出します。  
  
```  
BOOL SortChildrenCB(LPTVSORTCB pSort);
```  
  
### <a name="parameters"></a>パラメーター  
 *pSort*  
 ポインター、 [TVSORTCB](http://msdn.microsoft.com/library/windows/desktop/bb773462)構造体。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 構造体の比較関数では、 **lpfnCompare**、負の値を返す必要があります正値の最初の項目が、2 番目に従う必要がありますか場合は 0、2 つの項目が等しい場合の最初の項目には、2 番目が前に指定する必要がある場合、。  
  
 `lParam1`と`lParam2`パラメーターに対応、 **lParam**のメンバー、 [TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456)の比較対象となる 2 つの項目を構成します。 `lParamSort`パラメーターに対応、 **lParam**のメンバー、`TV_SORTCB`構造体。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]  
  
## <a name="see-also"></a>参照  
 [MFC サンプル CMNCTRL1](../../visual-cpp-samples.md)   
 [CWnd クラス](../../mfc/reference/cwnd-class.md)   
 [階層図](../../mfc/hierarchy-chart.md)   
 [CImageList クラス](../../mfc/reference/cimagelist-class.md)
