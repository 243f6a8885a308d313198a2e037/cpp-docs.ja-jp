---
title: "[データベース サポート] (MFC アプリケーション ウィザード) | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.appwiz.mfc.exe.database"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MFC アプリケーション ウィザード、データベース サポート"
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
caps.latest.revision: 9
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# [データベース サポート] (MFC アプリケーション ウィザード)
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

このページには、プロジェクトのデータベース サポートのレベル、およびデータ ソース \(必要な場合のみ\) を指定するためのオプションが用意されています。  
  
 **データベース サポート**  
 プロジェクトのデータベース サポートのレベルを設定します。  
  
|オプション|説明|  
|-----------|--------|  
|**なし。**|データベースはサポートされません。  これは、既定の設定です。|  
|**\[ヘッダー ファイルのみ\]**|アプリケーションに基本レベルのデータベース サポートを提供します。<br /><br /> <ul><li>\[クライアントの種類\] の \[ODBC\] を選択すると、MFC アプリケーション ウィザードによってヘッダー ファイル AFXDB.H がプロジェクトにインクルードされます。  このファイルによってリンク ライブラリが追加されますが、データベース固有のクラスは作成されません。  レコードセットを後から作成し、それを使用してレコードをチェックおよび更新できます。</li><li>\[クライアントの種類\] の \[OLE DB\] を選択すると、以下のヘッダー ファイルがインクルードされます。<br /><br /> <ul><li>ATLBASE.H</li><li>AFXOLEDB.H</li><li>ATLPLUS.H</li></ul></li></ul>|  
|**\[ファイル サポートのないデータベース ビュー\]**|データベースのヘッダー ファイル、リンク ライブラリ、レコード ビュー、およびレコードセットがインクルードされます。このオプションが使用できるのは、[&#91;アプリケーションの種類&#93;](../Topic/Application%20Type,%20MFC%20Application%20Wizard.md) ページの \[ドキュメント ビュー アーキテクチャ サポート\] を選択したアプリケーションだけです。このオプションには、ドキュメント サポートは含まれますが、シリアル化サポートは含まれません。  データベース ビューを含めるには、データのソースを指定する必要があります。|  
|**\[ファイル サポートのあるデータベース ビュー\]**|データベースのヘッダー ファイル、リンク ライブラリ、レコード ビュー、およびレコードセットがインクルードされます。このオプションが使用できるのは、**\[アプリケーションの種類\]** ページの \[ドキュメント ビュー アーキテクチャ サポート\] を選択したアプリケーションだけです。このオプションでは、ドキュメントのシリアル化をサポートされます。ドキュメントのシリアル化は、ユーザー プロファイル ファイルの更新などに使用できます。  通常、データベース アプリケーションはファイル単位ではなくレコード単位で動作するため、シリアル化は不要です。  ただし、シリアル化が使用される場合もあります。  データベース ビューを含めるには、データのソースを指定する必要があります。|  
  
> [!NOTE]
>  \[データベース サポート\] の \[ファイル サポートのないデータベース ビュー\] または \[ファイル サポートのあるデータベース ビュー\] を選択すると、\[クライアントの種類\] の選択内容に応じて、ビュー クラスの派生が以下のように変わります。  
  
-   \[クライアントの種類\] の \[ODBC\] を選択すると、アプリケーションのビュー クラスは [CRecordView](../../mfc/reference/crecordview-class.md) から派生します。  このクラスは、MFC アプリケーション ウィザードで作成される [CRecordset](../Topic/CRecordset%20Class.md) の派生クラスにも関連付けられます。  このオプションを指定すると、レコード ビューを使用してレコードセット内のレコードの表示と更新を行う、フォーム ベースのアプリケーションが作成されます。  
  
-   \[クライアントの種類\] の \[OLE DB\] を選択すると、ビュー クラスは [COleDBRecordView](../../mfc/reference/coledbrecordview-class.md) から派生し、[CTable](../../data/oledb/ctable-class.md) または [CCommand](../../data/oledb/ccommand-class.md) の派生クラスに関連付けられます。  
  
 **\[クライアントの種類\]**  
 プロジェクトが OLE DB クラスと ODBC クラスのどちらを使用するかを指定します。  
  
|オプション|説明|  
|-----------|--------|  
|**\[OLE DB\]**|このオプションを選択すると、**\[データ ソース\]** をクリックしたときに **\[データ リンク プロパティ\]** ダイアログ ボックスが開き、OLE DB データ ソースへの接続を作成できます。|  
|**\[ODBC\]**|このオプションを選択すると、**\[データ ソース\]** をクリックしたときに \[データ ソースの選択\] ダイアログ ボックスが開き、ODBC データ ソースへの接続を作成できます。|  
  
 **Data Source**  
 **\[データ ソース\]** ボタンをクリックして、指定のドライバーまたはプロバイダーおよびデータベースを使用するデータ ソースを設定します。  \[Client type\] の \[OLE DB\] を選択した場合は、このボタンをクリックすると **\[データ リンク プロパティ\]** ダイアログ ボックスが表示されます。  \[クライアントの種類\] オプションの \[ODBC\] を選択した場合は、このボタンをクリックすると \[データ ソースの選択\] ダイアログ ボックスが表示されます。  このオプションを使用できるのは、データベース ビューのアプリケーションへの組み込みを選択した場合だけです。  
  
|オプション|説明|  
|-----------|--------|  
|**\[データ リンク プロパティ\]** \(OLE DB\)|指定の OLE DB プロバイダーを使用して指定のデータ ソースを設定します。  OLE DB プロバイダー、データの場所、データ ソース、ログオン ID、およびパスワード \(省略可\) を指定する必要があります。  このダイアログ ボックスの詳細については、「[ATL OLEDB コンシューマー ウィザード](../../atl/reference/atl-ole-db-consumer-wizard.md)」のデータ ソースに関する説明を参照してください。|  
|\[データ ソースの選択\] \(ODBC\)|指定の ODBC ドライバーを使用して指定のデータ ソースを設定します。  データ ソース名を指定して、データ ソース用のテーブルを選択する必要があります。  ウィザードによって、テーブルのすべての列が `CRecordset` の派生クラスのメンバー変数にバインドされます。  このダイアログ ボックスの詳細については、「[MFC ODBC コンシューマー ウィザード](../../mfc/reference/mfc-odbc-consumer-wizard.md)」のデータ ソースに関する説明を参照してください。|  
  
> [!NOTE]
>  以前のリリースでは、Shift キーを押しながら **\[データ ソース\]** ボタンをクリックすると \[ファイルを開く\] ダイアログが表示され、データ リンク \(.udl\) ファイルを選択できました。  現在のリリースでは、この機能はサポートされていません。  
  
 **\[属性データベース クラスを生成する\]**  
 使用できるのは OLE DB クライアントだけです。  生成されたプロジェクト内のデータベース クラスで属性を使用するかどうかを指定します。  
  
 **\[すべての列をバインド\]**  
 使用できるのは ODBC クライアントだけです。  選択したテーブルのすべての列をバインドするかどうかを指定します。  このボックスをオンにすると、すべての列がバインドされます。オンにしない場合は、列がバインドされないため、レコードセット クラスで手動でバインドする必要があります。  
  
 **Type**  
 使用できるのは ODBC クライアントだけです。  レコードセットがダイナセットとスナップショットのどちらであるかを指定します。各オプションの内容を以下の表に示します。  
  
|オプション|説明|  
|-----------|--------|  
|**\[ダイナセット\]**|レコードセットがダイナセットであることを示します。  ダイナセットとは、クエリを実行したデータベースのデータにインデックス付きのビューを提供するクエリの結果です。  ダイナセットは、元のデータのインデックス部分だけをキャッシュに格納するため、スナップショットに比べてパフォーマンスが向上します。  インデックスはクエリの各結果レコードを直接指しており、レコードが削除されるかどうかを示します。  クエリが実行されたレコード内の更新情報にもアクセスできます。|  
|\[スナップショット\]|レコードセットがスナップショットであることを示します。  スナップショットとはクエリ結果であり、ある時点におけるデータベースのビューです。  クエリ結果レコードはすべてキャッシュに格納されるため、元のレコードに対する変更内容は参照できません。|  
  
## 参照  
 [MFC アプリケーション ウィザード](../Topic/MFC%20Application%20Wizard.md)