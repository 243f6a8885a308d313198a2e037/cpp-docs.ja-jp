---
title: "COleControl クラス |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 895091131bf8a62a13527f717831a34764c931ff
ms.sourcegitcommit: 9239c52c05e5cd19b6a72005372179587a47a8e4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/16/2018
---
# <a name="colecontrol-class"></a>COleControl クラス
OLE コントロールを開発するための強力な基底クラスです。  
  
## <a name="syntax"></a>構文  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>メンバー  
  
### <a name="public-constructors"></a>パブリック コンストラクター  
  
|名前|説明|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|
          `COleControl` オブジェクトを作成します。|  
  
### <a name="public-methods"></a>パブリック メソッド  
  
|名前|説明|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|コントロールの現在の外観を取得します。|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|アンビエントの色の BackColor プロパティの値を返します。|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|コンテナーによって指定されたコントロールの名前を返します。|  
|[COleControl::AmbientFont](#ambientfont)|アンビエント フォント プロパティの値を返します。|  
|[COleControl::AmbientForeColor](#ambientforecolor)|アンビエント前景色プロパティの値を返します。|  
|[COleControl::AmbientLocaleID](#ambientlocaleid)|コンテナーのロケール ID を返します。|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|コンテナーで使用される単位の種類を返します。|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|グラブ ハンドルを表示するかどうかを決定します。|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|陰影を表示するかどうかを決定します。|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|コンテナーで指定されたテキストの配置の型を返します。|  
|[COleControl::AmbientUIDead](#ambientuidead)|コントロールがユーザー インターフェイスの動作に応答する必要があるかどうかを判断します。|  
|[COleControl::AmbientUserMode](#ambientusermode)|コンテナーのモードを決定します。|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|バインドされたプロパティが変更されたことをコンテナーに通知します。|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|プロパティの値を編集するアクセス許可を要求します。|  
|[COleControl::ClientToParent](#clienttoparent)|コンテナーの原点に対する、コントロールの原点を基準としたポイントに変換します。|  
|[COleControl::ClipCaretRect](#clipcaretrect)|コントロールによって、重なっている場合は、キャレット四角形を調整します。|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|コントロールによって処理されるニーモニックのセットが変更された後は、この関数を呼び出します。|  
|[COleControl::DisplayError](#displayerror)|コントロールのユーザーへのストックのエラー イベントを表示します。|  
|[COleControl::DoClick](#doclick)|ストックの実装`DoClick`メソッドです。|  
|[COleControl::DoPropExchange](#dopropexchange)|プロパティをシリアル化、`COleControl`オブジェクト。|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Windows コントロールからサブクラス化されている OLE コントロールを再描画します。|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|コントロールのシンプルなフレームのサポートを有効にします。|  
|[COleControl::ExchangeExtent](#exchangeextent)|コントロールの幅と高さをシリアル化します。|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|コントロールのストック プロパティをシリアル化します。|  
|[COleControl::ExchangeVersion](#exchangeversion)|コントロールのバージョン番号をシリアル化します。|  
|[COleControl::FireClick](#fireclick)|在庫を発生させる`Click`イベント。|  
|[COleControl::FireDblClick](#firedblclick)|在庫を発生させる`DblClick`イベント。|  
|[COleControl::FireError](#fireerror)|在庫を発生させる`Error`イベント。|  
|[COleControl::FireEvent](#fireevent)|カスタム イベントを発生させます。|  
|[COleControl::FireKeyDown](#firekeydown)|在庫を発生させる`KeyDown`イベント。|  
|[COleControl::FireKeyPress](#firekeypress)|在庫を発生させる`KeyPress`イベント。|  
|[COleControl::FireKeyUp](#firekeyup)|在庫を発生させる`KeyUp`イベント。|  
|[COleControl::FireMouseDown](#firemousedown)|在庫を発生させる`MouseDown`イベント。|  
|[COleControl::FireMouseMove](#firemousemove)|在庫を発生させる`MouseMove`イベント。|  
|[COleControl::FireMouseUp](#firemouseup)|在庫を発生させる`MouseUp`イベント。|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|コントロールの準備完了状態が変更されたときにイベントを発生させます。|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|サポートするコントロールの既定のアクティブ化の動作を変更、`IPointerInactive`インターフェイスです。|  
|[COleControl::GetAmbientProperty](#getambientproperty)|指定されたアンビエント プロパティの値を返します。|  
|[COleControl::GetAppearance](#getappearance)|ストックの外観プロパティの値を返します。|  
|[COleControl::GetBackColor](#getbackcolor)|ストックの BackColor プロパティの値を返します。|  
|[COleControl::GetBorderStyle](#getborderstyle)|ストック BorderStyle プロパティの値を返します。|  
|[COleControl::GetCapture](#getcapture)|アクティブなウィンドウなしコントロール オブジェクトがマウス キャプチャを持つかどうかを判断します。|  
|[COleControl::GetClassID](#getclassid)|コントロールの OLE クラス ID を取得します。|  
|[COleControl::GetClientOffset](#getclientoffset)|コントロールの四角形領域の左上隅にあるとクライアント領域の左上隅の差を取得します。|  
|[COleControl::GetClientRect](#getclientrect)|コントロールのクライアント領域のサイズを取得します。|  
|[COleControl::GetClientSite](#getclientsite)|コンテナー内の現在のクライアント サイトへのポインターのオブジェクトを照会します。|  
|[COleControl::GetControlFlags](#getcontrolflags)|コントロール フラグの設定を取得します。|  
|[COleControl::GetControlSize](#getcontrolsize)|OLE コントロールのサイズと位置を返します。|  
|[COleControl::GetDC](#getdc)|ウィンドウなしのコントロールをコンテナーからデバイス コンテキストを取得するための手段を提供します。|  
|[COleControl::GetEnabled](#getenabled)|ストックの Enabled プロパティの値を返します。|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|コンテナーに属する拡張コントロール オブジェクトへのポインターを取得します。|  
|[COleControl::GetFocus](#getfocus)|コントロールにフォーカスがあるかどうかを判断します。|  
|[COleControl::GetFont](#getfont)|ストック フォント プロパティの値を返します。|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|メトリックを返します、`CFontHolder`オブジェクト。|  
|[COleControl::GetForeColor](#getforecolor)|ストック ForeColor プロパティの値を返します。|  
|[COleControl::GetHwnd](#gethwnd)|HWnd のストック プロパティの値を返します。|  
|[COleControl::GetMessageString](#getmessagestring)|メニュー項目のステータス バーのテキストを提供します。|  
|[COleControl::GetNotSupported](#getnotsupported)|ユーザーがコントロールのプロパティの値へのアクセスを防止します。|  
|[COleControl::GetReadyState](#getreadystate)|コントロールの準備状態を返します。|  
|[COleControl::GetRectInContainer](#getrectincontainer)|コンテナーを基準として、コントロールの四角形を返します。|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|ストック フォント プロパティのメトリックを返します。|  
|[COleControl::GetText](#gettext)|ストックのテキストまたはキャプション プロパティの値を返します。|  
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|対象のドラッグ アンド ドロップ操作をウィンドウなしのコントロールを許可するをオーバーライドします。|  
|[COleControl::InitializeIIDs](#initializeiids)|コントロールを使用しての Iid の基本クラスを通知します。|  
|[COleControl::InternalGetFont](#internalgetfont)|返します、`CFontHolder`ストック フォント プロパティのオブジェクト。|  
|[COleControl::InternalGetText](#internalgettext)|ストックのキャプションまたはテキストのプロパティを取得します。|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|コントロールの準備状態を設定し、準備完了状態変更イベントを発生させます。|  
|[COleControl::InvalidateControl](#invalidatecontrol)|表示されているコントロールを再描画するための領域を無効にします。|  
|[COleControl::InvalidateRgn](#invalidatergn)|指定された領域内のコンテナーのウィンドウのクライアント領域を無効にします。 リージョンにウィンドウなしのコントロールを再描画するために使用します。|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|OLE コントロールの特別な読み込みを許可します。|  
|[COleControl::IsModified](#ismodified)|コントロールの状態が変更されたかどうかを判断します。|  
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|コンテナーが、現在の描画操作の最適化された描画をサポートしているかどうかを示します。|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|かどうかには、Windows コントロールのサブクラス化が制御を決定するには、呼び出されます。|  
|[COleControl::Load](#load)|以前の非同期データをリセットし、コントロールの非同期プロパティの新しい読み込みを開始します。|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|コンテナーによって、コントロールを非アクティブ化できるかどうかを判断します。|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|アンビエント プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|ストックの外観プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|ストックの BackColor プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|ストック BorderStyle プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnClick](#onclick)|ストック Click を発生させると呼ばれるイベント。|  
|[COleControl::OnClose](#onclose)|コントロールに通知する`IOleControl::Close`が呼び出されています。|  
|[COleControl::OnDoVerb](#ondoverb)|コントロール動詞が実行された後に呼び出されます。|  
|[COleControl::OnDraw](#ondraw)|コントロールが自動的に再描画するように要求するときに呼び出されます。|  
|[COleControl::OnDrawMetafile](#ondrawmetafile)|メタファイル デバイス コンテキストを使用して自動的に再描画するコントロールが要求されたときに、コンテナーによって呼び出されます。|  
|[COleControl::OnEdit](#onedit)|OLE コントロールの UI がアクティブ化するコンテナーによって呼び出されます。|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|ストックの Enabled プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnEnumVerbs](#onenumverbs)|コントロールの動詞を列挙するコンテナーによって呼び出されます。|  
|[COleControl::OnEventAdvise](#oneventadvise)|イベント ハンドラーが接続またはコントロールから切断されたときに呼び出されます。|  
|[COleControl::OnFontChanged](#onfontchanged)|ストック フォント プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|ストックの前景色プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|コントロールのイベントが固定されているか、マスクされていないときに呼び出されます。|  
|[COleControl::OnGetColorSet](#ongetcolorset)|コントロールに通知する`IOleObject::GetColorSet`が呼び出されています。|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|コンテナーにニーモニックの情報を提供します。|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|プロパティ値を表す文字列を取得するには、呼び出されます。|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|コンテナーのメニューにマージするコントロールのメニューのハンドルを要求します。|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|提案されたサイズと拡張モードに最も近いコントロールの表示のサイズを取得するためにオーバーライドします。|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|プロパティの使用可能な値を表す文字列を返します。|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|定義済みの文字列に対応する値を返します。|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|(2 つのパスの描画を有効にするのに使用できます)、コントロールの表示領域のサイズを取得するためにオーバーライドします。|  
|[COleControl::OnGetViewRect](#ongetviewrect)|コントロールのサイズを特定の位置以降にある四角形に変換するためにオーバーライドします。|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|コントロールのビュー状態を取得するためにオーバーライドします。|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|コントロールが UI で非アクティブ化されたときに、コンテナーによって呼び出されます。|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|マウス ポインターのディスパッチで非アクティブなコントロールのコンテナーを持つようオーバーライド`WM_MOUSEMOVE`コントロールへのメッセージ。|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|マウス ポインターのディスパッチで非アクティブなコントロールのコンテナーを持つようオーバーライド`WM_SETCURSOR`コントロールへのメッセージ。|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|ストックの KeyDown イベントが発生した後に呼び出されます。|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|ストックの KeyPress イベントが発生した後に呼び出されます。|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|ストックの KeyUp イベントが発生した後に呼び出されます。|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|プロパティの編集に使用するプロパティ ページを示します。|  
|[COleControl::OnMnemonic](#onmnemonic)|コントロールのニーモニック キーが押されたときに呼び出されます。|  
|[COleControl::OnProperties](#onproperties)|コントロールの [プロパティ] の動詞が呼び出されたときに呼び出されます。|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|コントロールの表示には特定の時点が重なっているかどうかをクエリにオーバーライドします。|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|コントロールの表示には任意の時点で指定された四角形が重なっているかどうかをクエリにオーバーライドします。|  
|[COleControl::OnRenderData](#onrenderdata)|指定された形式でデータを取得するためにフレームワークによって呼び出されます。|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|指定された形式でファイルからデータを取得するためにフレームワークによって呼び出されます。|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|指定された形式で使用するグローバル メモリからデータを取得するためにフレームワークによって呼び出されます。|  
|[COleControl::OnResetState](#onresetstate)|コントロールのプロパティを既定値にリセットします。|  
|[COleControl::OnSetClientSite](#onsetclientsite)|コントロールに通知する`IOleControl::SetClientSite`が呼び出されています。|  
|[COleControl::OnSetData](#onsetdata)|コントロールのデータを別の値に置き換えます。|  
|[COleControl::OnSetExtent](#onsetextent)|コントロールの範囲が変更された後に呼び出されます。|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|コントロールのサイズが変更された後に呼び出されます。|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|コントロールの UI がアクティブになったときに呼び出されます。|  
|[COleControl::OnTextChanged](#ontextchanged)|ストック テキストまたはキャプション プロパティが変更されたときに呼び出されます。|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|ウィンドウなしのコントロールには、(マウスとキーボード メッセージ) 以外のウィンドウ メッセージを処理します。|  
|[COleControl::ParentToClient](#parenttoclient)|コントロールの原点に対する、コンテナーの原点を基準としたポイントに変換します。|  
|[COleControl::PostModalDialog](#postmodaldialog)|モーダル ダイアログ ボックスが閉じられたことをコンテナーに通知します。|  
|[COleControl::PreModalDialog](#premodaldialog)|モーダル ダイアログ ボックスが表示されることをコンテナーに通知します。|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|破棄し、コントロールのウィンドウを再作成します。|  
|[COleControl::Refresh](#refresh)|強制的にコントロールの外観の再描画をします。|  
|[COleControl::ReleaseCapture](#releasecapture)|マウスのキャプチャを解放します。|  
|[COleControl::ReleaseDC](#releasedc)|ウィンドウなしのコントロールのコンテナーのディスプレイ デバイス コンテキストを解放します。|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|コントロール ウィンドウの親をリセットします。|  
|[COleControl::ResetStockProps](#resetstockprops)|初期化`COleControl`ストック プロパティが既定値にします。|  
|[COleControl::ResetVersion](#resetversion)|指定した値にバージョン番号を初期化します。|  
|[COleControl::ScrollWindow](#scrollwindow)|ウィンドウなしのコントロールを表示、インプレース アクティブ イメージ内の領域をスクロールを許可します。|  
|[COleControl::SelectFontObject](#selectfontobject)|デバイス コンテキストにカスタム フォント プロパティを選択します。|  
|[COleControl::SelectStockFont](#selectstockfont)|デバイス コンテキストにストック フォント プロパティを選択します。|  
|[COleControl::SerializeExtent](#serializeextent)|シリアル化またはコントロールの表示領域を初期化します。|  
|[COleControl::SerializeStockProps](#serializestockprops)|シリアル化または初期化、`COleControl`ストック プロパティです。|  
|[COleControl::SerializeVersion](#serializeversion)|シリアル化またはコントロールのバージョン情報を初期化します。|  
|[COleControl::SetAppearance](#setappearance)|ストックの外観プロパティの値を設定します。|  
|[COleControl::SetBackColor](#setbackcolor)|ストックの BackColor プロパティの値を設定します。|  
|[COleControl::SetBorderStyle](#setborderstyle)|ストック BorderStyle プロパティの値を設定します。|  
|[COleControl::SetCapture](#setcapture)|コントロールの代理でマウスのキャプチャを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。|  
|[COleControl::SetControlSize](#setcontrolsize)|OLE コントロールのサイズと位置を設定します。|  
|[COleControl::SetEnabled](#setenabled)|ストックの Enabled プロパティの値を設定します。|  
|[COleControl::SetFocus](#setfocus)|コントロールの代理で入力フォーカスを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。|  
|[COleControl::SetFont](#setfont)|ストック フォント プロパティの値を設定します。|  
|[COleControl::SetForeColor](#setforecolor)|ストックの前景色プロパティの値を設定します。|  
|[COleControl::SetInitialSize](#setinitialsize)|コンテナーで最初に表示されるときの OLE コントロールのサイズを設定します。|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|コントロールの変更の状態を変更します。|  
|[COleControl::SetNotPermitted](#setnotpermitted)|編集要求が失敗したことを示します。|  
|[COleControl::SetNotSupported](#setnotsupported)|ユーザーがコントロールのプロパティの値を変更しないようにします。|  
|[COleControl::SetRectInContainer](#setrectincontainer)|コンテナーを基準として、コントロールの四角形を設定します。|  
|[COleControl::SetText](#settext)|ストックのテキストまたはキャプション プロパティの値を設定します。|  
|[COleControl::ThrowError](#throwerror)|OLE コントロールでエラーが発生したことを通知します。|  
|[COleControl::TransformCoords](#transformcoords)|変換では、コンテナーとコントロールの間の値を調整します。|  
|[COleControl::TranslateColor](#translatecolor)|変換、 **OLE_COLOR**値を**COLORREF**値。|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|アンビエント プロパティが使用するか次に、コントロールが読み込まれるときを判断します。|  
|[COleControl::WindowProc](#windowproc)|Windows 手順を説明する`COleControl`オブジェクト。|  
  
### <a name="protected-methods"></a>プロテクト メソッド  
  
|名前|説明|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|コントロールの外観を更新する必要がある場合に、フレームワークによって呼び出されます。|  
|[COleControl::DrawMetafile](#drawmetafile)|メタファイル デバイス コンテキストを使用しているときに、フレームワークによって呼び出されます。|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|オートメーション メソッドの呼び出しを有効にします。|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|コントロールによってサポートされるデータ形式のリストを初期化するためにフレームワークによって呼び出されます。|  
  
## <a name="remarks"></a>コメント  
 派生`CWnd`、このクラスは、Windows のウィンドウ オブジェクトのすべての機能、およびイベントを発生させると、メソッドとプロパティをサポートする権限などの ole に固有の追加機能を継承します。  
  
 OLE コントロールは、OLE コンテナー アプリケーションに挿入できるし、イベントを発生させると公開するメソッドとプロパティ、コンテナーの双方向のシステムを使用して、コンテナーと通信します。 標準の OLE コンテナーのみ OLE コントロールの基本機能をサポートすることに注意してください。 これらは、OLE コントロールの拡張機能をサポートすることはできません。 イベントの発生は、イベントがコントロールで実行されている特定のアクションの結果として、コンテナーに送信されるときに発生します。 さらに、コンテナーは、公開されたメンバー関数に似たメソッドやプロパティのセットと、C++ クラスのデータ メンバーを使用して、コントロールと通信します。 これにより、開発者は、コントロールの外観を制御し、特定のアクションが発生したときに、コンテナーを通知することができます。  
  
## <a name="windowless-controls"></a>ウィンドウなしのコントロール  
 OLE コントロールは、ウィンドウなしに使用される、インプレース アクティブにすることができます。 ウィンドウなしのコントロールには、利点があります。  
  
-   ウィンドウなしのコントロールが透過的かつ四角形以外を指定できます。  
  
-   オブジェクトのインスタンスのサイズと作成時刻を縮小します。  
  
 コントロールでは、ウィンドウは必要ありません。 ウィンドウが提供するサービスは、1 つの共有ウィンドウ (通常はコンテナーの) とディスパッチ コードのビットを使用して簡単に提供できます。 ウィンドウは、ほとんどの場合、不必要に複雑オブジェクトです。  
  
 ウィンドウなしのアクティベーションを使用する場合、コンテナーを持つウィンドウ) はコントロールのウィンドウで提供されてそれ以外の場合はサービスを提供します。 たとえば、コントロールは、キーボード フォーカス、マウスのキャプチャのクエリ、またはデバイス コンテキストを取得する必要があります、これらの操作は、コンテナーによって管理されます。 `COleControl`[操作ウィンドウなしのメンバー関数](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)コンテナーでこれらの操作を呼び出します。  
  
 ウィンドウなしのアクティベーションを有効にすると、コンテナー デリゲート入力、入力メッセージをコントロールの`IOleInPlaceObjectWindowless`インターフェイス (の拡張機能[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)ウィンドウなしのサポート用)。 `COleControl`このインターフェイスの実装は、座標を適切にマウスの調整後、これらのコントロールのメッセージ マップを通じてメッセージがディスパッチされます。 メッセージ マップに対応するエントリを追加することで、通常のウィンドウのメッセージと同様にこれらのメッセージを処理できます。  
  
 ウィンドウなしのコントロールでは、常に使用することは、`COleControl`メンバー関数、対応するのではなく`CWnd`メンバー関数またはその関連する Windows API 関数。  
  
 OLE コントロール オブジェクトは、ウィンドウをアクティブになったが、使用頻度の低いアクティブな移行の必要な作業量が上へ移動し、遷移の速度がダウンした場合にのみ作成もできます。 ある場合は、この問題。 たとえば、テキスト ボックスのグリッドを検討してください。 ときに列を介してカーソルを上下、各コントロールする必要があります、インプレース アクティブ化され、非アクティブ化します。 アクティブ/非アクティブな移行の速度は、スクロールの速度に直接影響します。  
  
 OLE コントロール framework の開発に関する詳細については、記事を参照してください。 [MFC ActiveX コントロール](../../mfc/mfc-activex-controls.md)と[概要: MFC ActiveX コントロール プログラムを作成する](../../mfc/reference/mfc-activex-control-wizard.md)です。 OLE コントロール、およびちらつきなしのコントロールなどの最適化に関する情報を参照してください。 [MFC ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
## <a name="inheritance-hierarchy"></a>継承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>要件  
 **ヘッダー:** afxctl.h  
  
##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor  
 アンビエントの色の BackColor プロパティの値を返します。  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーのアンビエント色の BackColor プロパティ、存在する場合の現在の値。 プロパティがサポートされていない場合、この関数は、システムで定義されている Windows の背景色を返します。  
  
### <a name="remarks"></a>コメント  
 アンビエントの色の BackColor プロパティは、すべてのコントロールに使用可能なコンテナーによって定義されます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName  
 コンテナーがコントロールに割り当てられている名前は、ユーザーに表示されたエラー メッセージで使用できます。  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>戻り値  
 OLE コントロールの名前。 既定では長さ 0 の文字列です。  
  
### <a name="remarks"></a>コメント  
 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientfont"></a>  COleControl::AmbientFont  
 アンビエント フォント プロパティの値を返します。  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーのアンビエント フォント ディスパッチ インターフェイスへのポインター。 既定値は**NULL**です。 戻り値と等しくない場合**NULL**、呼び出すことによって、フォントの解放を担当する場合、 [iunknown::release](http://msdn.microsoft.com/library/windows/desktop/ms682317)メンバー関数。  
  
### <a name="remarks"></a>コメント  
 アンビエントのフォント プロパティは、コンテナーによって定義されたすべてのコントロールに使用できます。このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor  
 アンビエント前景色プロパティの値を返します。  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーのアンビエント前景色プロパティ、存在する場合の現在の値。 サポートされていない場合、この関数は、システムで定義されている Windows テキストの色を返します。  
  
### <a name="remarks"></a>コメント  
 アンビエント前景色プロパティは、すべてのコントロールに使用可能なコンテナーによって定義されます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID  
 コンテナーのロケール ID を返します。  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>戻り値  
 存在する場合、コンテナーの LocaleID プロパティの値です。 このプロパティがサポートされていない場合、この関数は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 コントロールは、ロケール Id を使用して、特定のロケールの場合は、そのユーザー インターフェイスを調整します。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance  
 コントロール オブジェクトの現在の表示設定を取得します。  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールの外観。  
  
- **0**外観をフラット  
  
- **1** 3D 外観  
  
### <a name="remarks"></a>コメント  
 現在の値を取得するには、この関数を呼び出して、**を示す**コントロールのプロパティです。  
  
##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits  
 コンテナーで使用される単位の種類を返します。  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーのアンビエント ScaleUnits を含む文字列。 このプロパティがサポートされていない場合、この関数は長さ 0 の文字列を返します。  
  
### <a name="remarks"></a>コメント  
 位置または twips かセンチメートルなど、選択したユニット ラベルが付いたディメンションを表示するコンテナーのアンビエント ScaleUnits プロパティを使用できます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles  
 コンテナーがアクティブなときにハンドルを表示するコントロールを許可するかどうかを判断します。  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>戻り値  
 グラブ ハンドルを表示する場合は 0 以外。それ以外の場合 0 を返します。 このプロパティはサポートされていません、この関数は 0 以外を返します。  
  
### <a name="remarks"></a>コメント  
 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching  
 コンテナーがのハッチ自体を表示するコントロールを許可するかどうかを決定パターン UI がアクティブなです。  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>戻り値  
 ハッチ パターンが表示される場合は 0 以外。それ以外の場合 0 を返します。 このプロパティはサポートされていません、この関数は 0 以外を返します。  
  
### <a name="remarks"></a>コメント  
 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign  
 コントロールのコンテナーで優先されるアンビエント テキストの配置を決定します。  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーのアンビエント TextAlign プロパティの状態。 このプロパティがサポートされていない場合、この関数は 0 を返します。  
  
 有効な戻り値の一覧を次に示します。  
  
|戻り値|説明|  
|------------------|-------------|  
|0|[全般] の配置 (左側、右側のテキストを数値)。|  
|1|左揃え|  
|2|Center |  
|3|右揃え|  
  
### <a name="remarks"></a>コメント  
 このプロパティは、埋め込まれたすべてのコントロールに使用可能なコンテナーによって定義されます。 このプロパティをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead  
 かどうか、コントロールがユーザー インターフェイスの動作に応答を決定します。  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>戻り値  
 以外の場合は、コントロールがユーザー インターフェイスの動作に応答する必要があります。それ以外の場合 0 を返します。 このプロパティがサポートされていない場合、この関数は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 たとえば、コンテナーが設定**TRUE**デザイン モードでします。  
  
##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode  
 コンテナーがデザイン モードまたはユーザー モードであるかどうかを判断します。  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーがユーザー モードである場合は 0 以外。(デザイン モード) ではそれ以外の場合 0 を返します。 このプロパティがサポートされていない場合、この関数は TRUE を返します。  
  
### <a name="remarks"></a>コメント  
 たとえば、コンテナーが設定**FALSE**デザイン モードでします。  
  
##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged  
 バインドされたプロパティの値が変更されたことを通知します。  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 コントロールのバインド プロパティのディスパッチ ID。  
  
### <a name="remarks"></a>コメント  
 これは、変更をいないプロパティを通じて行われた場合にも、プロパティの変更の値がメソッドを設定するたびに呼び出す必要があります。 メンバー変数にマップされているバインドされたプロパティの特に注意してください。 このようなメンバー変数が変更された、いつでも`BoundPropertyChanged`呼び出す必要があります。  
  
##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit  
 アクセス許可を要求、`IPropertyNotifySink`コントロールによって提供されるバインドされたプロパティ値を変更するインターフェイスです。  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 コントロールのバインド プロパティのディスパッチ ID。  
  
### <a name="return-value"></a>戻り値  
 変更は許可されている場合は 0 以外。それ以外の場合 0 を返します。 既定値は 0 以外の値です。  
  
### <a name="remarks"></a>コメント  
 アクセス許可が拒否された場合、コントロールには、プロパティの変更の値をこと必要がありますはできません。 これによりをするかどうか、プロパティ値を変更しようとするアクションを失敗すます。  
  
##  <a name="clienttoparent"></a>  COleControl::ClientToParent  
 座標に変換`pPoint`親座標にします。  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `lprcBounds`  
 コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではなく、境界線とスクロール バーを含むコントロール全体の領域。  
  
 `pPoint`  
 親 (コンテナー) の座標に変換するには、OLE クライアント領域ポイントへのポインター。  
  
### <a name="remarks"></a>コメント  
 入力時に`pPoint`OLE コントロール (コントロールのクライアント領域の左上隅) のクライアント領域の原点に対する相対パスです。 出力に`pPoint`親 (コンテナーの左上隅) の原点に対する相対パスです。  
  
##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect  
 全体または部分的に重複する、不透明なオブジェクトによってカバーされている場合は、キャレット四角形を調整します。  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpRect`  
 入力時にへのポインター、 [RECT](../../mfc/reference/rect-structure1.md)を調整するカレット領域を含む構造体。 出力では、調整されたカレット領域または**NULL**キャレット四角形が完全に覆わ場合。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 キャレットは、点滅行、ブロック、またはを通常のテキストまたはグラフィックを挿入する場所を示すビットマップです。  
  
 ウィンドウなしのオブジェクトを最初に確認せず、カレットを表示できません安全にかどうか、キャレットが部分的または完全に覆われているオブジェクト。 そのため、するために、オブジェクトで使用できる`ClipCaretRect`カレットを調整する (縮小) クリッピング領域に適合するようにします。  
  
 キャレットを作成するオブジェクトがカレットの四角形に送信する`ClipCaretRect`およびキャレットの調整済みの四角形を使用します。 かどうか、完全カレットが、このメソッドは**FALSE**キャレットが表示されないすべての例ではこのとします。  
  
##  <a name="colecontrol"></a>  COleControl::COleControl  
 `COleControl` オブジェクトを構築します。  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>コメント  
 この関数は通常は直接に呼び出されます。 代わりに OLE コントロールは通常、そのクラスのファクトリによって作成されます。  
  
##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged  
 コントロールでサポートされているニーモニックのセットが変更されたときに、この関数を呼び出します。  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>コメント  
 この通知を受け取ると、コントロールのコンテナー、新しいのセットを取得ニーモニックを呼び出すことによって[IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730)です。 この通知に応答する、コンテナーが必要ないことに注意してください。  
  
##  <a name="displayerror"></a>  COleControl::DisplayError  
 (イベント ハンドラーは、エラーの表示を抑制が) しない限り、株価のエラー イベントが処理された後に、フレームワークによって呼び出されます。  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>パラメーター  
 *scode*  
 報告するステータス コード値。 可能なコードの完全な一覧は、記事を参照してください。 [ActiveX コントロール: 高度なトピック](../../mfc/mfc-activex-controls-advanced-topics.md)です。  
  
 `lpszDescription`  
 報告されるエラーの説明です。  
  
 *lpszSource*  
 エラー (通常は、OLE コントロール モジュールの名前) を生成するモジュールの名前。  
  
 `lpszHelpFile`  
 エラーの説明を含むヘルプ ファイルの名前。  
  
 `nHelpID`  
 報告されるエラーのヘルプ コンテキスト ID。  
  
### <a name="remarks"></a>コメント  
 既定の動作に含まれている、エラーの説明を含むメッセージ ボックスを表示する`lpszDescription`です。  
  
 エラーの表示方法をカスタマイズするには、この関数をオーバーライドします。  
  
##  <a name="doclick"></a>  COleControl::DoClick  
 マウスをシミュレート コントロールに対するアクションをクリックします。  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>コメント  
 オーバーライド可能な`COleControl::OnClick`メンバー関数が呼び出されますと在庫コントロールによってサポートされている場合、イベントが発生されます をクリックします。  
  
 この関数はサポート、 `COleControl` DoClick と呼ばれる、ストック メソッドとしての基本クラスです。 詳細については、記事を参照してください。 [ActiveX コントロール: メソッド](../../mfc/mfc-activex-controls-methods.md)です。  
  
##  <a name="dopropexchange"></a>  COleControl::DoPropExchange  
 読み込み中、または、ストリーム、またはプロパティのセットなどの永続的ストレージ表現からコントロールを格納するときに、フレームワークによって呼び出されます。  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>パラメーター  
 `pPX`  
 ポインター、`CPropExchange`オブジェクト。 フレームワークは、方向など、プロパティの交換のコンテキストを確立するには、このオブジェクトを提供します。  
  
### <a name="remarks"></a>コメント  
 呼び出しでこの関数は通常、 **px _**読み込みまたは OLE コントロールの特定のユーザー定義プロパティを格納する関数のファミリです。  
  
 OLE コントロール プロジェクトを作成するコントロールのウィザードを使用して、この関数のオーバーライドされたバージョンがシリアル化がサポートするストック プロパティ`COleControl`基底クラスの関数を呼び出して`COleControl::DoPropExchange`です。 OLE コントロールにユーザー定義のプロパティを追加すると、新しいプロパティをシリアル化するには、この関数を変更する必要があります。 シリアル化の詳細については、記事を参照してください。 [ActiveX コントロール: シリアル化する](../../mfc/mfc-activex-controls-serializing.md)です。  
  
##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint  
 Windows コントロールからサブクラス化されている OLE コントロールを再描画します。  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 コントロールのコンテナーのデバイス コンテキストへのポインター。  
  
 `rcBounds`  
 コントロールが描画される領域です。  
  
### <a name="remarks"></a>コメント  
 この関数では、非アクティブの OLE コントロールの描画を適切に処理します。 この関数は、OLE コントロールでは、Windows コントロールをサブクラスと呼び出す必要がありますにのみ使用する必要があります、`OnDraw`コントロールの関数。  
  
 この関数は、Windows コントロールのサブクラス化の詳細については、記事を参照してください。 [ActiveX コントロール: Windows コントロールのサブクラス化](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)です。  
  
##  <a name="drawcontent"></a>  COleControl::DrawContent  
 コントロールの外観を更新する必要がある場合に、フレームワークによって呼び出されます。  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 デバイス コンテキストへのポインター。  
  
 `rc`  
 四角形の領域に描画されます。  
  
### <a name="remarks"></a>コメント  
 この関数は、オーバーライド可能な`OnDraw`関数。  
  
##  <a name="drawmetafile"></a>  COleControl::DrawMetafile  
 メタファイル デバイス コンテキストを使用しているときに、フレームワークによって呼び出されます。  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 メタファイル デバイス コンテキストへのポインター。  
  
 `rc`  
 四角形の領域に描画されます。  
  
##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame  
 OLE コントロールのシンプルなフレームの特性を有効にします。  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>コメント  
 この特性は、他のコントロールのビジュアルのコンテインメントが真ではなく OLE 包含をサポートするためにコントロールをできるようにします。 例には、複数のコントロールの内部グループ ボックスがあります。 これらのコントロールが含まれている場合、OLE ではありませんが、同じグループ ボックスで、します。  
  
##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent  
 シリアル化またはコントロールの範囲の状態を初期化します (そのディメンションに**HIMETRIC**単位)。  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>パラメーター  
 `pPX`  
 ポインター、 [CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクト。 フレームワークは、方向など、プロパティの交換のコンテキストを確立するには、このオブジェクトを提供します。  
  
### <a name="return-value"></a>戻り値  
 関数が成功した場合は 0 以外。それ以外の場合は 0 です。  
  
### <a name="remarks"></a>コメント  
 この関数は通常、既定の実装によって呼び出される`COleControl::DoPropExchange`です。  
  
##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps  
 シリアル化またはコントロールのストック プロパティの状態を初期化します。  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>パラメーター  
 `pPX`  
 ポインター、 [CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクト。 フレームワークは、方向など、プロパティの交換のコンテキストを確立するには、このオブジェクトを提供します。  
  
### <a name="remarks"></a>コメント  
 この関数は通常、既定の実装によって呼び出される`COleControl::DoPropExchange`です。  
  
##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion  
 シリアル化またはコントロールのバージョン情報の状態を初期化します。  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `pPX`  
 ポインター、`CPropExchange`オブジェクト。 フレームワークは、方向など、プロパティの交換のコンテキストを確立するには、このオブジェクトを提供します。  
  
 `dwVersionDefault`  
 コントロールの現在のバージョン番号。  
  
 `bConvert`  
 永続的なデータを保存すると、または既に読み込まれているのと同じ形式で保持されるときに、最新の形式に変換する必要があるかどうかを示します。  
  
### <a name="return-value"></a>戻り値  
 関数が成功したは 0 以外。それ以外の場合は 0 です。  
  
### <a name="remarks"></a>コメント  
 通常、これのコントロールのオーバーライドによって呼び出される最初の関数`COleControl::DoPropExchange`です。 読み込む場合は、この関数、永続的なデータのバージョン番号は、読み取りの version 属性を設定、 [CPropExchange](../../mfc/reference/cpropexchange-class.md)それに応じてオブジェクトします。 保存すると、この関数は、永続的なデータのバージョン番号を書き込みます。  
  
 永続化とバージョン管理の詳細については、記事を参照してください。 [ActiveX コントロール: シリアル化する](../../mfc/mfc-activex-controls-serializing.md)です。  
  
##  <a name="fireclick"></a>  COleControl::FireClick  
 アクティブなコントロールの上にマウスがクリックされたときに、フレームワークによって呼び出されます。  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 クリック イベントが発生する自動発生させるには、コントロールのイベントのマップが必要 をクリック、株価イベントを定義します。  
  
##  <a name="firedblclick"></a>  COleControl::FireDblClick  
 アクティブなコントロール上にマウスがダブルクリックされたときに、フレームワークによって呼び出されます。  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 DblClick イベントが発生する自動発生させるには、コントロールのイベント マップ ストックの DblClick イベントが定義されている必要があります。  
  
##  <a name="fireerror"></a>  COleControl::FireError  
 ストックのエラー イベントを発生させます。  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>パラメーター  
 *scode*  
 報告するステータス コード値。 可能なコードの完全な一覧は、記事を参照してください。 [ActiveX コントロール: 高度なトピック](../../mfc/mfc-activex-controls-advanced-topics.md)です。  
  
 `lpszDescription`  
 報告されるエラーの説明です。  
  
 `nHelpID`  
 ヘルプ、報告されるエラーの ID。  
  
### <a name="remarks"></a>コメント  
 このイベントは、コントロール内でエラーが発生したことをコードの適切な場所に通知する方法を提供します。 クリックして、MouseMove などの他のストック イベントとは異なり、フレームワークによってエラーが発生しません。  
  
 プロパティの get 関数、プロパティ セット関数、またはオートメーション メソッドの中に発生するエラーを報告するには、呼び出す[COleControl::ThrowError](#throwerror)です。  
  
 OLE コントロールの株式のエラー イベントを使用しての実装、`SCODE`値。 コントロールは、このイベントを使用していて、Visual Basic 4.0 で使用するものでは場合、ためエラーが表示されます、 `SCODE` Visual Basic では、値はサポートされていません。  
  
 これを解決するには、手動で変更、`SCODE`コントロールのパラメーターです。ODL ファイルを**長い**です。 さらに、任意のカスタム イベント、メソッド、またはプロパティを使用する、`SCODE`パラメーターにも同じ問題が発生します。  
  
##  <a name="fireevent"></a>  COleControl::FireEvent  
 コントロールから省略可能な引数は、任意の数、ユーザー定義のイベントを発生させます。  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 起動されるイベントのディスパッチ ID。  
  
 `pbParams`  
 イベントのパラメーターの型の記述子です。  
  
### <a name="remarks"></a>コメント  
 通常この関数は呼び出せません直接です。 代わりには、コントロールのクラス宣言のイベント マップのセクションでイベントを発生させる関数を呼び出します。  
  
 `pbParams`引数は、のスペースで区切られたリスト**vts _**です。 スペース (コンマではない) で区切られるこれらの値の 1 つ以上は、関数のパラメーター リストを指定します。 次の値を指定できます。  
  
|シンボル|パラメーターの型|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  追加のバリアント定数が定義されて、すべてのバリアント型の例外を除いて**VTS_FONT**と**VTS_PICTURE**、variant データ定数へのポインターを提供します。 これらの定数の名前、**付け**`constantname`規則。 たとえば、 **VTS_PCOLOR**へのポインター、 **VTS_COLOR**定数。  
  
##  <a name="firekeydown"></a>  COleControl::FireKeyDown  
 コントロールが UI がアクティブのときにキーが押されたときに、フレームワークによって呼び出されます。  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>パラメーター  
 `pnChar`  
 押されたキーの仮想キー コード値へのポインター。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 KeyDown イベントが発生する自動発生させるには、コントロールのイベント マップ ストック KeyDown イベントが定義されている必要があります。  
  
##  <a name="firekeypress"></a>  COleControl::FireKeyPress  
 キーが押され、コンテナー内でカスタム コントロールの UI のアクティブなときにリリースされたときに、フレームワークによって呼び出されます。  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>パラメーター  
 `pnChar`  
 押されたキーの文字の値へのポインター。  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 イベントを受け取ることがあります変更`pnChar`、たとえば、すべての小文字を大文字に変換します。 変更された文字を確認する場合は、オーバーライド`OnKeyPressEvent`です。  
  
 KeyPress イベントが発生する自動発生させるには、コントロールのイベント マップ ストック KeyPress イベントが定義されている必要があります。  
  
##  <a name="firekeyup"></a>  COleControl::FireKeyUp  
 コンテナー内でカスタム コントロールの UI のアクティブなときにキーが離されたときに、フレームワークによって呼び出されます。  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>パラメーター  
 `pnChar`  
 リリースされたキーの仮想キー コード値へのポインター。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 KeyUp イベントが発生する自動発生させるには、コントロールのイベント マップ ストック KeyUp イベントが定義されている必要があります。  
  
##  <a name="firemousedown"></a>  COleControl::FireMouseDown  
 アクティブなカスタム コントロール上でマウス ボタンが押されたときに、フレームワークによって呼び出されます。  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>パラメーター  
 `nButton`  
 押されたマウス ボタンの数値。 次の値のいずれかを指定できます。  
  
- **LEFT_BUTTON**マウスの左ボタンが押されています。  
  
- **MIDDLE_BUTTON**マウスの中央ボタンが押されています。  
  
- **RIGHT_BUTTON**マウスの右ボタンが押されています。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
 *x*  
 マウス ボタンが押されたとき、カーソルの x 座標。 座標は、コントロール ウィンドウの左上隅に対する相対パスです。  
  
 *y*  
 マウス ボタンが押されたとき、カーソルの y 座標。 座標は、コントロール ウィンドウの左上隅に対する相対パスです。  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 MouseDown イベントが発生する自動発生させるには、コントロールのイベント マップ ストック MouseDown イベントが定義されている必要があります。  
  
##  <a name="firemousemove"></a>  COleControl::FireMouseMove  
 アクティブなカスタム コントロール上でカーソルが移動したときに、フレームワークによって呼び出されます。  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>パラメーター  
 `nButton`  
 押されたマウス ボタンの数値。 次の値の組み合わせが含まれます。  
  
- **LEFT_BUTTON**アクション中にダウン マウスの左ボタンが押されました。  
  
- **MIDDLE_BUTTON**アクション中にマウスの中央ボタンが押さされました。  
  
- **RIGHT_BUTTON**アクション中にマウスの右ボタンが押さされました。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
 *x*  
 カーソルの x 座標。 座標は、コントロール ウィンドウの左上隅に対する相対パスです。  
  
 *y*  
 カーソルの y 座標。 座標は、コントロール ウィンドウの左上隅に対する相対パスです。  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 MouseMove イベントが発生する自動発生させるには、コントロールのイベント マップ ストック MouseMove イベントが定義されている必要があります。  
  
##  <a name="firemouseup"></a>  COleControl::FireMouseUp  
 アクティブなカスタム コントロール上でマウス ボタンが離されたときに、フレームワークによって呼び出されます。  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>パラメーター  
 `nButton`  
 マウス ボタンが解放されたの数値。 次の値のいずれかを取ります。  
  
- **LEFT_BUTTON**マウスの左ボタンが離されました。  
  
- **MIDDLE_BUTTON**マウスの中央ボタンが離されました。  
  
- **RIGHT_BUTTON**マウスの右ボタンが離されました。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
 *x*  
 マウス ボタンが離されたときのカーソルの x 座標。 座標は、コントロール ウィンドウの左上隅に対する相対パスです。  
  
 *y*  
 マウス ボタンが離されたときに、カーソルの y 座標。 座標は、コントロール ウィンドウの左上隅に対する相対パスです。  
  
### <a name="remarks"></a>コメント  
 このイベントが、カスタム イベントとして定義されている場合は、イベントが発生したときに決定します。  
  
 MouseUp イベントが発生する自動発生させるには、コントロールのイベント マップ ストックの MouseUp イベントが定義されている必要があります。  
  
##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange  
 コントロールの準備完了状態の現在の値を持つイベントを発生させます。  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>コメント  
 準備完了状態には、次の値のいずれかを指定できます。  
  
 **READYSTATE_UNINITIALIZED**  
 既定の初期化状態  
  
 **READYSTATE_LOADING**  
 コントロールが現在のプロパティを読み込んでいます。  
  
 **READYSTATE_LOADED**  
 コントロールが初期化されています。  
  
 **READYSTATE_INTERACTIVE**  
 コントロールが対話するための十分なデータが非同期のデータがまだ読み込まれています  
  
 `READYSTATE_COMPLETE`  
 コントロールがそのすべてのデータ  
  
 使用して[GetReadyState](#getreadystate)をコントロールの現在の準備を確認します。  
  
 [InternalSetReadyState](#internalsetreadystate)準備完了状態を指定すると、値に変更し、呼び出す`FireReadyStateChange`です。  
  
##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy  
 サポートするコントロールの既定のアクティブ化の動作を変更、`IPointerInactive`インターフェイスです。  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>戻り値  
 フラグの組み合わせ、 **POINTERINACTIVE**列挙します。 使用できるフラグは次のとおりです。  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 オブジェクトは、インプレースでマウスがマウスの移動操作中に入ったときにアクティブにする必要があります。  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 オブジェクトは、マウスがマウスの移動操作中に、オブジェクトを離れるときに、非アクティブにする必要があります。  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 オブジェクトはインプレースでドラッグ中に上にマウスをドラッグするとアクティブ化する必要があり、操作をドロップします。  
  
### <a name="remarks"></a>コメント  
 ときに、`IPointerInactive`インターフェイスが有効になっている、コンテナーは委任`WM_SETCURSOR`と`WM_MOUSEMOVE`メッセージ。 `COleControl`このインターフェイスの実装は、座標を適切にマウスの調整後、これらのコントロールのメッセージ マップを通じてメッセージがディスパッチされます。  
  
 コンテナーを受信するたびに、`WM_SETCURSOR`または`WM_MOUSEMOVE`マウス ポインターをサポートする非アクティブなオブジェクトを含むメッセージ`IPointerInactive`、それを呼び出す必要があります`GetActivationPolicy`からインターフェイスと戻り値のフラグ、 **POINTERINACTIVE**列挙します。  
  
 メッセージ マップに対応するエントリを追加することで、通常のウィンドウ メッセージと同じようにこれらのメッセージを処理できます。 ハンドラーでは、使用しないでください、`m_hWnd`メンバー変数 (またはそれを使用する任意のメンバー関数) 最初にその値が非チェック**NULL**です。  
  
 任意のオブジェクトが想定以上のマウス カーソルを設定しないでくださいやマウス移動イベントを発生させるのにこのような特別な視覚的フィードバックを与えるように返す必要があります、 **POINTERINACTIVE_ACTIVATEONENTRY**フラグを設定し、アクティブな場合にのみ、フィードバックを描画します。 オブジェクトは、このフラグを返します、コンテナーおりする場合はすぐにアクティブ化してインプレースへの呼び出しをトリガーした同じメッセージを転送`GetActivationPolicy`です。  
  
 両方の**POINTERINACTIVE_ACTIVATEONENTRY**と**POINTERINACTIVE_DEACTIVATEONLEAVE**フラグが返される、オブジェクトは、オブジェクトの上にマウスがのみアクティブにします。 だけの場合、 **POINTERINACTIVE_ACTIVATEONENTRY**フラグが返されると、そのオブジェクトはのみアクティブ化するときに、マウス最初に入力すると、オブジェクトです。  
  
 対象の OLE ドラッグ アンド ドロップ操作の非アクティブなコントロールをすることもできます。 これは、コントロールのウィンドウがドロップ先として登録できるように、上に、ユーザーがオブジェクトをドラッグする時点でコントロールをアクティブ化する必要があります。 ドラッグ中をライセンス認証には、戻る、 **POINTERINACTIVE_ACTIVATEONDRAG**フラグ。  
  
 [!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 情報が伝えられた`GetActivationPolicy`コンテナーによってキャッシュされないようにする必要があります。 代わりに、マウスが非アクティブなオブジェクトを入力するたびに、このメソッドを呼び出す必要があります。  
  
 インプレースでマウスが入ったときにアクティブである非アクティブなオブジェクトを要求しない、コンテナーを後続ディスパッチする必要があります`WM_SETCURSOR`メッセージをこのオブジェクトを呼び出して[OnInactiveSetCursor](#oninactivesetcursor)限りマウス ポインターオブジェクトの上に維持されます。  
  
 有効にすると、`IPointerInactive`通常インターフェイスでは常にマウスのメッセージの処理に対応しているコントロールを表示することを意味します。 サポートされていない、コンテナー内のこの動作を取得する、`IPointerInactive`インターフェイス、する必要が常にアクティブに表示される、コントロールがあるため、コントロールが必要、**されて**フラグ間での他のフラグ。 ただし、このフラグを防ぐために、コンテナー内の効果を取得はサポート`IPointerInactive`を指定することも、 **OLEMISC_IGNOREACTIVATEWHENVISIBLE**フラグ。  
  
 [!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty  
 コンテナーのアンビエント プロパティの値を取得します。  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>パラメーター  
 *dwDispid*  
 目的のアンビエント プロパティのディスパッチ ID。  
  
 `vtProp`  
 返される値の型を指定するバリアント型タグ`pvProp`です。  
  
 `pvProp`  
 戻り値またはプロパティの値を受け取る変数のアドレスへのポインター。 このポインターの実際の型がで指定された型と一致する必要があります`vtProp`です。  
  
|vtProp|PvProp の種類|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**short\***|  
|`VT_I4`|**long\***|  
|`VT_R4`|**float\***|  
|`VT_R8`|**double\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>戻り値  
 アンビエント プロパティがサポートされる場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 使用する場合`GetAmbientProperty`アンビエント DisplayName と ScaleUnits プロパティを取得するには、次のように設定します。`vtProp`に`VT_BSTR`と`pvProp`に**CString\***です。 アンビエントのフォント プロパティを取得する場合は、設定`vtProp`に**VT_FONT**と`pvProp`に**LPFONTDISP\***です。  
  
 関数が既に提供されて共通のアンビエント プロパティのように注意してください[AmbientBackColor](#ambientbackcolor)と[AmbientFont](#ambientfont)です。  
  
##  <a name="getappearance"></a>  COleControl::GetAppearance  
 コントロールの外観のストック プロパティの Get 関数を実装します。  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>戻り値  
 戻り値として現在の表示設定を指定する、**短い**( `VT_I2`) 成功した場合は、値します。 コントロールの外観が 3D である場合、コントロールの外観がフラットと 1 の場合、この値は 0 です。  
  
##  <a name="getbackcolor"></a>  COleControl::GetBackColor  
 コントロールの背景色のストック プロパティの Get 関数を実装します。  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>戻り値  
 戻り値として現在の背景色を指定する、 **OLE_COLOR**成功した場合は、値します。 この値に変換できる、 **COLORREF**値への呼び出しと`TranslateColor`です。  
  
##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle  
 コントロールのストック BorderStyle プロパティの Get 関数を実装します。  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールに通常の境界線がある場合は 1コントロールに境界線があるない場合は 0 を返します。  
  
##  <a name="getcapture"></a>  COleControl::GetCapture  
 決定するかどうか、`COleControl`オブジェクトがマウス キャプチャを保持します。  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールがアクティブ化およびウィンドウなしの場合を返します**この**コントロールに現在がマウスのキャプチャ (ように、コントロールのコンテナーによって決まります)、または**NULL**キャプチャがあるない場合。  
  
 返しますそれ以外の場合、`CWnd`がマウス キャプチャを保持するオブジェクト (と同じ`CWnd::GetCapture`)。  
  
### <a name="remarks"></a>コメント  
 アクティブなウィンドウなしのコントロールがマウスを受け取るときにキャプチャ[SetCapture](#setcapture)と呼びます。  
  
##  <a name="getclassid"></a>  COleControl::GetClassID  
 コントロールの OLE クラス ID を取得するためにフレームワークによって呼び出されます。  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>パラメーター  
 *pclsid*  
 クラスの ID の場所へのポインター  
  
### <a name="return-value"></a>戻り値  
 呼び出しが正常終了しなかった場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 通常で実装、 [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)です。  
  
##  <a name="getclientoffset"></a>  COleControl::GetClientOffset  
 コントロールの四角形領域の左上隅にあるとクライアント領域の左上隅の差を取得します。  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 *pdxOffset*  
 OLE コントロールのクライアント領域の水平方向のオフセットへのポインター。  
  
 *pdyOffset*  
 OLE コントロールのクライアント領域の垂直方向のオフセットへのポインター。  
  
### <a name="remarks"></a>コメント  
 OLE コントロールには、コンテナー内の四角形の領域があります。 コントロールのクライアント領域は、境界線とスクロール バーを除くコントロール領域です。 オフセットを取得して`GetClientOffset`コントロールの四角形領域の左上隅にあるとクライアント領域の左上隅の違いです。 コントロールに標準の罫線およびスクロール バー以外のクライアントではない要素がある場合は、オフセットを指定するには、このメンバー関数をオーバーライドします。  
  
##  <a name="getclientrect"></a>  COleControl::GetClientRect  
 コントロールのクライアント領域のサイズを取得します。  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `lpRect`  
 ポインター、`RECT`ウィンドウなしのコントロールのクライアント領域の寸法を含む構造体です。 つまり、ウィンドウの縁、フレーム、スクロール バー、およびにマイナスのコントロールのサイズ。 `lpRect`パラメーターがコントロールのクライアントの四角形の位置のサイズを示します。  
  
##  <a name="getclientsite"></a>  COleControl::GetClientSite  
 コンテナー内の現在のクライアント サイトへのポインターのオブジェクトを照会します。  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーで、コントロールの現在のクライアント サイトへのポインター。  
  
### <a name="remarks"></a>コメント  
 インスタンスを返されたポインターが指す`IOleClientSite`です。 `IOleClientSite`コンテナーによって実装されるインターフェイスは、そのコンテキストのオブジェクトの表示: ドキュメントでその記憶域、ユーザー インターフェイス、およびその他のリソースを取得、固定されています。  
  
##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags  
 コントロール フラグの設定を取得します。  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>戻り値  
 ControlFlags 列挙体のフラグの論理和の組み合わせです。  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>コメント  
 既定では、`GetControlFlags`返します`fastBeginPaint | clipPaintDC`です。  
  
 `fastBeginPaint`  
 かどうか設定すると、使用開始ペイント関数向けに OLE コントロールの代わりに、 [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (既定で設定)。  
  
 `clipPaintDC`  
 設定しない場合への呼び出しを無効に`IntersectClipRect`によって行われた`COleControl`速度の小規模な利点は、結果を取得します。 ウィンドウなしのアクティベーションを使用している場合、フラグの効果はありません。  
  
 `pointerInactive`  
 場合設定を有効にすると、コントロールがアクティブな間は、マウスとの対話を提供`COleControl`の実装、`IPointerInactive`インターフェイスで、既定で無効にします。  
  
 `noFlickerActivate`  
 場合設定、余分な描画操作とちらつきを除去します。 コントロールで同一の描画、非アクティブとアクティブな状態に使用します。 ウィンドウなしのアクティベーションを使用している場合、フラグの効果はありません。  
  
 `windowlessActivate`  
 場合設定、コントロールはウィンドウなしのアクティベーションを使用することを示します。  
  
 `canOptimizeDraw`  
 場合設定、コンテナーがサポートされている場合、コントロールが最適化された描画を実行することを示します。  
  
 詳細については`GetControlFlags`OLE コントロールの他の最適化を参照してください、 [ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
##  <a name="getcontrolsize"></a>  COleControl::GetControlSize  
 OLE コントロール ウィンドウのサイズを取得します。  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>パラメーター  
 *pcx*  
 コントロールの幅をピクセル単位で指定します。  
  
 *pcy*  
 コントロールの高さをピクセル単位で指定します。  
  
### <a name="remarks"></a>コメント  
 コントロール ウィンドウのすべての座標は、コントロールの左上隅に対する相対パスに注意してください。  
  
##  <a name="getdc"></a>  COleControl::GetDC  
 コンテナーからウィンドウなしのオブジェクトの get スクリーン (または互換性のある) デバイス コンテキストを提供します。  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>パラメーター  
 *lprcRect*  
 ウィンドウなしのコントロールの四角形を指すポインターがコントロールのクライアント座標で再描画しようとするとします。 **NULL**オブジェクト全体を意味します。  
  
 `dwFlags`  
 デバイス コンテキストの属性を描画します。 選択肢は次のとおりです。  
  
- **OLEDC_NODRAW**オブジェクトが任意の描画が単ディスプレイ デバイスに関する情報を取得するを実行するデバイス コンテキストを使用しないことを示します。 コンテナーは、さらに処理することがなくウィンドウの DC を単に渡す必要があります。  
  
- **OLEDC_PAINTBKGND**コンテナーがドメイン コント ローラーを返す前に背景を描画することを要求します。 オブジェクトは、透明な背景を使用して領域を再描画の DC を要求している場合、このフラグを使用する必要があります。  
  
- **OLEDC_OFFSCREEN**に画面外となるビットマップを画面にし、コピーするかを表示するために、オブジェクトがしようとしているコンテナーに通知します。 オブジェクトを実行しようとしている描画処理は、多数のちらつきを生成するときに、このフラグを使用する必要があります。 コンテナーは、この要求を受け入れるか無料です。 ただし、このフラグが設定されていない場合、コンテナー必要があります送り返す、画面上の DC です。 これにより、選択の表示などの直接の画面操作を実行するオブジェクト (を使用して、 **XOR**操作)。  
  
### <a name="return-value"></a>戻り値  
 コンテナーのディスプレイ デバイス コンテキストへのポインター`CWnd`クライアント領域かどうか成功しなかった場合、戻り値は、 **NULL**です。 ディスプレイ デバイス コンテキストは、コンテナーのウィンドウのクライアント領域を描画する後続の GDI 関数で使用できます。  
  
### <a name="remarks"></a>コメント  
 [ReleaseDC](#releasedc)描画後に、コンテキストを解放するメンバー関数を呼び出す必要があります。 呼び出すときに`GetDC`オブジェクトが、独自のクライアント座標に描画する四角形を渡します。 `GetDC` これらをコンテナーのクライアント領域の座標に変換します。 オブジェクトが必要な描画する四角形で取得できるサイズが、独自のクライアント領域四角を超えるを要求しないでください[GetClientRect](#getclientrect)です。 これはオブジェクトが不注意に許可されていない場所を描画することを防ぎます。  
  
##  <a name="getenabled"></a>  COleControl::GetEnabled  
 コントロールのストック Enabled プロパティの Get 関数を実装します。  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールが有効である場合は 0 以外。それ以外の場合 0 を返します。  
  
##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl  
 プロパティの拡張セットとコントロールを表すコンテナーで保持されているオブジェクトへのポインターを取得します。  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>戻り値  
 コンテナーへのポインターには、コントロール オブジェクトを拡張します。 使用可能なオブジェクトがないの場合、値は**NULL**です。  
  
 このオブジェクトを使って操作することがあります、`IDispatch`インターフェイスです。 使用することも`QueryInterface`オブジェクトによって提供される使用可能なその他のインターフェイスを取得します。 ただし、オブジェクトは、特定の一連のインターフェイスをサポートするためには不要です。 他の任意のコンテナー コントロールの移植性を制限、コンテナーの拡張コントロール オブジェクトの特定の機能に依存することに注意してください。  
  
### <a name="remarks"></a>コメント  
 この関数を呼び出す関数は、オブジェクトを終了すると、ポインターを解放する必要があります。 このオブジェクトをサポートするために、コンテナーが必要ないことに注意してください。  
  
##  <a name="getfocus"></a>  COleControl::GetFocus  
 指定するかどうか、`COleControl`オブジェクトにフォーカスします。  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールがアクティブ化およびウィンドウなしの場合を返します**この**コントロール (定めるところによるコントロールのコンテナー) は、キーボード フォーカスを持っている場合または**NULL**フォーカスがあるない場合。  
  
 返しますそれ以外の場合、`CWnd`フォーカスのあるオブジェクト (と同じ`CWnd::GetFocus`)。  
  
### <a name="remarks"></a>コメント  
 アクティブなウィンドウなしのコントロールがフォーカスを受け取るときに[SetFocus](#setfocus)と呼びます。  
  
##  <a name="getfont"></a>  COleControl::GetFont  
 ストック フォント プロパティの Get 関数を実装します。  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールのストック フォント プロパティのフォントのディスパッチ インターフェイスへのポインター。  
  
### <a name="remarks"></a>コメント  
 呼び出し元が完了すると、オブジェクトを解放する必要がありますに注意してください。 コントロールの実装内で使用して`InternalGetFont`コントロールの株価のフォント オブジェクトにアクセスします。 コントロールでのフォントの使用に関する詳細については、記事を参照してください。 [ActiveX コントロール: ActiveX コントロールのフォントの使用](../../mfc/mfc-activex-controls-using-fonts.md)です。  
  
##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics  
 任意のテキストのメトリックを測定`CFontHolder`コントロールが所有するオブジェクト。  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>パラメーター  
 `lptm`  
 ポインター、[受け取る](http://msdn.microsoft.com/library/windows/desktop/dd145132)構造体。  
  
 `fontHolder`  
 参照、 [CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクト。  
  
### <a name="remarks"></a>コメント  
 このようなフォントを選択することができます、 [COleControl::SelectFontObject](#selectfontobject)関数。 `GetFontTextMetrics` 初期化は、`TEXTMETRIC`構造体を指す`lptm`に関する有効なメトリック情報を含む`fontHolder`のフォントが成功した場合、または成功しなかった場合、ゼロで構造を fill です。 代わりにこの関数を使用する必要があります[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)メタファイルに描画するときに必要な埋め込み OLE オブジェクトと同じように、コントロールがあるので、コントロールを描画します。  
  
 `TEXTMETRIC`構造体は、既定のフォントの更新時に、 [SelectFontObject](#selectfontobject)関数が呼び出されます。 呼び出す必要があります`GetFontTextMetrics`が有効では提供情報を確実にストック フォント プロパティを選択すると後にのみです。  
  
##  <a name="getforecolor"></a>  COleControl::GetForeColor  
 ストックの前景色プロパティの Get 関数を実装します。  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>戻り値  
 戻り値として現在前景色を指定する、 **OLE_COLOR**成功した場合は、値します。 この値に変換できる、 [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)値への呼び出しと`TranslateColor`です。  
  
##  <a name="gethwnd"></a>  COleControl::GetHwnd  
 HWnd のストック プロパティの Get 関数を実装します。  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>戻り値  
 OLE コントロールのウィンドウのハンドルが存在する場合です。それ以外の場合**NULL**です。  
  
##  <a name="getmessagestring"></a>  COleControl::GetMessageString  
 によって識別されるメニュー項目の目的を説明する短い文字列を取得するためにフレームワークによって呼び出されます`nID`です。  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `nID`  
 メニュー項目の id。  
  
 `rMessage`  
 参照、 [CString](../../atl-mfc-shared/reference/cstringt-class.md)文字列を返されるオブジェクトします。  
  
### <a name="remarks"></a>コメント  
 メニュー項目が強調表示された状態、ステータス バーに表示されるメッセージを取得するために使用できます。 既定の実装で識別される文字列リソースを読み込もうと`nID`です。  
  
##  <a name="getnotsupported"></a>  COleControl::GetNotSupported  
 ユーザーがコントロールのプロパティの値へのアクセスを防止します。  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>コメント  
 コントロールのユーザーによるプロパティの取得はサポートされていない任意のプロパティの Get 関数の代わりにこの関数を呼び出します。 1 つの例には、書き込み専用であるプロパティがあります。  
  
##  <a name="getreadystate"></a>  COleControl::GetReadyState  
 コントロールの準備状態を返します。  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>戻り値  
 次の値のいずれかのコントロールの準備状態:  
  
 **READYSTATE_UNINITIALIZED**  
 既定の初期化状態  
  
 **READYSTATE_LOADING**  
 コントロールが現在のプロパティを読み込んでいます。  
  
 **READYSTATE_LOADED**  
 コントロールが初期化されています。  
  
 **READYSTATE_INTERACTIVE**  
 コントロールが対話するための十分なデータが非同期のデータがまだ読み込まれています  
  
 `READYSTATE_COMPLETE`  
 コントロールがそのすべてのデータ  
  
### <a name="remarks"></a>コメント  
 ほとんどの単純なコントロールを区別する必要はありません**LOADED**と`INTERACTIVE`です。 ただし、データ パスのプロパティをサポートするコントロールは、少なくとも一部のデータを非同期的に受信するまで対話形式にする準備ができていない可能性があります。 コントロールは、できるだけ早く対話可能になる試みる必要があります。  
  
##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer  
 デバイス単位で表される、コンテナーを基準として、コントロールの四角形の座標を取得します。  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpRect`  
 コントロールの座標がコピー先となる四角形の構造体へのポインター。  
  
### <a name="return-value"></a>戻り値  
 コントロールが、インプレース アクティブ; である場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 四角形では、有効なは、コントロールが、インプレース アクティブである場合のみです。  
  
##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics  
 テキスト コントロールのストック フォント プロパティで選択できるメトリックの測定、 [SelectStockFont](#selectstockfont)関数。  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>パラメーター  
 `lptm`  
 ポインター、[受け取る](http://msdn.microsoft.com/library/windows/desktop/dd145132)構造体。  
  
### <a name="remarks"></a>コメント  
 `GetStockTextMetrics`関数では初期化、`TEXTMETRIC`構造体を指す`lptm`有効なメトリックについては、成功した場合、またはゼロ以外の場合と、構造を fill にします。 代わりにこの関数を使用して[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)メタファイルに描画するときに必要な埋め込み OLE オブジェクトと同じように、コントロールがあるので、コントロールを描画します。  
  
 `TEXTMETRIC`構造体は、既定のフォントの更新時に、`SelectStockFont`関数が呼び出されます。 有効では提供情報を確実にストック フォントを選択すると後にのみ、この関数を呼び出す必要があります。  
  
##  <a name="gettext"></a>  COleControl::GetText  
 ストックのテキストまたはキャプション プロパティの Get 関数を実装します。  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールのテキスト文字列または文字列が存在しない場合、長さゼロの文字列の現在の値。  
  
> [!NOTE]
>  詳細については、`BSTR`データ型を参照してください[データ型](../../mfc/reference/data-types-mfc.md)マクロとグローバルの「します。  
  
### <a name="remarks"></a>コメント  
 この関数の呼び出し元が呼び出す必要のある注`SysFreeString`文字列が返されるに無料リソース。 コントロールの実装内で使用して`InternalGetText`コントロールのテキストまたはキャプション ストック プロパティにアクセスします。  
  
##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget  
 オーバーライド`GetWindowlessDropTarget`ドラッグ アンド ドロップ操作を行う場合、OLE の対象となるウィンドウなしのコントロールです。  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>戻り値  
 オブジェクトへのポインター`IDropTarget`インターフェイスです。 ウィンドウなしのオブジェクトを登録できません、ウィンドウがないため、`IDropTarget`インターフェイスです。 ただし、ドラッグ アンド ドロップに参加するにウィンドウなしのオブジェクト インターフェイスを実装し、できますで返す`GetWindowlessDropTarget`です。  
  
### <a name="remarks"></a>コメント  
 通常、このコントロールのウィンドウがドロップ先として登録する必要があります。 コンテナーがドロップ ターゲットとして独自のウィンドウを使用して、コントロールに、独自のウィンドウがあるないためです。 コントロールは、の実装を提供する必要があるだけ、`IDropTarget`インターフェイスをコンテナーは、適切なタイミングで呼び出しを委任できます。 例えば:  
  
 [!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>  COleControl::InitializeIIDs  
 コントロールを使用しての Iid の基本クラスを通知します。  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>パラメーター  
 *piidPrimary*  
 コントロールのプライマリ ディスパッチ インターフェイスのインターフェイス ID へのポインター。  
  
 *piidEvents*  
 コントロールのイベント インターフェイスのインターフェイス ID へのポインター。  
  
### <a name="remarks"></a>コメント  
 この関数は、インターフェイスの Id を使用するコントロールの基底クラスを通知するために、コントロールのコンス トラクターを呼び出します。  
  
##  <a name="internalgetfont"></a>  COleControl::InternalGetFont  
 コントロールのストック フォント プロパティにアクセスします。  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>戻り値  
 参照、 [CFontHolder](../../mfc/reference/cfontholder-class.md)ストックのフォント オブジェクトを含むオブジェクトです。  
  
##  <a name="internalgettext"></a>  COleControl::InternalGetText  
 コントロールのストック テキストまたはキャプション プロパティにアクセスします。  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールのテキスト文字列への参照。  
  
##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState  
 コントロールの準備状態を設定します。  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>パラメーター  
 *lNewReadyState*  
 コントロールは、次の値のいずれかに設定する準備完了状態:  
  
 **READYSTATE_UNINITIALIZED**  
 既定の初期化状態  
  
 **READYSTATE_LOADING**  
 コントロールが現在のプロパティを読み込んでいます。  
  
 **READYSTATE_LOADED**  
 コントロールが初期化されています。  
  
 **READYSTATE_INTERACTIVE**  
 コントロールが対話するための十分なデータが非同期のデータがまだ読み込まれています  
  
 `READYSTATE_COMPLETE`  
 コントロールがそのすべてのデータ  
  
### <a name="remarks"></a>コメント  
 ほとんどの単純なコントロールを区別する必要はありません**LOADED**と`INTERACTIVE`です。 ただし、データ パスのプロパティをサポートするコントロールは、少なくとも一部のデータを非同期的に受信するまで対話形式にする準備ができていない可能性があります。 コントロールは、できるだけ早く対話可能になる試みる必要があります。  
  
##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl  
 自動的に再描画するコントロールを強制します。  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpRect`  
 無効にするコントロールの領域へのポインター。  
  
 `bErase`  
 更新領域の背景が更新領域の処理時に消去するかどうかを指定します。  
  
### <a name="remarks"></a>コメント  
 場合`lpRect`が、 **NULL**値、コントロール全体が再描画されます。 場合`lpRect`は**NULL**、無効にするコントロールの四角形の部分を示します。 コントロールは、ウィンドウがないか、現在アクティブになっていない、四角形は無視され、かつ場合をクライアント サイトの呼び出しが行われた[IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337)メンバー関数。 代わりにこの関数を使用して`CWnd::InvalidateRect`または`InvalidateRect`です。  
  
##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn  
 指定された領域内のコンテナーのウィンドウのクライアント領域を無効にします。  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `pRgn`  
 ポインター、 [CRgn](../../mfc/reference/crgn-class.md)オブジェクトを含むウィンドウのクライアント座標で、無効にする OLE オブジェクトの表示領域を識別します。 このパラメーターは、する場合**NULL**、そのエクステントはオブジェクト全体です。  
  
 `bErase`  
 無効化された領域の背景を消去するかどうかを指定します。 場合**TRUE**背景を消去します。 場合**FALSE**背景は変更されません。  
  
### <a name="remarks"></a>コメント  
 コンテナー内のウィンドウなしのコントロールを再描画するために使用できます。 更新領域内の他のすべての領域と、無効になった領域対象となっているときに描画次[WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213)メッセージを送信します。  
  
 場合`bErase`は**TRUE**更新領域の任意の部分では、特定の部分ではなく、領域全体の背景を消去します。  
  
##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX  
 OLE コントロールの特別な読み込みを許可します。  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールが変換された場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 OLE コントロールを使用する 1 つにコントロール VBX を使用する形式に変換するときに、OLE コントロールの特別な読み込みコードが必要な場合があります。 たとえば、OLE コントロールのインスタンスをロードする場合への呼び出しを必要があります[PX_Font](persistence-of-ole-controls.md#px_font)で、 `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 ただし、VBX コントロールがありませんでした Font オブジェクトです。フォントの各プロパティは、個別に保存されました。 この場合、使用`IsConvertingVBX`これら 2 つのケースを区別します。  
  
 [!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 別のケースは、VBX コントロールが専用のバイナリ データを保存するかどうかは (でその**VBM_SAVEPROPERTY**メッセージ ハンドラー)、OLE コントロールが別の形式でバイナリ データを保存します。 OLE コントロールの場合との下位互換性 VBX コントロールを使用して古いマスター_キーと新しい形式の両方を読み取ることが、 `IsConvertingVBX` VBX コントロールまたは OLE コントロールの読み込み中かどうかを区別することによって機能します。  
  
 コントロールの`DoPropExchange`関数の場合、この条件を確認して true の場合、(前の例では) などには、この変換に固有の読み込みのコードを実行します。 コントロールが変換されないとき場合、は、通常の負荷のコードを実行できます。 この機能にのみ適用 vbx から変換されているコントロール。  
  
##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed  
 オートメーション メソッドの呼び出しを有効にします。  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>戻り値  
 コントロールが初期化されている場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 フレームワークの実装の**idispatch::invoke**呼び出し**オーバーライド**場合は、特定の関数を決定する (で識別される`dispid`) 呼び出すことができます。 OLE コントロールの既定の動作は、オートメーション呼び出されるメソッドをコントロールが初期化されている場合にのみを許可するのにはただし、**オーバーライド**が仮想関数がオーバーライドするために必要な場合 (たとえば、コントロールは、オートメーション サーバーとして使用されている) 場合。 詳細については、サポート技術情報の記事 Q166472 を参照してください"HOWTO: オートメーション サーバーとして OLE コントロールを使用します。"。 サポート技術情報については、「 [ http://support.microsoft.com](http://support.microsoft.com/)です。  
  
##  <a name="ismodified"></a>  COleControl::IsModified  
 コントロールの状態が変更されたかどうかを判断します。  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>戻り値  
 最後の保存から、コントロールの状態が変更された場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 プロパティに値が変更されたときに、コントロールの状態が変更されます。  
  
##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw  
 コンテナーが、現在の描画操作の最適化された描画をサポートしているかどうかを判断します。  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>戻り値  
 **TRUE**コンテナーには、それ以外の描画、現在の描画操作を最適化がサポートされている場合**FALSE**です。  
  
### <a name="remarks"></a>コメント  
 最適化された描画がサポートされている場合、コントロール必要がありますいないオブジェクトを選択古い (ペン、ブラシ、フォントなど) デバイス コンテキストに描画が終了したときにします。  
  
##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl  
 Windows コントロールのサブクラス化が制御するかどうかを決定するために、フレームワークによって呼び出されます。  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールがサブクラス化された場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 この関数をオーバーライドし、返す必要があります**TRUE**場合は、OLE コントロールのサブクラスが Windows コントロール。  
  
##  <a name="load"></a>  COleControl::Load  
 非同期的に読み込まれた以前のデータをリセットし、コントロールの非同期プロパティの新しい読み込みを開始します。  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>パラメーター  
 *strNewPath*  
 非同期のコントロールのプロパティの絶対的な場所を参照するパスを含む文字列へのポインター。  
  
 *prop*  
 A[関数](../../mfc/reference/cdatapathproperty-class.md)非同期コントロール プロパティを実装するオブジェクト。  
  
##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive  
 コンテナーが、コントロールを非アクティブ化するを防ぎます。  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>パラメーター  
 `bLock`  
 **TRUE** ; ロックする場合はコントロールのインプレースでのアクティブな状態**FALSE**するロックを解除する場合は、します。  
  
### <a name="return-value"></a>戻り値  
 ロックが成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 終了時にコントロールのロック解除とコントロールのすべてのロックを組み合わせる必要があることに注意してください。 イベントを発生させるときに短時間など、コントロールをロックする必要がありますのみです。  
  
##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange  
 コンテナーのアンビエント プロパティに値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>パラメーター  
 *dispID*  
 変更されたアンビエント プロパティのディスパッチ ID または**DISPID_UNKNOWN**複数のプロパティが変更された場合。  
  
##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged  
 ストックの外観プロパティの値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>コメント  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。 既定の実装`InvalidateControl`です。  
  
##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged  
 ストックの BackColor プロパティの値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>コメント  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。 既定の実装`InvalidateControl`です。  
  
##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged  
 ストック BorderStyle プロパティの値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装`InvalidateControl`です。  
  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。  
  
##  <a name="onclick"></a>  COleControl::OnClick  
 マウス ボタンがクリックしてされたか DoClick ストック メソッドが呼び出されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>パラメーター  
 *iButton*  
 マウス ボタンのインデックス。 次の値のいずれかを持つことができます。  
  
- **LEFT_BUTTON**マウスの左ボタンがクリックしてされました。  
  
- **MIDDLE_BUTTON**マウスの中央ボタンがクリックしてされました。  
  
- **RIGHT_BUTTON**マウスの右ボタンがクリックしてされました。  
  
### <a name="remarks"></a>コメント  
 既定の実装`COleControl::FireClick`です。  
  
 変更または既定の処理を拡張するには、このメンバー関数をオーバーライドします。  
  
##  <a name="onclose"></a>  COleControl::OnClose  
 コンテナーには、コントロールが呼び出されたときに、フレームワークによって呼び出されます**IOleControl::Close**関数。  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwSaveOption`  
 読み込み前に、オブジェクトを保存するかどうかを示すフラグです。 次の値を指定できます。  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>コメント  
 既定では、`OnClose`が変更された場合は、コントロール オブジェクトを保存し、`dwSaveOption`か`OLECLOSE_SAVEIFDIRTY`または`OLECLOSE_PROMPTSAVE`です。  
  
##  <a name="ondoverb"></a>  COleControl::OnDoVerb  
 コンテナーを呼び出すときに、フレームワークによって呼び出されます、 **IOleObject::DoVerb**メンバー関数。  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `iVerb`  
 呼び出されるコントロール動詞のインデックス。  
  
 `lpMsg`  
 呼び出される動詞を原因となった Windows メッセージへのポインター。  
  
 `hWndParent`  
 コントロールの親ウィンドウへのハンドル。 動詞の実行が作成ウィンドウ (または windows)`hWndParent`親として使用する必要があります。  
  
 `lpRect`  
 RECT 構造体が、コンテナーを基準として、コントロールの座標のコピー先へのポインター。  
  
### <a name="return-value"></a>戻り値  
 呼び出しが成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 既定の実装を使用して、`ON_OLEVERB`と`ON_STDOLEVERB`メッセージ マップ エントリを呼び出すための適切な関数を識別します。  
  
 動詞の既定の処理を変更するには、この関数をオーバーライドします。  
  
##  <a name="ondraw"></a>  COleControl::OnDraw  
 指定したデバイス コンテキストを使用して、指定された外接する四角形の OLE コントロールを描画するためにフレームワークによって呼び出されます。  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 図面が発生しているデバイス コンテキスト。  
  
 `rcBounds`  
 境界線を含めて、コントロールの四角形の領域。  
  
 `rcInvalid`  
 無効なコントロールの四角形の領域。  
  
### <a name="remarks"></a>コメント  
 `OnDraw` 通常として画面デバイス コンテキストを渡すことの画面表示のために呼び出されます`pDC`です。 `rcBounds`パラメーターは、ターゲット デバイス コンテキスト (現在のマップ モード) の四角形を識別します。 `rcInvalid`パラメーターは実際の四角形が無効です。 場合によってはより小さな領域になります`rcBounds`です。  
  
##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile  
 指定されたメタファイル デバイス コンテキストを使用して、指定された外接する四角形の OLE コントロールを描画するためにフレームワークによって呼び出されます。  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 図面が発生しているデバイス コンテキスト。  
  
 `rcBounds`  
 境界線を含めて、コントロールの四角形の領域。  
  
### <a name="remarks"></a>コメント  
 既定の実装、 [OnDraw](#ondraw)関数。  
  
##  <a name="onedit"></a>  COleControl::OnEdit  
 Ui をアクティブにするコントロールがされます。  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpMsg`  
 動詞を起動した Windows メッセージへのポインター。  
  
 `hWndParent`  
 コントロールの親ウィンドウへのハンドル。  
  
 `lpRect`  
 コンテナーのコントロールで使用される四角形へのポインター。  
  
### <a name="return-value"></a>戻り値  
 呼び出しが成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 これは、コントロールを呼び出すのと同じ効果`OLEIVERB_UIACTIVATE`動詞です。  
  
 この関数は通常のハンドラー関数として使用する`ON_OLEVERB`マップ エントリのメッセージします。 これにより、コントロールの"Object"メニュー"Edit"動詞を使用可能なにします。 例えば:  
  
 [!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged  
 ストックの Enabled プロパティの値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>コメント  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。 既定の実装[InvalidateControl](#invalidatecontrol)です。  
  
##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs  
 コンテナーを呼び出すときに、フレームワークによって呼び出されます、 **IOleObject::EnumVerbs**メンバー関数。  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>パラメーター  
 `ppenumOleVerb`  
 ポインター、**返します**コントロールの動詞を列挙するオブジェクト。  
  
### <a name="return-value"></a>戻り値  
 動詞が使用可能な場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 既定の実装を列挙、`ON_OLEVERB`メッセージ マップのエントリ。  
  
 動詞の列挙の既定の方法を変更するには、この関数をオーバーライドします。  
  
##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise  
 イベント ハンドラーに接続されているまたは OLE コントロールから切断されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>パラメーター  
 `bAdvise`  
 **TRUE**イベント ハンドラーが、コントロールに接続されていることを示します。 **FALSE**コントロールからイベント ハンドラーが切断されていることを示します。  
  
##  <a name="onfontchanged"></a>  COleControl::OnFontChanged  
 ストック フォント プロパティ値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装`COleControl::InvalidateControl`です。 コントロールは、Windows コントロールをサブクラス化は場合、既定の実装も送信して、 **WM_SETFONT**コントロールのウィンドウにメッセージをします。  
  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged  
 ストックの ForeColor プロパティの値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装`InvalidateControl`です。  
  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。  
  
##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents  
 コンテナーの呼び出し後に、フレームワークによって呼び出されます**:freezeevents**です。  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>パラメーター  
 `bFreeze`  
 **TRUE**場合、コントロールのイベント処理は、それ以外の固定された**FALSE**です。  
  
### <a name="remarks"></a>コメント  
 既定の実装では、何も行われません。  
  
 イベント処理の凍結またはマスクされていないときにその他の動作を修正する場合は、この関数をオーバーライドします。  
  
##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet  
 コンテナーを呼び出すときに、フレームワークによって呼び出されます、 **IViewObject::GetColorSet**メンバー関数。  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>パラメーター  
 `ptd`  
 画像を表示する対象のターゲット デバイスを指します。 この値が場合**NULL**、ディスプレイ デバイスでは通常、既定のターゲット デバイスの画像をレンダリングする必要があります。  
  
 `hicTargetDev`  
 指定されたターゲット デバイス上の情報コンテキストの指定`ptd`です。 このパラメーターは、デバイス コンテキストを指定できますが、1 つは必ずしもはないです。 場合`ptd`は**NULL**、`hicTargetDev`すべき**NULL**です。  
  
 *ppColorSet*  
 使用される色のセットのコピー先の場所へのポインター。 関数は、色セットを返さない場合**NULL**が返されます。  
  
### <a name="return-value"></a>戻り値  
 以外の場合は、有効な色のセットが返されます。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 コンテナーは、OLE コントロールの描画に必要なすべての色を取得するには、この関数を呼び出します。 コンテナーは、全体的なカラー パレットを設定する必要がある色と組み合わせて取得した色のセットを使用できます。 既定の実装を返します**FALSE**です。  
  
 この要求の特別な処理を行うには、この関数をオーバーライドします。  
  
##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo  
 コントロールのコンテナーが、コントロールに関する情報を要求したときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>パラメーター  
 `pControlInfo`  
 ポインター、 [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734)格納する構造体。  
  
### <a name="remarks"></a>コメント  
 この情報は、主にコントロールのニーモニック キーの説明の構成要素します。 既定の実装がいっぱいになった`pControlInfo`に既定の情報です。  
  
 コントロールがニーモニック キーを処理する必要がある場合は、この関数をオーバーライドします。  
  
##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString  
 によって識別されたプロパティの現在の値を表す文字列を取得するためにフレームワークによって呼び出されます`dispid`です。  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 コントロールのプロパティのディスパッチ ID。  
  
 `strValue`  
 参照、 [CString](../../atl-mfc-shared/reference/cstringt-class.md)文字列を返されるオブジェクトします。  
  
### <a name="return-value"></a>戻り値  
 文字列が返された場合は 0 以外*strValue;* 0 それ以外の場合。  
  
### <a name="remarks"></a>コメント  
 コントロール プロパティが含まれる値を文字列に直接変換できませんし、コンテナーが提供するプロパティ ブラウザーに表示されるプロパティの値にする場合は、この関数をオーバーライドします。  
  
##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu  
 コントロールが UI でアクティブ化するコンテナーの既存のメニューにマージするメニューを取得するときに、フレームワークによって呼び出されます。  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>戻り値  
 コントロールのメニューのハンドルまたは**NULL**コントロールに [なし] がある場合。 既定の実装を返します**NULL**です。  
  
### <a name="remarks"></a>コメント  
 OLE リソースのマージに関する詳細については、記事を参照してください。[メニューとリソース (OLE)](../../mfc/menus-and-resources-ole.md)です。  
  
##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent  
 コンテナーの応答にフレームワークによって呼び出されます**IViewObjectEx::GetNaturalExtent**要求します。  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwAspect`  
 オブジェクトがどのように表示されるかを指定します。 表現には、コンテンツ、アイコン、サムネイル、または印刷したドキュメントが含まれます。 有効な値は、列挙から取得[型](http://msdn.microsoft.com/library/windows/desktop/ms690318)または**DVASPECT2**です。  
  
 *lindex*  
 関心のあるオブジェクトの部分。 有効では現在は-1 です。  
  
 `ptd`  
 指す、 [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)対象のオブジェクトのサイズを返す必要があるターゲット デバイスを定義する構造体。  
  
 `hicTargetDev`  
 指定されたターゲット デバイスの情報コンテキストを示す、`ptd`パラメーター元となるオブジェクトはデバイス メトリックを抽出し、デバイスの機能をテストします。 場合`ptd`は**NULL**、オブジェクトの値を無視する必要があります、`hicTargetDev`パラメーター。  
  
 *pExtentInfo*  
 指す、 **DVEXTENTINFO**をサイズ変更データを指定します。 **DVEXTENTINFO**構造体は。  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 構造体メンバー `dwExtentMode` 2 つの値のいずれかを実行します。  
  
- **DVEXTENT_CONTENT**どのくらいのサイズはそのコントロールが正確に内容に合わせて (スナップ サイズ) を照会します。  
  
- **DVEXTENT_INTEGRAL**サイズを変更する場合は、コントロールに提案されたサイズを渡す  
  
 `psizel`  
 コントロールによって返されるデータのサイズ変更を指します。 返されるサイズ変更データが調整されていない任意の次元に達すると-1 に設定されます。  
  
### <a name="return-value"></a>戻り値  
 以外の場合は、正常に取得およびサイズの調整それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 提案されたサイズと拡張モードに最も近いオブジェクトの表示サイズを返す関数をオーバーライドします**DVEXTENTINFO**構造体。 既定の実装を返します**FALSE**とサイズに調整は行われません。  
  
##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings  
 プロパティの値を表す定義済みの文字列のセットを取得するためにフレームワークによって呼び出されます。  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 コントロールのプロパティのディスパッチ ID。  
  
 `pStringArray`  
 格納する文字列配列では、値を返します。  
  
 `pCookieArray`  
 A`DWORD`戻り値を使用して入力する配列。  
  
### <a name="return-value"></a>戻り値  
 要素に追加された場合は 0 以外`pStringArray`と`pCookieArray`です。  
  
### <a name="remarks"></a>コメント  
 コントロールにプロパティの文字列で表すことが可能な値の設定がある場合は、この関数をオーバーライドします。 追加の各要素に対して`pStringArray`に対応する"cookie"要素を追加する必要があります*pCookieArray です。* フレームワークによってこれらのクッキー値を渡すことは後で、`COleControl::OnGetPredefinedValue`関数。  
  
##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue  
 以前のオーバーライドによって返される定義済みの文字列のいずれかに対応する値を取得するためにフレームワークによって呼び出されます`COleControl::OnGetPredefinedStrings`です。  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 コントロールのプロパティのディスパッチ ID。  
  
 `dwCookie`  
 Cookie の値のオーバーライドによって以前返さ`COleControl::OnGetPredefinedStrings`です。  
  
 `lpvarOut`  
 ポインター、**バリアント**を介してプロパティ値を返される構造体します。  
  
### <a name="return-value"></a>戻り値  
 値が返された場合は 0 以外`lpvarOut`。 それ以外の場合に 0 です。  
  
##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent  
 コンテナーの応答にフレームワークによって呼び出されます[IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032)要求します。  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>パラメーター  
 *dwDrawAspect*  
 `DWORD` フォームまたは側面を記述する、オブジェクトの表示されます。 有効な値は、列挙から取得[型](http://msdn.microsoft.com/library/windows/desktop/ms690318)または**DVASPECT2**です。  
  
 *lindex*  
 関心のあるオブジェクトの部分。 有効では現在は-1 です。  
  
 `ptd`  
 指す、 [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)対象のオブジェクトのサイズを返す必要があるターゲット デバイスを定義する構造体。  
  
 *lpsizel*  
 オブジェクトのサイズが返される場所へのポインター。  
  
### <a name="return-value"></a>戻り値  
 エクステント情報が正常に返された場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 コントロールで 2 つのパスの描画を使用し、その不透明な直線および透明部分がさまざまな次元を持つ場合は、この関数をオーバーライドします。  
  
##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect  
 コンテナーの応答にフレームワークによって呼び出されます**IViewObjectEx::GetRect**要求します。  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwAspect`  
 `DWORD` フォームまたは側面を記述する、オブジェクトの表示されます。 有効な値は、列挙から取得[型](http://msdn.microsoft.com/library/windows/desktop/ms690318)または**DVASPECT2**:  
  
- `DVASPECT_CONTENT` オブジェクト全体の外接する四角形。 オブジェクトの原点にによって返されたエクステントと同じサイズの左上隅 **GetViewExtent * * *。*  
  
- **DVASPECT_OPAQUE**四角形の不透明な領域を持つオブジェクトは、その四角形を返します。 他のユーザーが失敗します。  
  
- **DVASPECT_TRANSPARENT**すべての透過的または変則的な部分をカバーする四角形。  
  
 `pRect`  
 指す、 [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907)オブジェクトを描画する四角形を指定する構造体。 このパラメーターは、配置やオブジェクトの拡大を制御します。  
  
### <a name="return-value"></a>戻り値  
 以外の場合は、オブジェクトのサイズの四角形が正常に返されます。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 オブジェクトのサイズは変換`OnGetViewRect`(既定では、画面の左上隅) 特定の位置以降にある四角形にします。 コントロールで 2 つのパスの描画を使用し、その不透明な直線および透明部分がさまざまな次元を持つ場合は、この関数をオーバーライドします。  
  
##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus  
 コンテナーの応答にフレームワークによって呼び出されます**IViewObjectEx::GetViewStatus**要求します。  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>戻り値  
 値のいずれか、**な VIEWSTATUS**列挙成功、0 以外の場合。 値には、次の任意の組み合わせがあります。  
  
 **VIEWSTATUS_OPAQUE**  
 オブジェクトは完全に不透明です。 このビットが設定されていない場合、オブジェクトには、透過的なパーツが含まれています。 このビットのみのコンテンツに関連する側面と該当しないように`DVASPECT_ICON`または`DVASPECT_DOCPRINT`です。  
  
 **VIEWSTATUS_SOLIDBKGND**  
 オブジェクトには、純色の背景 (純色、ブラシ パターンではないので構成される) があります。 このビットが意味のある場合にのみ、 **VIEWSTATUS_OPAQUE**が設定され、およびしないようにコンテンツに関連する側面にのみ適用されます`DVASPECT_ICON`または`DVASPECT_DOCPRINT`です。  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 オブジェクトのサポート**DVASPECT_OPAQUE**です。 すべて**IViewObjectEx**パラメーターは、この側面で呼び出すことができます、描画の外観を取るメソッドです。  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 オブジェクトのサポート**DVASPECT_TRANSPARENT**です。 すべて**IViewObjectEx**パラメーターは、この側面で呼び出すことができます、描画の外観を取るメソッドです。  
  
### <a name="remarks"></a>コメント  
 コントロールは、2 つのパスの描画を使用している場合は、この関数をオーバーライドします。 既定の実装を返します**VIEWSTATUS_OPAQUE**です。  
  
##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars  
 コントロールが UI で非アクティブ化されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>コメント  
 実装には、によって表示されるすべてのツールバーが非表示にする必要があります`OnShowToolbars`です。  
  
##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove  
 下の受信にマウス ポインターが非アクティブなオブジェクトのコンテナーによって呼び出される、`WM_MOUSEMOVE`メッセージ。  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>パラメーター  
 `lprcBounds`  
 外接する四角形の格納先ウィンドウのクライアント座標で、オブジェクトです。 オブジェクトの正確な位置とサイズ、画面上の通知時に、`WM_MOUSEMOVE`メッセージを受信しました。  
  
 *x*  
 格納先ウィンドウのクライアント座標でマウスの位置の x 座標。  
  
 *y*  
 格納先ウィンドウのクライアント座標でマウスの位置の y 座標。  
  
 `dwKeyState`  
 キーボードのキーボードの修飾子キーの現在の状態を識別します。 有効な値のフラグのいずれかの組み合わせが可能**MK_CONTROL**、 **MK_SHIFT**、 **MK_ALT**、 **MK_BUTTON**、 **MK_LBUTTON**、 **MK_MBUTTON**、および**MK_RBUTTON**です。  
  
### <a name="remarks"></a>コメント  
 ウィンドウのクライアント座標 (ピクセル単位) を使用する、マウスのカーソル位置を渡すことに注意してください。 これは、操作を行う同じ座標系でオブジェクトの外接する四角形も渡すことによってです。  
  
##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor  
 下の受信にマウス ポインターが非アクティブなオブジェクトのコンテナーによって呼び出される、`WM_SETCURSOR`メッセージ。  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>パラメーター  
 `lprcBounds`  
 外接する四角形の格納先ウィンドウのクライアント座標で、オブジェクトです。 オブジェクトの正確な位置とサイズ、画面上の通知時に、`WM_SETCURSOR`メッセージを受信しました。  
  
 *x*  
 格納先ウィンドウのクライアント座標でマウスの位置の x 座標。  
  
 *y*  
 格納先ウィンドウのクライアント座標でマウスの位置の y 座標。  
  
 *dwMouseMsg*  
 対象のマウスのメッセージの識別子、`WM_SETCURSOR`が発生しました。  
  
 *bSetAlways*  
 オブジェクトが、カーソルを設定する必要があるかどうかを指定します。 場合**TRUE**場合、に、オブジェクトが、カーソルを設定する必要があります**FALSE**、カーソル、カーソルを設定する義務はありませんし、返す必要があります**S_FALSE**という点です。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 ウィンドウのクライアント座標 (ピクセル単位) を使用する、マウスのカーソル位置を渡すことに注意してください。 これは、操作を行う同じ座標系でオブジェクトの外接する四角形も渡すことによってです。  
  
##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent  
 ストック KeyDown イベントが処理された後に、フレームワークによって呼び出されます。  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>パラメーター  
 `nChar`  
 押されたキーの仮想キー コード値。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
### <a name="remarks"></a>コメント  
 コントロールが、イベントが発生した後、キーの情報へのアクセスを必要とする場合は、この関数をオーバーライドします。  
  
##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent  
 ストックの KeyPress イベントが発生した後に、フレームワークによって呼び出されます。  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>パラメーター  
 `nChar`  
 押されたキーの仮想キー コード値が含まれています。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。  
  
### <a name="remarks"></a>コメント  
 なお、`nChar`コンテナーによって値が変更されている可能性があります。  
  
 このイベントの発生後に通知が使用する場合は、この関数をオーバーライドします。  
  
##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent  
 ストック KeyDown イベントが処理された後に、フレームワークによって呼び出されます。  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>パラメーター  
 `nChar`  
 押されたキーの仮想キー コード値。 標準の仮想キー コードの一覧は、Winuser.h を参照してください。  
  
 `nShiftState`  
 次のフラグの組み合わせが含まれます。  
  
- **SHIFT_MASK**アクション中に、SHIFT キーが押されました。  
  
- **CTRL_MASK**アクション中に、CTRL キーが押されました。  
  
- **ALT_MASK**アクション中に、ALT キーが押されました。  
  
### <a name="remarks"></a>コメント  
 コントロールが、イベントが発生した後、キーの情報へのアクセスを必要とする場合は、この関数をオーバーライドします。  
  
##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage  
 指定したプロパティの編集を実装するプロパティ ページのクラス ID を取得するためにフレームワークによって呼び出されます。  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>パラメーター  
 `dispid`  
 コントロールのプロパティのディスパッチ ID。  
  
 `lpclsid`  
 ポインター、 **CLSID**を通じてクラス ID を返される構造体します。  
  
 *pbPageOptional*  
 指定したプロパティ ページの使用は省略可能かどうかを示すインジケーターを返します。  
  
### <a name="return-value"></a>戻り値  
 クラス ID が返された場合は 0 以外`lpclsid`。 それ以外の場合に 0 です。  
  
### <a name="remarks"></a>コメント  
 コンテナーのプロパティ ブラウザーからのコントロールのプロパティ ページを呼び出す方法を提供するには、この関数をオーバーライドします。  
  
##  <a name="onmnemonic"></a>  COleControl::OnMnemonic  
 コンテナーの OLE コントロールのニーモニック キーが押されたことが検出されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>パラメーター  
 `pMsg`  
 ニーモニック キーの押下時に生成された Windows メッセージへのポインター。  
  
##  <a name="onproperties"></a>  COleControl::OnProperties  
 コントロールのプロパティの動詞がコンテナーによって呼び出されたときに、フレームワークによって呼び出されます。  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpMsg`  
 動詞を起動した Windows メッセージへのポインター。  
  
 `hWndParent`  
 コントロールの親ウィンドウへのハンドル。  
  
 `lpRect`  
 コンテナーのコントロールで使用される四角形へのポインター。  
  
### <a name="return-value"></a>戻り値  
 呼び出しが成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 既定の実装には、モーダル プロパティ ダイアログ ボックスが表示されます。  
  
 また、コントロールのプロパティ ページの表示が発生するのにこの関数を使用することができます。 呼び出しを行う、`OnProperties`のコントロールの親のハンドルを渡すこと、関数、`hWndParent`パラメーター。 この場合の値、`lpMsg`と`lpRect`パラメーターは無視されます。  
  
##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint  
 コンテナーの応答にフレームワークによって呼び出されます**IViewObjectEx::QueryHitPoint**要求します。  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwAspect`  
 オブジェクトの表現方法を指定します。 有効な値は、列挙から取得[型](http://msdn.microsoft.com/library/windows/desktop/ms690318)または**DVASPECT2**です。  
  
 `pRectBounds`  
 ポインター、 `RECT` OLE コントロールのクライアント領域に外接する四角形を指定する構造体。  
  
 `ptlLoc`  
 ポインター、**ポイント**ヒットは、チェックする位置を指定します。 ポイントすると、OLE クライアント領域の座標を指定します。  
  
 `lCloseHint`  
 「閉じる」ポイントにヒットがチェックを定義する距離。  
  
 `pHitResult`  
 ヒット クエリの結果へのポインター。 次のいずれかの値です。  
  
- **値**`ptlLoc`外 OLE オブジェクトと、閉じることができません。  
  
- **中心** *ptlLoc*イメージの近くにいないが、OLE オブジェクトの境界内にあります。 たとえば、透過的な円の途中でポイントがある可能性があります**中心**です。  
  
- **HITRESULT_CLOSE** `ptlLoc`は内側または外側 OLE オブジェクトが内部と見なされるオブジェクトに短い間隔です。 小さな、細枠、または詳細なオブジェクトは、この値を使用して可能性があります。 可能性があるオブジェクトの四角形がほぼ同じで、ポイントが境界の外側にある場合でも (これは、小さなオブジェクトをヒットに必要です)。  
  
- **この**`ptlLoc`オブジェクトのイメージ内にあります。  
  
### <a name="return-value"></a>戻り値  
 ヒット テストの結果が正常に返された場合は 0 以外。それ以外の場合 0 を返します。 ヒットは、OLE コントロールの表示領域の重複部分です。  
  
### <a name="remarks"></a>コメント  
 オブジェクトの表示の四角形に指定された点が重なっているかどうかをクエリ (ポイントをヒット)。 `QueryHitPoint` 四角形以外のオブジェクトに対してヒット テストをオーバーライドできます。  
  
##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect  
 コンテナーの応答にフレームワークによって呼び出されます**IViewObjectEx::QueryHitRect**要求します。  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwAspect`  
 オブジェクトがどのように表示されるかを指定します。 有効な値は、列挙から取得[型](http://msdn.microsoft.com/library/windows/desktop/ms690318)または**DVASPECT2**です。  
  
 `pRectBounds`  
 ポインター、 `RECT` OLE コントロールのクライアント領域に外接する四角形を指定する構造体。  
  
 *prcLoc*  
 ポインター、`RECT`構造のオブジェクトの左上隅に対する相対ヒット (が重複しているオブジェクトの四角形) をチェックする四角形を指定します。  
  
 `lCloseHint`  
 使用しません。  
  
 `pHitResult`  
 ヒット クエリの結果へのポインター。 次のいずれかの値です。  
  
- **値**OLE オブジェクトを四角形内のポイントがヒットしません。  
  
- **この**四角形内の少なくとも 1 つのポイントは、オブジェクトでヒットになります。  
  
### <a name="return-value"></a>戻り値  
 ヒット テストの結果が正常に返された場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 オブジェクトの表示の四角形に (四角形をヒット) の指定した四角形の任意の時点が重なっているかどうかを照会します。 `QueryHitRect` 四角形以外のオブジェクトに対してヒット テストをオーバーライドできます。  
  
##  <a name="onrenderdata"></a>  COleControl::OnRenderData  
 指定された形式でデータを取得するためにフレームワークによって呼び出されます。  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpFormatEtc`  
 指す、 [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)情報が要求された形式を指定します。  
  
 `lpStgMedium`  
 指す、 [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)データが返される構造体。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 コントロール オブジェクトを使用して、以前に適用した指定の形式は、[に](../../mfc/reference/coledatasource-class.md#delayrenderdata)または[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)メンバー関数の遅延レンダリングします。 この関数の既定の実装を呼び出す`OnRenderFileData`または`OnRenderGlobalData`、それぞれ、指定されたストレージ メディアがメモリまたはファイルの場合。 要求された形式の場合`CF_METAFILEPICT`永続的なプロパティの形式を設定するか、既定の実装は、適切なデータを表示し、0 以外を返します。 それ以外の場合は 0 を返し、何も行われません。  
  
 場合*lpStgMedium tymed]-> [*は**TYMED_NULL**、 **STGMEDIUM**割り当てられで指定された入力*lpFormatEtc tymed]->[*. ない場合**TYMED_NULL**、 **STGMEDIUM**のデータが配置を入力する必要があります。  
  
 要求された形式および中規模でデータを提供するには、この関数をオーバーライドします。 によっては、データを代わりにこの関数の他のバージョンの 1 つを上書きする可能性があります。 データが小規模で固定サイズの場合は、オーバーライド`OnRenderGlobalData`です。 データをファイル内や可変サイズのオーバーライド`OnRenderFileData`です。  
  
 詳細については、次を参照してください。、 **FORMATETC**と**STGMEDIUM** Windows SDK 内の構造体。  
  
##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData  
 ストレージ メディア ファイルは、ときに、指定された形式でデータを取得するためにフレームワークによって呼び出されます。  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpFormatEtc`  
 指す、 [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)情報が要求された形式を指定します。  
  
 `pFile`  
 指す、 [CFile](../../mfc/reference/cfile-class.md)データが表示されるオブジェクト。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 指定された形式は、いずれかのコントロール オブジェクトを使用して、以前に適用した、[に](../../mfc/reference/coledatasource-class.md#delayrenderdata)遅延レンダリングするためのメンバー関数。 この関数の既定の実装を単純に返します**FALSE**です。  
  
 要求された形式および中規模でデータを提供するには、この関数をオーバーライドします。 によっては、データは、代わりにこの関数の他のバージョンの 1 つをオーバーライドすることができます。 複数のストレージ メディアを処理する場合は、オーバーライド`OnRenderData`です。 データをファイル内や可変サイズのオーバーライド`OnRenderFileData`です。  
  
 詳細については、次を参照してください。、 **FORMATETC** Windows SDK 内の構造。  
  
##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData  
 指定されたストレージ メディアが使用するグローバル メモリに指定された形式でデータを取得するためにフレームワークによって呼び出されます。  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpFormatEtc`  
 指す、 [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)情報が要求された形式を指定します。  
  
 `phGlobal`  
 データが返されるグローバル メモリへのハンドルへのポインター。 このパラメーターを指定できるメモリが割り当てられていない場合**NULL**です。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 指定された形式は、いずれかのコントロール オブジェクトを使用して、以前に適用した、[に](../../mfc/reference/coledatasource-class.md#delayrenderdata)遅延レンダリングするためのメンバー関数。 この関数の既定の実装を単純に返します**FALSE**です。  
  
 場合`phGlobal`は**NULL**、し、新しい`HGLOBAL`割り当てられで返される必要があります`phGlobal`です。 それ以外の場合、`HGLOBAL`によって指定された`phGlobal`データを格納する必要があります。 内に配置するデータ量、`HGLOBAL`メモリ ブロックの現在のサイズを超えない必要があります。 また、ブロックは、大きいサイズに再割り当てできません。  
  
 要求された形式および中規模でデータを提供するには、この関数をオーバーライドします。 によっては、データを代わりにこの関数の他のバージョンの 1 つを上書きする可能性があります。 複数のストレージ メディアを処理する場合は、オーバーライド`OnRenderData`です。 データをファイル内や可変サイズのオーバーライド`OnRenderFileData`です。  
  
 詳細については、次を参照してください。、 **FORMATETC** Windows SDK 内の構造。  
  
##  <a name="onresetstate"></a>  COleControl::OnResetState  
 コントロールのプロパティを既定値に設定する必要があるときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装[DoPropExchange](#dopropexchange)渡す、`CPropExchange`オブジェクトにより、既定値に設定するプロパティです。  
  
 コントロール ライターは、この OLE コントロールの初期化コードを挿入できるオーバーライド可能です。 この関数が呼び出されます[IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568)または[機能として](http://msdn.microsoft.com/library/windows/desktop/ms680557)失敗した場合、または[IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234)または[すること。: れます](http://msdn.microsoft.com/library/windows/desktop/ms687194)が呼び出されると、いずれかの最初を呼び出さずに**IPersistStream::Load**または**機能として**です。  
  
##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite  
 コンテナーには、コントロールが呼び出されたときに、フレームワークによって呼び出されます**IOleControl::SetClientSite**関数。  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>コメント  
 既定では、`OnSetClientSite`データ パスのプロパティを読み込むかどうかを確認し、呼び出しの場合は、`DoDataPathPropExchange`です。  
  
 この通知の特別な処理を行うには、この関数をオーバーライドします。 具体的には、この関数のオーバーライドは基底クラスを呼び出す必要があります。  
  
##  <a name="onsetdata"></a>  COleControl::OnSetData  
 データを指定して、コントロールのデータを交換するためにフレームワークによって呼び出されます。  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpFormatEtc`  
 ポインター、 [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)データの形式を指定します。  
  
 `lpStgMedium`  
 ポインター、 [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)データが存在する構造体します。  
  
 `bRelease`  
 **TRUE**場合は、コントロールがストレージ メディアを解放する必要があります**FALSE**場合は、コントロールがストレージ メディアを解放する必要があります。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 データは永続的なプロパティで設定されている場合の形式、既定の実装は、コントロールの状態を適宜を変更します。 それ以外の場合、既定の実装では、何も行いません。 場合`bRelease`は**TRUE**への呼び出し、 **ReleaseStgMedium**が行われます。 それ以外の場合 not。  
  
 データを指定して、コントロールのデータを置き換えるには、この関数をオーバーライドします。  
  
 詳細については、次を参照してください。、 **FORMATETC**と**STGMEDIUM** Windows SDK 内の構造体。  
  
##  <a name="onsetextent"></a>  COleControl::OnSetExtent  
 コントロールの範囲への呼び出しの結果として、変更する必要がある場合に、フレームワークによって呼び出されます[IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330)です。  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpSizeL`  
 ポインター、**サイズ**で表される、コントロールの高さと幅を表す長整数を使用する構造**HIMETRIC**単位です。  
  
### <a name="return-value"></a>戻り値  
 サイズの変更が受け入れられた場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 既定の実装では、コントロールの範囲のサイズ変更を処理します。 コントロールが、インプレース アクティブ、コンテナーへの呼び出しである場合**OnPosRectChanged**が行われます。  
  
 コントロールの既定のサイズ変更を変更するには、この関数をオーバーライドします。  
  
##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects  
 呼び出しを実装するためにフレームワークによって呼び出されます[IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767)です。  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>パラメーター  
 *lpRectPos*  
 コントロールの新しい位置とサイズ、コンテナーを基準としてを示す RECT 構造体へのポインター。  
  
 `lpRectClip`  
 ポインター、`RECT`コントロールのクリッピング四角形の領域を示す構造体。  
  
### <a name="return-value"></a>戻り値  
 位置変更が受け入れられた場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 既定の実装は自動的にコントロール ウィンドウのサイズを変更して、位置変更を処理し、返します**TRUE**です。  
  
 この関数の既定の動作を変更するには、この関数をオーバーライドします。  
  
##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars  
 コントロールの UI がアクティブになったときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装では、何も行われません。  
  
##  <a name="ontextchanged"></a>  COleControl::OnTextChanged  
 ストックのキャプションまたはテキストのプロパティ値が変更されたときに、フレームワークによって呼び出されます。  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装`InvalidateControl`です。  
  
 このプロパティが変更された後に通知を使用する場合は、この関数をオーバーライドします。  
  
##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage  
 コンテナーの応答にフレームワークによって呼び出されます**IOleInPlaceObjectWindowless::OnWindowMessage**要求します。  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>パラメーター  
 `msg`  
 Windows で渡されるメッセージの識別子です。  
  
 `wParam`  
 Windows で渡される。 その他のメッセージに固有の情報を指定します。 このパラメーターの内容がの値に依存する、`msg`パラメーター。  
  
 `lParam`  
 Windows で渡される。 その他のメッセージに固有の情報を指定します。 このパラメーターの内容がの値に依存する、`msg`パラメーター。  
  
 *plResult*  
 Windows の結果コード。 メッセージの処理の結果を指定し、送信メッセージに依存します。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 ウィンドウなしのコントロールのウィンドウ メッセージを処理します。 `COleControl``OnWindowlessMessage`ウィンドウ メッセージをメッセージのマウスとキーボード メッセージ以外に使用する必要があります。 `COleControl` 提供[SetCapture](#setcapture)と[SetFocus](#setfocus)ウィンドウなしの OLE オブジェクトのマウスのキャプチャ、キーボード フォーカスを取得するには、具体的にします。  
  
 ウィンドウなしのオブジェクトは、ウィンドウがあるないため、コンテナー メッセージをディスパッチできるようにするためのメカニズムが必要です。 ウィンドウなしの OLE オブジェクトを取得メッセージがコンテナーからを通じて、`OnWindowMessage`メソッドを`IOleInPlaceObjectWindowless`インターフェイス (の拡張機能[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)ウィンドウなしのサポート用)。 `OnWindowMessage` 受け取らない、`HWND`パラメーター。  
  
##  <a name="parenttoclient"></a>  COleControl::ParentToClient  
 座標に変換`pPoint`クライアント座標にします。  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>パラメーター  
 `lprcBounds`  
 コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではなく、境界線とスクロール バーを含むコントロール全体の領域。  
  
 `pPoint`  
 親 (コンテナー) へのポインターは、コントロールのクライアント領域の座標に変換 をポイントします。  
  
 `bHitTest`  
 ポイントで実行するかどうかは、ヒット テストを指定します。  
  
### <a name="return-value"></a>戻り値  
 場合`bHitTest`は**FALSE**、返します**HTNOWHERE**です。 場合`bHitTest`は**TRUE**OLE コントロールのクライアント領域に読み込まれたので、親 (コンテナー) をポイントする場所を返します、およびヒット テストの値は、次のマウスのいずれか。  
  
- **HTBORDER**サイズ変更境界がないウィンドウの境界線にします。  
  
- **HTBOTTOM**ウィンドウの下部の水平方向の境界線にします。  
  
- **HTBOTTOMLEFT**ウィンドウの境界線の左下隅にあります。  
  
- **HTBOTTOMRIGHT**ウィンドウの枠線の右下隅にあります。  
  
- **HTCAPTION**タイトル バー領域でします。  
  
- **HTCLIENT**クライアント領域にします。  
  
- **HTERROR**画面の背景またはウィンドウ間の区切り線 (と同じ**HTNOWHERE**する点を除いて、 **DefWndProc** Windows 関数ビープ音がシステムはエラーを示します)。  
  
- **HTGROWBOX**サイズ ボックスです。  
  
- **HTHSCROLL**水平スクロール バーにします。  
  
- **HTLEFT**ウィンドウの左罫線にします。  
  
- **HTMAXBUTTON**で、最大化ボタンをクリックします。  
  
- **HTMENU**メニュー領域にします。  
  
- **HTMINBUTTON**で、最小化ボタンをクリックします。  
  
- **HTNOWHERE**画面の背景またはウィンドウ間の区切り線。  
  
- **HTREDUCE**で、最小化ボタンをクリックします。  
  
- **HTRIGHT**ウィンドウの右罫線にします。  
  
- **HTSIZE**サイズ ボックスに (同じ**HTGROWBOX**)。  
  
- **HTSYSMENU**コントロール メニューまたは子ウィンドウで [閉じる] ボタンをクリックします。  
  
- **HTTOP**ウィンドウの上部の水平方向の境界線にします。  
  
- **HTTOPLEFT**ウィンドウの境界線の左上隅にあります。  
  
- **HTTOPRIGHT**ウィンドウの枠線の右上隅にします。  
  
- **HTTRANSPARENT**別のウィンドウで該当する現在のウィンドウでします。  
  
- **HTVSCROLL**垂直スクロール バーにします。  
  
- **HTZOOM**で、最大化ボタンをクリックします。  
  
### <a name="remarks"></a>コメント  
 入力時に`pPoint`親 (コンテナーの左上隅) の原点に対する相対パスです。 出力に`pPoint`OLE コントロール (コントロールのクライアント領域の左上隅) のクライアント領域の原点に対する相対パスです。  
  
##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog  
 モーダル ダイアログ ボックスが閉じられたことをコンテナーに通知します。  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>パラメーター  
 `hWndParent`  
 モーダル ダイアログ ボックスの親ウィンドウへのハンドルします。  
  
### <a name="remarks"></a>コメント  
 モーダル ダイアログ ボックスが表示された後に、この関数を呼び出します。 コンテナーがによって無効になっている任意の最上位のウィンドウを有効にするように、この関数を呼び出す必要があります`PreModalDialog`です。 この関数への呼び出しと組み合わせる必要があります`PreModalDialog`です。  
  
##  <a name="premodaldialog"></a>  COleControl::PreModalDialog  
 モーダル ダイアログ ボックスが表示されることをコンテナーに通知します。  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>パラメーター  
 `hWndParent`  
 モーダル ダイアログ ボックスの親ウィンドウへのハンドルします。  
  
### <a name="remarks"></a>コメント  
 モーダル ダイアログ ボックスを表示する前に、この関数を呼び出します。 コンテナーがすべてのトップレベル ウィンドウを無効にするように、この関数を呼び出す必要があります。 モーダル ダイアログ ボックスが表示された後、呼び出す必要があります`PostModalDialog`です。  
  
##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow  
 破棄し、コントロールのウィンドウを再作成します。  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>コメント  
 ウィンドウのスタイルを表すビットを変更する必要がある場合に必要な場合があります。  
  
##  <a name="refresh"></a>  COleControl::Refresh  
 強制的に OLE コントロールの再描画をします。  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>コメント  
 この関数はサポート、`COleControl`更新と呼ばれる、ストック メソッドとしての基本クラスです。 これにより、OLE コントロールのユーザーが特定の時刻にコントロールを再描画します。 このメソッドの詳細については、記事を参照してください。 [ActiveX コントロール: メソッド](../../mfc/mfc-activex-controls-methods.md)です。  
  
##  <a name="releasecapture"></a>  COleControl::ReleaseCapture  
 マウスのキャプチャを解放します。  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 コントロールは、現在、マウス キャプチャを持つ、キャプチャは解放されます。 それ以外の場合、この関数には効果はありません。  
  
##  <a name="releasedc"></a>  COleControl::ReleaseDC  
 他のアプリケーションで使用するためのデバイス コンテキストを解放する、ウィンドウなしのコントロールのコンテナーのディスプレイ デバイス コンテキストを解放します。  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 解放するコンテナー デバイス コンテキストを識別します。  
  
### <a name="return-value"></a>戻り値  
 正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。  
  
### <a name="remarks"></a>コメント  
 アプリケーションを呼び出す必要があります`ReleaseDC`呼び出しごとに[GetDC](#getdc)です。  
  
##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow  
 コントロールの親を設定します。  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>パラメーター  
 *hWndOuter*  
 コントロール ウィンドウのハンドルです。  
  
 `hWndParent`  
 新しい親ウィンドウのハンドル。  
  
### <a name="remarks"></a>コメント  
 コントロール ウィンドウの親をリセットするには、この関数を呼び出します。  
  
##  <a name="resetstockprops"></a>  COleControl::ResetStockProps  
 状態を初期化、`COleControl`ストック プロパティが既定値にします。  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>コメント  
 プロパティは、: 外観、色の BackColor、BorderStyle、キャプション、Enabled、フォント、ForeColor、hWnd、およびテキスト。 ストック プロパティの説明は、次を参照してください。 [ActiveX コントロール: ストック プロパティの追加](../../mfc/mfc-activex-controls-adding-stock-properties.md)です。  
  
 使用して、コントロールのバイナリの初期化のパフォーマンスを向上できる`ResetStockProps`と`ResetVersion`をオーバーライドする`COleControl::OnResetState`です。 下記の例を参照してください。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>  COleControl::ResetVersion  
 指定した値にバージョン番号を初期化します。  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>パラメーター  
 `dwVersionDefault`  
 コントロールに割り当てられるバージョン番号です。  
  
### <a name="remarks"></a>コメント  
 使用して、コントロールのバイナリの初期化のパフォーマンスを向上できる`ResetVersion`と`ResetStockProps`をオーバーライドする`COleControl::OnResetState`です。 例を参照してください[ResetStockProps](#resetstockprops)です。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
##  <a name="scrollwindow"></a>  COleControl::ScrollWindow  
 画面に、インプレース アクティブ イメージ内の領域をスクロールするウィンドウなしの OLE オブジェクトを許可します。  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>パラメーター  
 `xAmount`  
 デバイス単位では、水平方向のスクロール、金額を指定します。 このパラメーターは、左にスクロールする負の値を指定する必要があります。  
  
 `yAmount`  
 デバイス単位では、垂直方向のスクロール、金額を指定します。 このパラメーターは、上へスクロールする負の値を指定する必要があります。  
  
 `lpRect`  
 指す、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは RECT 構造体を含むウィンドウのクライアント座標で OLE オブジェクトのクライアント領域のスクロールの部分を指定します。 場合`lpRect`は**NULL**、全体の OLE オブジェクトのクライアント領域をスクロールします。  
  
 `lpClipRect`  
 指す、`CRect`オブジェクトまたは`RECT`クリップする四角形を指定します。 四角形の内側 (ピクセル) をスクロールします。 四角形の外側のビットである場合でも、`lpRect`四角形。 場合`lpClipRect`は**NULL**、スクロール四角形の領域は実行されません。  
  
##  <a name="selectfontobject"></a>  COleControl::SelectFontObject  
 デバイス コンテキストにフォントを選択します。  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 デバイス コンテキスト オブジェクトへのポインター。  
  
 `fontHolder`  
 参照、 [CFontHolder](../../mfc/reference/cfontholder-class.md)選択されるフォントを表すオブジェクト。  
  
### <a name="return-value"></a>戻り値  
 以前に選択したフォントへのポインター。 呼び出し元が使用するすべての描画操作を完了すると*fontHolder、*へのパラメーターとして渡すことによって、以前に選択したフォントがもう一度選択する必要があります[cdc::selectobject](../../mfc/reference/cdc-class.md#selectobject)です。  
  
##  <a name="selectstockfont"></a>  COleControl::SelectStockFont  
 デバイス コンテキストにストック フォント プロパティを選択します。  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>パラメーター  
 `pDC`  
 フォントの選択をデバイス コンテキスト。  
  
### <a name="return-value"></a>戻り値  
 以前に選択したへのポインター`CFont`オブジェクト。 使用する必要があります[cdc::selectobject](../../mfc/reference/cdc-class.md#selectobject)が完了したら、デバイス コンテキストに戻すこのフォントを選択します。  
  
##  <a name="serializeextent"></a>  COleControl::SerializeExtent  
 シリアル化またはコントロールに割り当てられた表示領域の状態を初期化します。  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>パラメーター  
 `ar`  
 A`CArchive`またはからにシリアル化するオブジェクト。  
  
### <a name="remarks"></a>コメント  
 使用して、コントロールのバイナリの永続化のパフォーマンスを向上できる`SerializeExtent`、 `SerializeStockProps`、および`SerializeVersion`をオーバーライドする**COleControl::Serialize**です。 下記の例を参照してください。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
### <a name="example"></a>例  
 [!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps  
 シリアル化またはの状態を初期化、`COleControl`ストック プロパティ: 外観、色の BackColor、BorderStyle、キャプション、Enabled、フォント、前景色、およびテキスト。  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>パラメーター  
 `ar`  
 A`CArchive`またはからにシリアル化するオブジェクト。  
  
### <a name="remarks"></a>コメント  
 ストック プロパティの説明は、次を参照してください。 [ActiveX コントロール: ストック プロパティの追加](../../mfc/mfc-activex-controls-adding-stock-properties.md)です。  
  
 使用して、コントロールのバイナリの永続化のパフォーマンスを向上できる`SerializeStockProps`、 `SerializeExtent`、および`SerializeVersion`をオーバーライドする**COleControl::Serialize**です。 例についてにあるコードを参照してください。 [SerializeExtent](#serializeextent)です。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
##  <a name="serializeversion"></a>  COleControl::SerializeVersion  
 シリアル化またはコントロールのバージョン情報の状態を初期化します。  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `ar`  
 A`CArchive`またはからにシリアル化するオブジェクト。  
  
 `dwVersionDefault`  
 コントロールの現在のバージョン番号。  
  
 `bConvert`  
 保存、またはが読み込まれた時と同じ形式で保持されるときに、永続的なデータが最新の形式に変換されるかどうかを示します。  
  
### <a name="return-value"></a>戻り値  
 コントロールのバージョン番号。 指定したアーカイブを読み込む場合`SerializeVersion`アーカイブから読み込まれたバージョンを返します。 それ以外の場合、現在読み込まれているバージョンを返します。  
  
### <a name="remarks"></a>コメント  
 使用して、コントロールのバイナリの永続化のパフォーマンスを向上できる`SerializeVersion`、 `SerializeExtent`、および`SerializeStockProps`をオーバーライドする**COleControl::Serialize**です。 例についてにあるコードを参照してください。 [SerializeExtent](#serializeextent)です。 初期化の最適化の詳細については、次を参照してください。 [ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)です。  
  
##  <a name="setappearance"></a>  COleControl::SetAppearance  
 コントロールの株価の外観プロパティの値を設定します。  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>パラメーター  
 *sAppearance*  
 A**短い**( `VT_I2`) コントロールの外観に使用する値。 ゼロの値は、フラットにコントロールの外観を設定し、値 1 が 3d コントロールの外観を設定します。  
  
### <a name="remarks"></a>コメント  
 ストック プロパティの詳細についてを参照してください。 [ActiveX コントロール: プロパティ](../../mfc/mfc-activex-controls-properties.md)です。  
  
##  <a name="setbackcolor"></a>  COleControl::SetBackColor  
 コントロールの株価 BackColor プロパティの値を設定します。  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>パラメーター  
 *dwBackColor*  
 **OLE_COLOR**については、コントロールの描画に使用する値。  
  
### <a name="remarks"></a>コメント  
 このプロパティおよびその他の使用方法の詳細に関連するプロパティが、記事を参照してください[ActiveX コントロール: プロパティ](../../mfc/mfc-activex-controls-properties.md)です。  
  
##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle  
 コントロールの株価 BorderStyle プロパティの値を設定します。  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>パラメーター  
 *sBorderStyle*  
 新しいコントロールの境界線のスタイル0 境界線なし、1 は通常の境界線を示します。  
  
### <a name="remarks"></a>コメント  
 コントロールのウィンドウが再作成する、および`OnBorderStyleChanged`と呼ばれます。  
  
##  <a name="setcapture"></a>  COleControl::SetCapture  
 コントロールの代理でマウスのキャプチャを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>戻り値  
 ポインター、 **CWnd**マウス入力を既に受信したウィンドウのオブジェクト。  
  
### <a name="remarks"></a>コメント  
 コントロールがアクティブ化およびウィンドウなしの場合は、この関数は、コントロールの代理でマウスのキャプチャを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。 それ以外の場合、この関数は、コントロール自体をマウスのキャプチャを所有している (と同じ`CWnd::SetCapture`)。  
  
##  <a name="setcontrolsize"></a>  COleControl::SetControlSize  
 OLE コントロール ウィンドウのサイズを設定し、コンテナー コントロール サイトが変更されていることを通知します。  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>パラメーター  
 `cx`  
 コントロールの新しい幅をピクセル単位で指定します。  
  
 `cy`  
 コントロールの新しい高さをピクセル単位で指定します。  
  
### <a name="return-value"></a>戻り値  
 呼び出しが成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 この関数は、コントロールのコンス トラクターでは使用できません。  
  
 コントロール ウィンドウのすべての座標は、コントロールの左上隅に対する相対パスに注意してください。  
  
##  <a name="setenabled"></a>  COleControl::SetEnabled  
 株価、コントロールの Enabled プロパティの値を設定します。  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>パラメーター  
 `bEnabled`  
 **TRUE** 、制御する場合はそれ以外の有効な**FALSE**です。  
  
### <a name="remarks"></a>コメント  
 このプロパティを設定したら**OnEnabledChange**と呼びます。  
  
##  <a name="setfocus"></a>  COleControl::SetFocus  
 コントロールの代理で入力フォーカスを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>戻り値  
 ポインター、 **CWnd** 、入力フォーカスを持っていたウィンドウ オブジェクトまたは**NULL**そのようなウィンドウがない場合。  
  
### <a name="remarks"></a>コメント  
 コントロールがアクティブ化およびウィンドウなしの場合は、この関数は、コントロールの代理で、入力フォーカスを所有しているを実行するコントロールのコンテナーのウィンドウをによりします。 入力のフォーカスはキーボード入力が、コンテナーのウィンドウ、およびコンテナーを呼び出す OLE オブジェクトへのすべての後続のキーボード メッセージをディスパッチする`SetFocus`です。 入力フォーカスを持っていた任意のウィンドウでは、それが失われます。  
  
 この関数により、コントロール自体を入力フォーカスを受け取るでコントロールがウィンドウなしでない場合 (同じ`CWnd::SetFocus`)。  
  
##  <a name="setfont"></a>  COleControl::SetFont  
 コントロールのストック フォント プロパティを設定します。  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>パラメーター  
 *pFontDisp*  
 フォントのディスパッチ インターフェイスへのポインター。  
  
##  <a name="setforecolor"></a>  COleControl::SetForeColor  
 コントロールの株価 ForeColor プロパティの値を設定します。  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>パラメーター  
 *dwForeColor*  
 **OLE_COLOR**の前景、コントロールの描画に使用する値。  
  
### <a name="remarks"></a>コメント  
 このプロパティおよびその他の使用方法の詳細に関連するプロパティが、記事を参照してください[ActiveX コントロール: プロパティ](../../mfc/mfc-activex-controls-properties.md)です。  
  
##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats  
 コントロールによってサポートされるデータ形式のリストを初期化するためにフレームワークによって呼び出されます。  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>コメント  
 既定の実装は、次の 2 つの形式を指定します:`CF_METAFILEPICT`し、永続的なプロパティを設定します。  
  
##  <a name="setinitialsize"></a>  COleControl::SetInitialSize  
 コンテナーで最初に表示されるときの OLE コントロールのサイズを設定します。  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>パラメーター  
 `cx`  
 ピクセルでの OLE コントロールの初期の幅。  
  
 `cy`  
 ピクセルでの OLE コントロールの初期の高さ。  
  
### <a name="remarks"></a>コメント  
 コントロールの初期サイズを設定するコンス トラクターでは、この関数を呼び出します。 初期サイズは、デバイス単位、またはピクセル単位で計測されます。 この呼び出しは、コントロールのコンス トラクターで行うことをお勧めします。  
  
##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag  
 コントロールの変更の状態を変更します。  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>パラメーター  
 `bModified`  
 コントロールの新しい値のフラグを変更します。 **TRUE**コントロールの状態が変更されたことを示します**FALSE**コントロールの状態が保存だけであることを示します。  
  
### <a name="remarks"></a>コメント  
 コントロールの永続的な状態の影響を与える場合、変更が発生するたびに、この関数の呼び出しです。 たとえば、永続的なプロパティの値が変更された場合は、この関数を呼び出し、 `bModified` **TRUE**です。  
  
##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted  
 編集要求が失敗したことを示します。  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>コメント  
 この関数を呼び出すときに`BoundPropertyRequestEdit`は失敗します。 この関数は型の例外をスロー **COleDispScodeException**設定操作が許可されていないことを示すためにします。  
  
##  <a name="setnotsupported"></a>  COleControl::SetNotSupported  
 ユーザーがコントロールのプロパティの値を変更しないようにします。  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>コメント  
 コントロールのユーザーがプロパティの値の変更はサポートされていない任意のプロパティの Set 関数の代わりにこの関数を呼び出します。 1 つの例には、プロパティは読み取り専用ですがあります。  
  
##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer  
 デバイス単位で表される、コンテナーを基準として、コントロールの四角形の座標を設定します。  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>パラメーター  
 `lpRect`  
 四角形のコンテナーを基準として、コントロールの新しい座標が含まれているへのポインター。  
  
### <a name="return-value"></a>戻り値  
 呼び出しが成功した場合は 0 以外。それ以外の場合 0 を返します。  
  
### <a name="remarks"></a>コメント  
 コントロールが開いている場合、サイズが変更されます。それ以外の場合、コンテナーの**OnPosRectChanged**関数が呼び出されます。  
  
##  <a name="settext"></a>  COleControl::SetText  
 コントロールのキャプションまたはテキスト ストック プロパティの値を設定します。  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>パラメーター  
 `pszText`  
 文字の文字列へのポインター。  
  
### <a name="remarks"></a>コメント  
 ストックのキャプションとテキストのプロパティがどちらもマップされている同じ値に注意してください。 つまり、いずれかのプロパティに加えられた変更は、両方のプロパティに自動的に変更されます。 一般に、在庫キャプションまたはテキストのプロパティのいずれかが、コントロールをサポートします。  
  
##  <a name="throwerror"></a>  COleControl::ThrowError  
 コントロールでエラーの発生を通知します。  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>パラメーター  
 `sc`  
 報告するステータス コード値。 可能なコードの完全な一覧は、記事を参照してください。 [ActiveX コントロール: 高度なトピック](../../mfc/mfc-activex-controls-advanced-topics.md)です。  
  
 `nDescriptionID`  
 報告する例外の文字列リソース ID。  
  
 `nHelpID`  
 報告されるトピックのヘルプ ID です。  
  
 `pszDescription`  
 報告する例外の説明を含む文字列。  
  
### <a name="remarks"></a>コメント  
 この関数のみから呼び出すことは Get または Set 関数内で OLE プロパティ、または OLE オートメーションのメソッドの実装です。 それ以外の場合に発生するエラーを通知する必要がある場合は、株価エラー イベントを発生させる必要があります。  
  
##  <a name="transformcoords"></a>  COleControl::TransformCoords  
 変換の間で値を調整する**HIMETRIC**ユニットと、コンテナーのネイティブな単位です。  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>パラメーター  
 *lpptlHimetric*  
 ポインター、 **POINTL**の座標を含む構造体**HIMETRIC**単位です。  
  
 *lpptfContainer*  
 ポインター、 **POINTF**コンテナーのユニットのサイズの座標を含む構造体。  
  
 `flags`  
 次の値の組み合わせです。  
  
- **XFORMCOORDS_POSITION**コンテナー内の位置。  
  
- **XFORMCOORDS_SIZE**コンテナーのサイズ。  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER**変換**HIMETRIC**ユニットまで、コンテナーの単位。  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** Transform the container's units to **HIMETRIC** units.  
  
### <a name="remarks"></a>コメント  
 最初の 2 つのフラグ、 **XFORMCOORDS_POSITION**と**XFORMCOORDS_SIZE**座標が、位置またはサイズとして扱われるかどうか。 残りの 2 つのフラグは、変換の方向を示します。  
  
##  <a name="translatecolor"></a>  COleControl::TranslateColor  
 色の値を変換、 **OLE_COLOR**のデータ型、 [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)データ型。  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>パラメーター  
 `clrColor`  
 A **OLE_COLOR**データ型。 詳細については、Windows を参照してください。 [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353)関数。  
  
 `hpal`  
 オプションのパレット; へのハンドル指定できます**NULL**です。  
  
### <a name="return-value"></a>戻り値  
 32 ビット色の RGB (赤、緑、青) 値、純色を定義するに最も近い色、`clrColor`デバイスを表すことができます。  
  
### <a name="remarks"></a>コメント  
 この関数は、株価前景色と背景色のプロパティを変換すると便利**COLORREF**によって使用される型[CDC](../../mfc/reference/cdc-class.md)メンバー関数。  
  
##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad  
 コントロールは、その後、永続的な状態から読み込まれるとき、ソース ファイルを既定値としてのアンビエント プロパティの値を使用するかどうかによって決まります。  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>戻り値  
 0 以外を返します、アンビエント プロパティが有効になります。それ以外の場合のアンビエント プロパティは無効になります。  
  
### <a name="remarks"></a>コメント  
 一部のコンテナーで、コントロールがないアンビエント プロパティへのアクセスのオーバーライドの最初の呼び出し中に`COleControl::DoPropExchange`です。 これは、ような場合は、コンテナーを呼び出す[IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730)または[機能として](http://msdn.microsoft.com/library/windows/desktop/ms680557)呼び出しの前に[IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (つまり、そうでない場合優先、 **OLEMISC_SETCLIENTSITEFIRST**ステータス ビット)。  
  
##  <a name="windowproc"></a>  COleControl::WindowProc  
 Windows 手順を説明する`COleControl`オブジェクト。  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>パラメーター  
 `message`  
 処理する Windows メッセージを指定します。  
  
 `wParam`  
 メッセージの処理で使用される追加情報を提供します。 パラメーターの値は、メッセージに依存します。  
  
 `lParam`  
 メッセージの処理で使用される追加情報を提供します。 パラメーターの値は、メッセージに依存します。  
  
### <a name="return-value"></a>戻り値  
 ディスパッチされたメッセージの戻り値。  
  
### <a name="remarks"></a>コメント  
 コントロールのメッセージ マップを通じて特定のメッセージをディスパッチするためには、この関数を呼び出します。  
  
## <a name="see-also"></a>関連項目  
 [MFC サンプル CIRC3](../../visual-cpp-samples.md)   
 [MFC サンプル TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage クラス](../../mfc/reference/colepropertypage-class.md)   
 [CWnd クラス](../../mfc/reference/cwnd-class.md)   
 [階層図](../../mfc/hierarchy-chart.md)   
 [CFontHolder クラス](../../mfc/reference/cfontholder-class.md)   
 [CPictureHolder クラス](../../mfc/reference/cpictureholder-class.md)
