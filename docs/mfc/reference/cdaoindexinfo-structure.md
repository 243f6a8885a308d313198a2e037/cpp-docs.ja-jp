---
title: "CDaoIndexInfo 構造体 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "CDaoIndexInfo"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "CDaoIndexInfo 構造体"
  - "DAO (データ アクセス オブジェクト), Indexes コレクション"
ms.assetid: 251d8285-78ce-4716-a0b3-ccc3395fc437
caps.latest.revision: 13
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 14
---
# CDaoIndexInfo 構造体
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

`CDaoIndexInfo` 構造体は、データ アクセス オブジェクト \(DAO\) に対して定義されているインデックス オブジェクトに関する情報が含まれます。  
  
## 構文  
  
```  
  
      struct CDaoIndexInfo {  
   CDaoIndexInfo( );                   // Constructor  
   CString m_strName;                  // Primary  
   CDaoIndexFieldInfo* m_pFieldInfos;  // Primary  
   short m_nFields;                    // Primary  
   BOOL m_bPrimary;                    // Secondary  
   BOOL m_bUnique;                     // Secondary  
   BOOL m_bClustered;                  // Secondary  
   BOOL m_bIgnoreNulls;                // Secondary  
   BOOL m_bRequired;                   // Secondary  
   BOOL m_bForeign;                    // Secondary  
   long m_lDistinctCount;              // All  
  
   // Below the // Implementation comment:  
   // Destructor, not otherwise documented  
};   
```  
  
#### パラメーター  
 `m_strName`  
 一意にフィールド オブジェクトを指定します。  詳細については、" DAO ヘルプの「名前プロパティ」を参照してください。  
  
 `m_pFieldInfos`  
 [CDaoIndexFieldInfo](../Topic/CDaoIndexFieldInfo%20Structure.md) の配列へのポインターがインデックスのキー フィールドは、テーブル定義またはレコードセット フィールドであるオブジェクトを示しています。  各オブジェクトは、インデックスの 1 フィールドを識別します。  既定のインデックスの順序は昇順です。  インデックス オブジェクトは、各レコードのキー インデックスを表す一つ以上のフィールドを持つことができます。  これらは昇順または子、または組み合わせのいずれでもかまいません。  
  
 `m_nFields`  
 `m_pFieldInfos`に格納されるフィールドの数。  
  
 *m\_bPrimary*  
 プライマリ プロパティが **TRUE**インデックスの場合、オブジェクトはプライマリ インデックスを表します。  プライマリ インデックスは定義済みのな順序でテーブル内のすべてのレコードを指定する一つ以上のフィールドで構成されます。  インデックス フィールドが一意である必要があるため、インデックス オブジェクトのプロパティは、DAO の **TRUE** に設定されます。  プライマリ インデックスが複数のフィールドで構成されている場合は、各フィールドに重複する値を指定するすべてのインデックス フィールドの値の組み合わせは一意である必要があります。  プライマリ インデックスはテーブルのキーで構成され、通常は主キーと同じフィールドがあります。  
  
 テーブルの主キーを設定すると、主キーは、テーブルのプライマリ インデックスが自動的に定義されます。  詳細については、DAO ヘルプの「プライマリ プロパティ」および「固有のプロパティ」を参照します。  
  
> [!NOTE]
>  、最大で、テーブルに 1 個のプライマリ インデックスがあります。  
  
 *m\_bUnique*  
 インデックス オブジェクトがテーブルの一意のインデックスを表すかどうかを示します。  このプロパティが **TRUE**オブジェクトの場合、インデックスは、一意なインデックスを表します。  一意のインデックスは論理的に固有であり、定義済みのな順序でテーブルの全レコードを配置する一つ以上のフィールドで構成されます。  インデックスが 1 フィールドで構成されている場合は、そのフィールドの値はテーブル全体で一意である必要があります。  インデックスが複数のフィールドで構成されている場合は、各フィールドに重複する値を指定するすべてのインデックス フィールドの値の組み合わせは一意である必要があります。  
  
 オブジェクトの一意のインデックスとプライマリ プロパティが **TRUE**に設定されている場合、インデックスは、一意なです: これは定義済みののテーブル、論理考えられるすべてのレコードを一意に識別します。  プライマリ プロパティが **FALSE**に設定されている場合、インデックスは、セカンダリ インデックスです。  セカンダリ インデックスは、テーブルのレコードの ID として動作する \(キーと nonkey 両方\) を論理的に定義済みのな順序でレコードを配置します。  
  
 詳細については、DAO ヘルプの「プライマリ プロパティ」および「固有のプロパティ」を参照します。  
  
 *m\_bClustered*  
 インデックス オブジェクトがテーブルのクラスター化インデックスを表すかどうかを示します。  このプロパティが **TRUE**オブジェクトの場合、インデックスは、クラスター化インデックスを表します; それ以外の場合は。  クラスター化インデックスは、定義済みのな順序でテーブル内のすべてのレコードが並べ替えられ、同時に実行される一つ以上の nonkey フィールドで構成されます。  クラスター化インデックスでは、テーブル内のデータは、クラスター化インデックスで指定されている順序で正確に格納されます。  クラスター化インデックスでは、テーブルのレコードに対する効率的なアクセスを提供します。  詳細については、DAO ヘルプの「クラスター プロパティ」を参照します。  
  
> [!NOTE]
>  クラスターのプロパティは Microsoft Jet データベース エンジンを使用するデータベースに Jet データベース エンジンがクラスター化インデックスをサポートしないため、無視されます。  
  
 *m\_bIgnoreNulls*  
 インデックス フィールドに null 値を持つレコードのインデックス エントリが存在するかどうかを示します。  このプロパティが null の場合、**TRUE**値フィールドにインデックス エントリがありません。  レコードのフィールドを使用してすばやく検索を実行するには、フィールドのインデックスを定義できます。  インデックス フィールドの null のエントリを許可し、null とエントリの多くは期待したインデックスが使用する記憶領域の量を単純化するに **TRUE** へのインデックス オブジェクトの IgnoreNulls のプロパティを設定できます。  次の表に示すように null のインデックス値を持つレコードにインデックス エントリがあるかどうかを同時に設定する IgnoreNulls プロパティの設定および必須プロパティを使用します。  
  
|IgnoreNulls|必須かどうか|インデックス フィールドの空白|  
|-----------------|------------|---------------------|  
|True|False|許可される NULL 値; 追加するインデックス エントリを持たない。|  
|False|False|許可される NULL 値; 追加するインデックス エントリ。|  
|True または False|True|許可されない null 値; 追加するインデックス エントリを持たない。|  
  
 詳細については、DAO ヘルプの「IgnoreNulls プロパティ」参照します。  
  
 `m_bRequired`  
 DAO のインデックス オブジェクトが null 以外の値を必要とするかどうかを示します。  このプロパティが **TRUE**インデックスの場合、オブジェクトは null 値は使用できません。  詳細については、DAO ヘルプの「必須プロパティ」を参照します。  
  
> [!TIP]
>  DAO のインデックス オブジェクトまたはフィールド オブジェクトのこのプロパティ \(テーブル定義、レコードセット、またはクエリ定義オブジェクトに含まれる\) を設定するときに、オブジェクトのフィールドに設定します。  インデックス オブジェクトのフィールド オブジェクトのプロパティ設定の有効性は前にチェックされます。  
  
 *m\_bForeign*  
 インデックス オブジェクトがテーブルの外部キーを表すかどうかを示します。  このプロパティが **TRUE**の場合、インデックスは、テーブルの外部キーを表します。  外部キーは主テーブルの行を識別する外部キー テーブルの一つ以上のフィールドで構成されます。  Microsoft Jet データベース エンジンでは、参照整合性を適用するリレーションシップを作成するとき外部キー テーブルのインデックス オブジェクトを作成し、外部のプロパティを設定します。  詳細については、DAO ヘルプの「外部のプロパティ」を参照します。  
  
 *m\_lDistinctCount*  
 関連テーブルに含まれているインデックス オブジェクトの一意の値の数を示します。  インデックスの値は、キーの数を調べるに DistinctCount のプロパティを確認します。  インデックスが重複する値を有効にすると、値が複数回表示される場合もありますが、どのキーが一度だけカウントされます。  この情報は、インデックス情報を評価することにより、データ アクセスを最適化しようとしたアプリケーションで役立ちます。  一意の値の数が、インデックス オブジェクトのエイリアス基数です。  DistinctCount のプロパティはキーの実際の数を常に特定の時刻に反映されません。  たとえば、トランザクションをロールバックによって発生した DistinctCount のプロパティの変更がすぐに反映されません。  詳細については、DAO ヘルプの「DistinctCount プロパティ」参照します。  
  
## 解説  
 主要な、セカンダリへの参照は、上記のすべての情報をクラス [CDaoTableDef](../Topic/CDaoTableDef::GetIndexInfo.md) と [CDaoRecordset](../Topic/CDaoRecordset::GetIndexInfo.md)の `GetIndexInfo` メンバー関数によってどのように返されるかを示します。  
  
 インデックス オブジェクトは MFC クラスでは表示されません。  代わりに、クラス [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md) または [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) の MFC オブジェクトの下にある DAO オブジェクトというインデックス オブジェクトのコレクションをインデックスのコレクションが含まれます。  これらのクラスは、インデックス情報のアクセス、個々の項目に提供するメンバー関数、または `CDaoIndexInfo` オブジェクトとコンテナー オブジェクトの `GetIndexInfo` のメンバー関数を呼び出して、それらに一度にアクセスできます。  
  
 `CDaoIndexInfo` に コンストラクターと正しく `m_pFieldInfos`のインデックス フィールド情報を割り当ておよび解放するためにデストラクターが存在する。  
  
 テーブル定義オブジェクトの `GetIndexInfo` のメンバー関数によって取得される情報は `CDaoIndexInfo` 構造に格納されます。  インデックスのコレクションのインデックス オブジェクトが格納されている含むテーブル定義オブジェクトの `GetIndexInfo` メンバー関数を呼び出します。  `CDaoIndexInfo` は、デバッグ ビルドの `Dump` のメンバー関数を定義します。  `CDaoIndexInfo` オブジェクトの内容をダンプするために `Dump` を使用できます。  
  
## 必要条件  
 **ヘッダー:** afxdao.h  
  
## 参照  
 [構造体、スタイル、コールバック関数とメッセージ マップ](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)   
 [CDaoTableDef::GetIndexInfo](../Topic/CDaoTableDef::GetIndexInfo.md)