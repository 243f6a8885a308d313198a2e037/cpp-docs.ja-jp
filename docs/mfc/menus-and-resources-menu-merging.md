---
title: "メニューとリソース : メニューの結合 | Microsoft Docs"
ms.custom: ""
ms.date: "12/14/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "座標 (メニュー構成)"
  - "メニュー [C++], OLE ドキュメント アプリケーション"
  - "マージ (ツール バーとステータス バーを)"
  - "OLE コンテナー, メニューとリソース"
  - "ステータス バー, OLE ドキュメント アプリケーション"
  - "ツール バー [C++], OLE ドキュメント アプリケーション"
  - "ビジュアル編集, アプリケーションのメニューとリソース"
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
caps.latest.revision: 9
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# メニューとリソース : メニューの結合
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

ここでは、OLE ドキュメントのアプリケーションがビジュアル編集、埋め込み先編集の有効化を適切に処理するために必要な手順を詳しく説明します。  埋め込み先編集の有効化はコンテナーとサーバーの両方 \(コンポーネント\) アプリケーションの困難になる可能性があります。  ユーザーは同じフレーム ウィンドウに \(コンテナー ドキュメントにおける\) 残りましたりが実際に別のアプリケーション \(サーバー\) を実行します。  これはコンテナーのリソースとサーバー アプリケーション間の調整が必要です。  
  
 この記事で説明されているトピックは次のとおりです。:  
  
-   [レイアウト メニュー](#_core_menu_layouts)  
  
-   [ツール バーとステータス バー](#_core_toolbars_and_status_bars)  
  
##  <a name="_core_menu_layouts"></a> レイアウト メニュー  
 まず、レイアウト メニューを調整します。  詳細については、[!INCLUDE[winSDK](../atl/includes/winsdk_md.md)]の [メニュー プログラミングに関する考慮事項](https://msdn.microsoft.com/en-us/library/ms647557.aspx) の **Menu Creation** セクションを参照します。  
  
 コンテナー アプリケーションは埋め込まれたアイテムをアクティブにする場合に使用する新しいメニューを作成する必要があります。  少なくとも、このメニューに示されている順序で次の、構成する必要があります:  
  
1.  ファイルを開くときに使用されるものと同じのファイル メニュー。\(通常は他のメニュー項目は、次の項目の前に配置されません。  
  
2.  2 個の連続する区切り記号。  
  
3.  ファイルを開くときに使用されるものと同じウィンドウ メニュー \(のみ MDI アプリケーション コンテナー アプリケーション\)。  アプリケーションによっては埋め込まれたアイテムがアクティブ化されたときに、メニューに残り、このグループに属する他のメニューが、オプション メニューなどの場合があります。  
  
    > [!NOTE]
    >  コンテナー ドキュメントのビューに影響するズームなどのメニューを持つ場合があります。  これらのコンテナーのメニューには、メニュー リソースの 2 種類の区切り記号の間に表示されます。  
  
 サーバー コンポーネント \(\) アプリケーションでは、埋め込み先編集の有効化の新しいメニューを作成する必要があります。  これはなしでファイルが開かれているが、データではなくサーバー ドキュメントを処理するファイル、ウィンドウなどのメニュー項目、ように使用されるメニューのようになります。  通常、このメニューには、次の要素から構成されます。:  
  
1.  ファイルを開くときに使用されるものと同じのメニューを編集します。  
  
2.  区切り線  
  
3.  オブジェクト、Scribble サンプル アプリケーションのペン メニューなどのメニューを編集します。  
  
4.  区切り線  
  
5.  ヘルプ メニュー。  
  
 例については、コンテナーとサーバーを持つサンプル埋め込み先編集用メニューのレイアウトを確認します。  各メニュー項目の詳細は、この例のさらに明確にするために、削除されました。  コンテナーの埋め込み先編集用メニューに次のエントリがあります:  
  
```  
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE   
BEGIN  
    POPUP "&File C1"  
    MENUITEM SEPARATOR  
    POPUP "&Zoom C2"  
    MENUITEM SEPARATOR  
    POPUP "&Options C3"  
    POPUP "&Window C3"  
END  
```  
  
 連続する区切り記号はサーバーのメニューの最初の部分が完了する必要があるかを示します。  これで、サーバーの埋め込み先編集用メニューを表示する:  
  
```  
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE   
BEGIN  
    POPUP "&Edit S1"  
    MENUITEM SEPARATOR  
    POPUP "&Format S2"  
    MENUITEM SEPARATOR  
    POPUP "&Help S3"  
END  
```  
  
 ここでは、区切り記号はコンテナーのメニュー項目の 2 番目のグループ先必要があるかを示します。  このサーバーからオブジェクトがこのようにこのコンテナーの内のアクティブな設定されるときに表示されるメニュー構造:  
  
```  
BEGIN  
    POPUP "&File C1"  
    POPUP "&Edit S1"  
    POPUP "&Zoom C2"  
    POPUP "&Format S2"  
    POPUP "&Options C3  
    POPUP "&Window C3"  
    POPUP "&Help S3"  
END  
```  
  
 参照できるように区切り記号は、各アプリケーションのメニューのグループに置き換えられました。  
  
 埋め込み先編集用メニューに関連付けられているアクセラレータ テーブルは、サーバー アプリケーションが指定されます。  コンテナーは独自のアクセラレータ テーブルに取り込みます。  
  
 埋め込まれたアイテムをアクティブにすると、フレームワークは埋め込み先編集用メニューを読み込みます。  これは、埋め込み先編集の有効化、および区切り記号の位置にメニューのサーバー アプリケーションに要求し、挿入します。  これは、メニューを結合できます。  ファイルとウィンドウの配置をアクティブ化するためのコンテナーからメニューを取得し、項目のアクティブ化のサーバーからメニューを取得します。  
  
##  <a name="_core_toolbars_and_status_bars"></a> ツール バーとステータス バー  
 サーバー アプリケーションでは、新しいツール バーを作成し、別のファイルにビットマップを保存する必要があります。  アプリケーション wizard–generated アプリケーションは ITOOLBAR.BMP というファイルにこのビットマップを保存します。  新しいツール バー、サーバー上の項目を操作する関数は、通常のツール バーと同じ項目を含めるファイル、ウィンドウ メニュー内の項目を表すアイコンを削除すると、コンテナー アプリケーション ツール バーです。  
  
 このツール バーは `COleIPFrameWnd`\-アプリケーション ウィザードが作成した派生クラスで読み込まれます。  ステータス バーは、コンテナー アプリケーションによって処理されます。  埋め込み先フレーム ウィンドウの実装の詳細については、「[サーバー: サーバーの実装](../mfc/servers-implementing-a-server.md)」を参照してください。  
  
## 参照  
 [メニューとリソース \(OLE\)](../mfc/menus-and-resources-ole.md)   
 [アクティベーション](../mfc/activation-cpp.md)   
 [サーバー](../mfc/servers.md)   
 [コンテナー](../mfc/containers.md)