---
title: "登録 | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "初期化 (サーバーを)"
  - "インストール (サーバーを)"
  - "OLE サーバー アプリケーション, 登録 (サーバーを)"
  - "OLE, 登録"
  - "登録情報データベース"
  - "レジストリ, OLE アイテムのデータベース"
  - "サーバー, 初期化"
  - "サーバー, インストール"
ms.assetid: 991d5684-72c1-4f9e-a09a-9184ed12bbb9
caps.latest.revision: 9
caps.handback.revision: 5
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# 登録
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

ユーザーがアプリケーションに OLE アイテムを挿入する場合、OLE 提供から選択するオブジェクト型のリスト。  すべての OLE サーバー アプリケーションによって提供される情報を含むシステム登録データベースからこの一覧を取得します。  サーバーを登録すると、システム登録データベース \(レジストリ\) に指定するオブジェクト、他の情報内のそれ自体にファイル拡張子とパスの各型は、送信するエントリを指定する。  
  
 フレームワークと OLE システム Dynamic\-Link Library \(DLL\) にどのような OLE アイテムがシステムで使用できることを確認するためにこのレジストリを使用します。  リンクされたや埋め込みオブジェクトがアクティブ化されたときに、OLE システム DLL も確認するには、このレジストリをサーバー アプリケーションを起動する方法を指定します。  
  
 ここでは、インストールされ、通常実行される場合、各サーバー アプリケーションの必要があるものを記述します。  
  
 それを更新するために使用される .reg ファイル システム登録データベースと形式の詳細については、*OLE Programmer's Reference "を*参照してください。  
  
##  <a name="_core_server_installation"></a> Server Installation  
 まず、サーバー アプリケーションをインストールすると、サポートする OLE 項目のすべての種類を登録します。  スタンドアロン アプリケーションとして実行するたびに、サーバーをシステム登録データベースを更新してできます。  これにより、サーバーの実行可能ファイルが移動されて登録データベースを最新の状態に維持します。  
  
> [!NOTE]
>  アプリケーション ウィザードで生成された MFC アプリケーションが自動的にスタンドアロン アプリケーションとして実行時に自動的に登録されます。  
  
 インストール時にアプリケーションを登録する場合は、RegEdit.exe プログラムを使用します。\(Windows 95、Windows 98、および Windows Me には、RegEdit Windows ディレクトリにあります。  Windows NT と Windows 2000 では、RegEdit は Windows System32 ディレクトリにあります\)。アプリケーションのセットアップ プログラムが含まれている場合は、セットアップ プログラムによって実行する「RegEdit \/S *appname.reg*」がある。\(\/S フラグはサイレント操作です。つまり、コマンドのダイアログ ボックスのレポートが正常に完了した場合は表示されません。そうしないと、ユーザーが RegEdit を手動で実行するように指示します。  
  
> [!NOTE]
>  アプリケーション ウィザードで作成される .reg ファイルは、実行可能ファイルの絶対パスは含まれません。  インストール プログラムは絶対パスが実行可能ファイルに含めるか、またはインストール ディレクトリが含まれるように PATH 環境変数を変更する .reg ファイルを変更する必要があります。  
  
 RegEdit は登録データベースに .reg のテキスト ファイルの内容をマージします。  データベースを確認または修正するには、レジストリ エディターを使用します。  必要な OLE エントリを削除しないように注意してください。\(Windows 95、Windows 98、および Windows Me には、レジストリ エディター RegEdit.exe です。  Windows NT と Windows 2000 では、RegEdit32.exe です\)。  
  
##  <a name="_core_server_initialization"></a> サーバー初期化  
 アプリケーション ウィザードを使ってサーバー アプリケーションを作成するときに、ウィザードによってすべての初期化タスクを自動的に実行されます。  ここでは、サーバー アプリケーションを手動で作成する必要があるかについて説明します。  
  
 サーバー アプリケーションがコンテナー アプリケーションが起動すると、OLE システム DLL はサーバーのコマンド ラインでは「\/Embedding」オプションを追加します。  サーバー アプリケーションの動作は実行をである「\/Embedding」のチェックや「始めるコンテナーによって起動されるため、まず、アプリケーション\-」コマンド ライン オプションを埋め込むことを行う必要があるかどうかによって異なります。  このスイッチは、開くとしてサーバーをリソースのセットを読み込みま埋め込み先編集表示または完全に。  詳細については、「[メニューとリソース: サーバーの追加](../mfc/menus-and-resources-server-additions.md)」を参照してください。  
  
 サーバー アプリケーションは、コマンド ラインを解析する `CWinApp::RunEmbedded` 関数を呼び出す必要があります。  これは 0 以外の値を返した場合、アプリケーションはスタンドアロン アプリケーションとしてコンテナー アプリケーションから実行されたため、ウィンドウは、存在しないようにしてください。  この関数は、システム登録データベース サーバーのエントリを更新し、インスタンスを登録するための `RegisterAll` メンバー関数を呼び出します。  
  
 サーバー アプリケーションが起動されたときに、インスタンスの登録を実行できることを確認する必要があります。  インスタンスの登録には、サーバーがアクティブ、コンテナーから要求を受け取る準備ができたら、OLE システム DLL を通知します。  これは登録データベースにエントリを追加します。  `ConnectTemplate` メンバー関数を `COleTemplateServer`によって定義された呼び出してサーバー インスタンスの登録を実行します。  これは `COleTemplateServer` オブジェクトへの `CDocTemplate` オブジェクトを接続します。  
  
 `ConnectTemplate` 関数は 3 個のパラメーターを受け取ります。: `CDocTemplate` オブジェクトへのサーバーの **CLSID**、ポインター、およびサーバーが複数のインスタンスをサポートするかどうかを示すフラグ。  ミニサーバーは複数のインスタンスをサポートする必要があります。つまり、同時に実行すると、各コンテナーにつき 1 サーバーの複数のインスタンスが可能である必要があります。  その結果ミニサーバーを起動するときに、このフラグのパス **TRUE**。  
  
 ミニサーバーを作成する場合は、本質的には、コンテナーによって常に起動します。  、「\/Embedding」オプションを確認するようにコマンド ラインを解析する必要があります。  コマンド ラインでこのオプションがない場合は、ユーザーがスタンドアロン アプリケーションとしてミニサーバーの起動としたことを意味します。  この場合、システム登録データベースがインストールされたサーバーを登録し、コンテナー アプリケーションのミニサーバーを起動するようにユーザーに通知メッセージ ボックスを表示します。  
  
## 参照  
 [OLE](../mfc/ole-in-mfc.md)   
 [サーバー](../mfc/servers.md)   
 [CWinApp::RunAutomated](../Topic/CWinApp::RunAutomated.md)   
 [CWinApp::RunEmbedded](../Topic/CWinApp::RunEmbedded.md)   
 [COleTemplateServer クラス](../mfc/reference/coletemplateserver-class.md)