---
title: "コンテナー : 高度な機能 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "コンテナー/サーバー アプリケーション [C++]"
  - "コンテナー [C++], 高度な機能"
  - "コンテナー [C++], コンテナー アプリケーション"
  - "コンテナー [C++], リンク (OLE 埋め込みオブジェクトに)"
  - "埋め込みオブジェクト [C++]"
  - "リンク [C++], 埋め込み OLE オブジェクトへの"
  - "OLE コンテナー, 高度な機能"
  - "OLE コントロール, コンテナー"
  - "サーバー/コンテナー アプリケーション"
ms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8
caps.latest.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 6
---
# コンテナー : 高度な機能
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

ここでは、既存のコンテナー アプリケーションに省略可能な高度な機能を組み込むために必要な手順について説明します。  これらの機能は次のとおりです。:  
  
-   [コンテナーとサーバーの両方のアプリケーション](#_core_creating_a_container.2f.server_application)  
  
-   [OLE 埋め込みオブジェクトへのリンク](#_core_links_to_embedded_objects)  
  
##  <a name="_core_creating_a_container.2f.server_application"></a> コンテナーとサーバー アプリケーションの作成  
 コンテナーとサーバー アプリケーションはコンテナーとサーバーの両方として機能するアプリケーションです。  Windows の Microsoft Word は、この一例です。  他のアプリケーションで Windows のドキュメントの単語を埋め込み、Windows のドキュメントの Word で項目を埋め込むことができます。  完全なコンテナーとサーバーの両方の組み合わせ \(コンテナー\/ミニサーバーのアプリケーションを作成することはできません\) となるコンテナー アプリケーションを変更する処理は、フル サーバーを作成するプロセスに似ています。  
  
 記事 [サーバー: サーバーの実装](../mfc/servers-implementing-a-server.md) はアプリケーション サーバーを実装するために必要な多数のタスクを一覧表示します。  コンテナーにコンテナー アプリケーションとサーバー アプリケーションを変換する場合は、同じタスクを実行する必要があり、コードをコンテナーに追加します。  次に考慮するために重要なことをリストします:  
  
-   アプリケーション ウィザードで作成されるコンテナー コードは既に OLE サブシステムを初期化します。  このサポートのあらゆる変更または追加する必要はありません。  
  
-   常にドキュメント クラスの基本クラスが `COleServerDoc`に `COleDocument`、変更する基本クラスです。  
  
-   サーバー自体が編集に使用されているのに項目を編集できるように `COleClientItem::CanActivate` をオーバーライドします。  
  
     たとえば、MFC のサンプル [OCLIENT](../top/visual-cpp-samples.md) は OLE コンテナーとサーバー アプリケーションで作成した項目が埋め込まれています。  OCLIENT アプリケーションを開き、埋め込み先アイテムをコンテナーとサーバー アプリケーションで作成した編集します。  アプリケーションで項目を編集している間は、MFC サンプルの OLE [HIERSVR](../top/visual-cpp-samples.md)によって作成される項目を埋め込むことを決定します。  これを行うには、埋め込み先編集の有効化を使用できません。  完全にこの項目をアクティブにするために HIERSVR を開く必要があります。  Microsoft Foundation Class ライブラリがこの OLE 機能をサポートしていないため、`COleClientItem::CanActivate` をオーバーライドすると、この状況がチェックされ、アプリケーションの可能なランタイム エラーの発生を防ぐことができます。  
  
 新しいアプリケーションを作成して、コンテナーとサーバー アプリケーションとして機能する場合は、アプリケーション ウィザードやこのサポートの OLE オプション ダイアログ ボックスのオプションが自動的に作成されることを選択します。  詳細については、記事 [概要: ActiveX コントロール コンテナーの作成](../mfc/reference/creating-an-mfc-activex-control-container.md)を参照します。  MFC のサンプルについては、" MFC Samples "を参照してください。  
  
 それ自体に MDI アプリケーションを挿入できないことに注意してください。  コンテナーとサーバーのアプリケーションは、それ自体には、SDI アプリケーションである挿入できません。  
  
##  <a name="_core_links_to_embedded_objects"></a> 埋め込みオブジェクトへのリンク  
 埋め込みオブジェクトへのリンクは、コンテナー アプリケーション内の埋め込みオブジェクトに OLE リンクとドキュメントを作成するには、有効なユーザーを提供します。  たとえば、埋め込まれたなスプレッドシートを含むワード プロセッサでドキュメントを作成します。  アプリケーションのサポートに埋め込みオブジェクトにリンクする場合は、ワード プロセッサのドキュメントに含まれるスプレッドシートにリンクを貼り付けることができます。  この機能は、アプリケーションがワード プロセッサを最初に描画を取得した文字列でスプレッドシートに含まれる情報を使用できるようになります。  
  
#### アプリケーションの埋め込みオブジェクトにリンクするには  
  
1.  `COleDocument`の代わりに `COleLinkingDoc` ドキュメントからクラスを派生してください。  
  
2.  OLE 開発ツールに含まれるクラス ID のジェネレーターを使用してアプリケーションの OLE クラス ID \(**CLSID**\) を作成します。  
  
3.  OLE アプリケーションを登録します。  
  
4.  アプリケーション クラスのメンバーとして `COleTemplateServer` オブジェクトを作成します。  
  
5.  アプリケーション クラスの `InitInstance` のメンバー関数では、次の手順を実行します。:  
  
    -   オブジェクトの `ConnectTemplate` のメンバー関数を呼び出すことによって、ドキュメント テンプレートへの `COleTemplateServer` オブジェクトを追加します。  
  
    -   OLE システムのすべてのクラス オブジェクトを登録するために **COleTemplateServer::RegisterAll** メンバー関数を呼び出します。  
  
    -   `COleTemplateServer::UpdateRegistry` を呼び出します。  `UpdateRegistry` の唯一のパラメーターは、アプリケーションが「\/Embedded」 `OAT_CONTAINER` スイッチで起動する必要があります。  これは、埋め込みオブジェクトにリンクするコンテナーとしてアプリケーションを登録します。  
  
         アプリケーションを「\/Embedded」スイッチによって起動される場合、サーバー アプリケーションと同様のメイン ウィンドウを示す必要があります。  
  
 MFC の OLE [OCLIENT](../top/visual-cpp-samples.md) サンプルでは、この機能を実装します。  例については、これがどのようにするか、このサンプル アプリケーションで OCLIENT.CPP ファイルの `InitInstance` 関数を参照してください。  
  
## 参照  
 [コンテナー](../mfc/containers.md)   
 [サーバー](../mfc/servers.md)