---
title: "メニューとリソース : サーバーの変更点 | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "IDP_OLE_INIT_FAILED"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "アクセラレータ テーブル [C++], サーバー アプリケーション"
  - "IDP_OLE_INIT_FAILED マクロ"
  - "OLE の初期化の失敗"
  - "OLE サーバー アプリケーション, メニューとリソース"
  - "OLE ビジュアル編集サーバー"
  - "リソース [MFC], サーバー アプリケーション"
  - "サーバー アプリケーション, アクセラレータ テーブル"
  - "サーバー アプリケーション, OLE のメニューとリソース"
  - "サーバー, メニューの追加"
  - "文字列編集, ビジュアル編集アプリケーション"
  - "ストリング テーブル, ビジュアル編集アプリケーション"
  - "ビジュアル編集, アプリケーションのメニューとリソース"
ms.assetid: 56ce9e8d-8f41-4db8-8dee-e8b0702d057c
caps.latest.revision: 11
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# メニューとリソース : サーバーの変更点
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

ここでは、ビジュアル編集サーバー \(コンポーネント\) アプリケーションのメニューやそのほかのリソースに加える必要がある変更を示しています。  サーバー アプリケーションでは、メニュー構造などのリソースには、3 種類のモードの 1 つがで起動できるため、多くの追加が必要です: スタンドアロンの、埋め込まれた。  [メニューとリソース \(OLE\)](../mfc/menus-and-resources-ole.md) のトピックで説明されているように、最大 4 組のメニューがあります。  4 はすべて MDI フル サーバー アプリケーションで 3 つのみがミニサーバーで使用され、使用されます。  アプリケーション ウィザードでは、あるサーバーの種類に必要なレイアウト メニューを作成します。  カスタマイズに必要になることもあります。  
  
 アプリケーション ウィザードを使用しない場合は、これらの変更がどのように実装されるかを参照する、HIERSVR.RC の MFC サンプル アプリケーション [HIERSVR](../top/visual-cpp-samples.md)のリソース スクリプトを表示することもできます。  
  
 この記事で説明されているトピックは次のとおりです。:  
  
-   [メニュー追加サーバー](#_core_server_menu_additions)  
  
-   [アクセラレータ テーブルの追加](#_core_server_application_accelerator_table_additions)  
  
-   [ストリング テーブルの追加](../mfc/menus-and-resources-container-additions.md)  
  
-   [ミニサーバーの追加](#_core_mini.2d.server_additions)  
  
##  <a name="_core_server_menu_additions"></a> メニュー追加サーバー  
 サーバー コンポーネント \(\) アプリケーションで OLE ビジュアル編集をサポートするために追加されたメニュー リソースが必要です。  アプリケーションが独立モードで実行するときに使用されるメニューはアプリケーションをビルドする前に、2 種類の新しいメニュー リソースを追加する:変更する必要はありません。完全に開いているサーバーをサポートするために、埋め込み先編集の有効化をサポートする 1 および 1。  メニュー リソースが両方とも全体とミニサーバー アプリケーションによって使用されます。  
  
-   埋め込み先編集の有効化をサポートするには、メニュー リソースを作成する必要があります独立モードで実行するときに使用されるメニュー リソースによく似ています。  このメニューの違いがアプリケーションを処理するファイルとウィンドウ項目 \(および他のメニュー項目が、データ\) 発生していることが考えられます。  コンテナー アプリケーションはこれらのメニュー項目を指定します。  詳細について、の例は、このメニューのマージ方法、技術情報 [メニューとリソース: メニューのマージ](../mfc/menus-and-resources-menu-merging.md)を参照します。  
  
-   独立して動作します。このため、方式で完全に開かれたアクティベーションをサポートするには、が使用されるメニュー リソースとほぼ同じのメニュー リソースを作成します。  このメニュー リソースへの変更は、サーバーが複合ドキュメントに埋め込まれている項目で実行するという事実を反映している項目が反復処理されることです。  
  
 変更に加えてこの記事でリソース ファイル、Microsoft Foundation Class ライブラリの実装に必要な AFXOLESV.RC を含める必要があります。指定します。  このファイルは MFC\\Include のサブディレクトリにあります。  
  
##  <a name="_core_server_application_accelerator_table_additions"></a> サーバー アプリケーションのアクセラレータ テーブルの追加  
 2 種類の新しいアクセラレータ テーブル リソースは、サーバー アプリケーションに追加する必要があります; これらは、前に説明した新しいメニュー リソースに直接対応しています。  最初のアクセラレータ テーブルがサーバー アプリケーションをアクティブ化するときに使用します。  これはファイルとウィンドウ メニューに関連付けられた以外ビューのアクセラレータ テーブルのエントリから構成されます。  
  
 2 番目のテーブルは、アクセラレータ テーブルでほぼ同じコピーです。  変更された [メニュー追加サーバー](#_core_server_menu_additions)で説明した完全に開いたメニューの相違点の並列変更。  
  
 これらのアクセラレータ テーブルの変更例については、MFC サンプルの OLE [HIERSVR](../top/visual-cpp-samples.md)に含まれる HIERSVR.RC ファイルの **IDR\_MAINFRAME** と **IDR\_HIERSVRTYPE\_SRVR\_IP** と **IDR\_HIERSVRTYPE\_SRVR\_EMB** のアクセラレータ テーブルを比較します。  ファイルとウィンドウのアクセラレータは埋め込み先編集用のテーブルされない、それらの正確なコピーが埋め込まれたなテーブルにあります。  
  
##  <a name="_core_string_table_additions_for_server_applications"></a> サーバー アプリケーションのストリング テーブルの追加  
 1 個のストリング テーブルを追加することだけサーバー アプリケーション— OLE 初期化に失敗したことを示す文字列が必要です。  たとえば、アプリケーション ウィザードで生成されたストリング テーブルのエントリを次に示します。:  
  
|ID|String|  
|--------|------------|  
|**IDP\_OLE\_INIT\_FAILED**|OLE の初期化に失敗しました。  OLE ライブラリのバージョンが正しいことを確認してください。|  
  
##  <a name="_core_mini.2d.server_additions"></a> ミニサーバーの追加  
 同じ追加は、サーバーに上記のものとしてミニサーバーに適用されます。  ミニサーバーは独立モードで実行できないため、メイン メニューはとても小さいです。  アプリケーション ウィザードで作成されるメイン メニュー項目に終了だけを含むファイル メニューだけになります。  ミニサーバーの埋め込まれた、埋め込み先編集用メニュー アクセラレータは同じサーバー全体のものです。  
  
## 参照  
 [メニューとリソース \(OLE\)](../mfc/menus-and-resources-ole.md)   
 [メニューとリソース : メニューの結合](../mfc/menus-and-resources-menu-merging.md)