---
title: "テクニカル ノート 48: MFC データベース アプリケーション用の ODBC セットアップおよび管理プログラムの作成 | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.mfc.odbc"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "インストール (ODBC を)"
  - "MFC, データベース アプリケーション"
  - "ODBC, および MFC"
  - "ODBC, インストール"
  - "セットアップ, ODBC セットアップ プログラム"
  - "TN048"
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
caps.latest.revision: 9
caps.handback.revision: 5
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# テクニカル ノート 48: MFC データベース アプリケーション用の ODBC セットアップおよび管理プログラムの作成
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

> [!NOTE]
>  次のテクニカル ノートは、最初にオンライン ドキュメントの一部とされてから更新されていません。  結果として、一部のプロシージャおよびトピックが最新でないか、不正になります。  最新の情報について、オンライン ドキュメントのキーワードで関係のあるトピックを検索することをお勧めします。  
  
 MFC データベース クラスを使用するアプリケーションを、ODBC コンポーネントをインストールするセットアップ プログラムを必要とします。  また、既定ドライバーを指定し、データ ソースを設定するために使用できるドライバーについての情報を、取得する ODBC プログラムの管理が必要な場合があります。  ここでは、ODBC のインストーラー API の使用をこれらのプログラムの作成について説明します。  
  
##  <a name="_mfcnotes_writing_an_odbc_setup_program"></a> ODBC のセットアップ プログラムを作成できます。  
 MFC データベース アプリケーションは ODBC ドライバー マネージャー \(ODBC.DLL\) と ODBC ドライバーがデータ ソースにより要求します。  多くの ODBC ドライバーが追加およびネットワーク通信 DLL が必要です。  ほとんどの ODBC ドライバーは、ODBC の必須コンポーネントをインストールするセットアップ プログラムが付属しています。  MFC データベース クラスを使用してアプリケーションを開発する場合は、T:  
  
-   ODBC コンポーネントをインストールするためのドライバー固有のセットアップ プログラムを使用します。  これは、パート開発者のさらに作業を、ドライバーのセットアップ プログラムを再配布する必要はありません。  
  
-   また、ODBC ドライバー マネージャーとドライバーをインストールする独自のセットアップ プログラムを作成できます。  
  
 ODBC インストーラー API でアプリケーション固有のセットアップ プログラムを作成するために使用できます。  インストーラー API 関数は、ODBC のインストーラー DLL — ODBCINST.DLL と Win32 の 16 ビットの Windows ODBCCP32.DLL によって実装されます。  アプリケーションは、ODBC ドライバー マネージャー、ODBC ドライバーと必要な変換をインストールするための **SQLInstallODBC** DLL を呼び出すことができます。  次に、ODBCINST.INI ファイル レコード \(または NT レジストリにインストールされているドライバーと変換を呼び出します。  **SQLInstallODBC** は、インストールされるドライバーの一覧が表示され、各ドライバーを構成するファイルを記述する ODBC.INF ファイルへの完全パスが必要です。  また、ドライバー マネージャー、および変換に関する同様の情報が含まれています。  ODBC.INF ファイルはドライバー開発者によって通常提供されます。  
  
 プログラムでは、個別の ODBC コンポーネントをインストールできます。  ドライバー マネージャーをクリックし、プログラムの最初の呼び出し **SQLInstallDriverManager** ドライバー マネージャーのターゲット ディレクトリを取得するインストーラー DLL にインストールします。  これは、通常、Windows DLL が格納されているディレクトリです。  プログラムは ODBC.INF ファイルの ODBC ドライバー マネージャー\[\]セクションで、セットアップ ディスクからこのディレクトリにドライバー マネージャーと関連ファイルをコピーするために情報を使用します。  個々のドライバーをプログラミングの最初の呼び出し **SQLInstallDriver** ODBCINST.INI ファイルまたは NT レジストリにドライバー固有\) を追加するには、インストーラー DLL にインストールします。  **SQLInstallDriver** は ドライバーのターゲット ディレクトリ— Windows DLL が存在する通常ディレクトリ\) を返します。  プログラムは、ドライバーの ODBC.INF ファイルのセクションで、セットアップ ディスクからこのディレクトリにドライバー DLL と関連ファイルをコピーするために情報を使用します。  
  
 ODBC.INF、ODBCINST.INI とインストーラー API を使用する詳細については、ODBC SDK *Programmer's Reference の* 19 番目の ODBC のソフトウェアをインストールする章を参照します。  
  
##  <a name="_mfcnotes_writing_an_odbc_administrator"></a> ODBC データ ソース アドミニストレーターを記述できます。  
 MFC データベース アプリケーションに次の 2 とおりの方法の 1 種類の ODBC データ ソースをセットアップおよび構成する:  
  
-   ODBC データ ソース アドミニストレーターを使用して \(プログラムまたはコントロール パネル項目として使用可能\)。  
  
-   データ ソースを構成する独自のプログラムを作成します。  
  
 データ ソースを構成するプログラムはインストーラーに DLL 関数を呼び出します。  インストーラー DLL はデータ ソースを構成するセットアップ DLL を呼び出します。  各ドライバーでは 1 種類のセットアップされた DLL があります。; これは、ドライバー DLL 自体または別の DLL である場合があります。  セットアップ DLL はドライバーがデータ ソースおよび既定の変換に接続する必要がある情報の入力を促しますサポートされる。  次に、ODBC.INI 呼び出し \(ファイルまたはレジストリ\) の情報を記録するには、インストーラーの DLL と Windows API を示します。  
  
 ユーザーが追加できるダイアログ ボックスを表示するには、変更したデータ ソース、DLL のインストーラー プログラム **SQLManageDataSources** 呼び出しを削除します。  この関数は、インストーラー DLL がコントロール パネルから呼び出されたときに呼び出されます。  追加するには、変更したり、データ ソース、データ ソースに関連付けられているドライバーのセットアップ DLL の **SQLManageDataSources** の呼び出し **ConfigDSN** を削除します。  直接追加するには、変更したり、データ ソース、DLL のインストーラー プログラム **SQLConfigDataSource** 呼び出しを削除します。  プログラムでデータ ソースと実行するアクションを指定するオプションの名前を渡します。  **SQLConfigDataSource** は セットアップ DLL の **ConfigDSN** を呼び出し、それに **SQLConfigDataSource**から引数を渡します。  
  
 詳細については、ODBC SDK *Programmer's Reference、* Chapter 23、セットアップ DLL 関数リファレンス、第 24 のインストーラー DLL 関数リファレンス章を参照します。  
  
## 参照  
 [番号順テクニカル ノート](../mfc/technical-notes-by-number.md)   
 [カテゴリ別テクニカル ノート](../mfc/technical-notes-by-category.md)