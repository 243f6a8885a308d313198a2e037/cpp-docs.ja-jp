---
title: "チュートリアル: MFC によるリボン アプリケーションの作成 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "作成 (リボン アプリケーションを) (MFC)"
  - "リボン アプリケーション, 作成 (MFC)"
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
caps.latest.revision: 21
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 17
---
# チュートリアル: MFC によるリボン アプリケーションの作成
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

このチュートリアルでは、MFC アプリケーション ウィザードを使用して、既定でリボンを備えたアプリケーションを作成する方法を説明します。  このようなアプリケーションを作成すると、**\[お気に入り\]** リボン パネルを持つ **\[カスタム\]** リボン カテゴリを追加し、頻繁に使用するいくつかのコマンドをそのパネルに追加して、リボンを拡張できます。  
  
## 必須コンポーネント  
 このチュートリアルは、**全般的な開発設定**を使用するように [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] を設定していることを前提としています。  別の設定を使用している場合は、次の手順に示されているいくつかのユーザー インターフェイス \(UI\) 要素が既定では表示されないことがあります。  設定を変更する方法の詳細については、「[How to: Reset Your Settings](http://msdn.microsoft.com/ja-jp/c95c51be-e609-4769-abba-65e6beedec76)」を参照してください。  
  
### リボンを備えた MFC アプリケーションを作成するには  
  
1.  MFC アプリケーション ウィザードを使用して、リボンを備えた MFC アプリケーションを作成します。  ウィザードを起動するには、**\[ファイル\]** メニューの **\[新規作成\]** をポイントし、**\[プロジェクト\]** をクリックします。  
  
2.  **\[新しいプロジェクト\]** ダイアログ ボックスで、**\[インストールされたテンプレート\]** の **\[Visual C\+\+\]** ノードを展開し、**\[MFC\]** をクリックしてから **\[MFC アプリケーション\]** をクリックします。  プロジェクトの名前 \(`MFCRibbonApp` など\) を入力し、**\[OK\]** をクリックします。  
  
3.  MFC アプリケーション ウィザードの最初のページで、**\[次へ\]** をクリックします。  
  
4.  **\[アプリケーションの種類\]** ページの **\[表示スタイルと色\]** で、**\[Office 2007 \(青のテーマ\)\]** をクリックします。  その他の設定はそのままにします。  **\[次へ\]** をクリックします。  
  
5.  **\[複合ドキュメント サポート\]** ページで **\[なし\]** が選択されていることを確認し、**\[次へ\]** をクリックします。  
  
6.  **\[ドキュメント テンプレート文字列\]** ページの \[**ファイル拡張子**\] ボックスに、このアプリケーションが作成するドキュメントのファイル名拡張子、たとえば「`mfcrbnapp`」を入力します。  **\[次へ\]** をクリックします。  
  
7.  **\[データベース サポート\]** ページで **\[なし\]** が選択されていることを確認し、**\[次へ\]** をクリックします。  
  
8.  **\[ユーザー インターフェイス機能\]** ページで、**\[リボンを使用する\]** が選択されていることを確認します。  **\[次へ\]** をクリックします。  
  
9. 既定では、**MFC アプリケーション ウィザード**はドッキング ペインのサポートをいくつか追加します。  ただし、このチュートリアルで説明するのはリボンについてのみであるため、アプリケーションからこれらのオプションを削除します。  **\[高度な機能\]** ページで、オプションをすべてオフにします。  **\[次へ\]** をクリックします。  
  
10. **\[生成されたクラス\]** ページで **\[完了\]** をクリックして、MFC アプリケーションの作成を実行します。  
  
11. アプリケーションが正常に作成されたことを確認するために、アプリケーションをビルドして実行します。  ソリューションをビルドするには、**\[ビルド\]** メニューの **\[ソリューションのビルド\]** をクリックします。  アプリケーションが正常にビルドされたら、**\[デバッグ\]** メニューの **\[デバッグ開始\]** をクリックして、アプリケーションを実行します。  
  
     ウィザードは、**\[ホーム\]** という名前の 1 つのリボン カテゴリを持つリボンを自動的に作成します。  このリボンには、**\[クリップボード\]**、**\[ビュー\]**、および **\[ウィンドウ\]** という名前の 3 つのリボン パネルが含まれています。  
  
### カテゴリとパネルをリボンに追加するには  
  
1.  ウィザードが作成したリボン リソースを開くには、**\[表示\]** メニューで **\[その他のウィンドウ\]** をポイントし、**\[リソース ビュー\]** をクリックします。  **\[リソース ビュー\]** で、**\[リボン\]** をクリックし、**\[IDR\_RIBBON\]** をダブルクリックします。  
  
2.  最初に **\[ツールボックス\]** 内の **\[カテゴリ\]** をダブルクリックし、カスタム カテゴリをリボンに追加します。  
  
     Category1 というキャプションのカテゴリが作成されます。  既定では、カテゴリにはパネルが 1 つあります。  
  
     Category1 を右クリックし、**\[プロパティ\]** をクリックします。  **\[プロパティ\]** ウィンドウで、**\[キャプション\]** を「`カスタム`」に変更します。  
  
     **\[大きいイメージ\]** プロパティと **\[小さいイメージ\]** プロパティでは、このカテゴリのリボン要素のアイコンとして使用されるビットマップを指定します。  カスタムのビットマップの作成はこのチュートリアルの対象外であるため、ウィザードで作成されたビットマップをそのまま使用します。  小さいビットマップは 16 × 16 ピクセルです。  小さいイメージには、IDB\_FILESMALL というリソース ID でアクセスされるビットマップを使用します。  大きいビットマップは 32 × 32 ピクセルです。  大きいイメージには、IDB\_FILELARGE というリソース ID でアクセスされるビットマップを使用します。  
  
    > [!NOTE]
    >  高解像度 \(HDPI: High Dots per Inch\) 表示では、HDPI 版のイメージが自動的に使用されます。  
  
3.  次は、パネルをカスタマイズします。  パネルは、互いに論理的に関連する項目をグループ化するために使用されます。  たとえば、このアプリケーションの **\[ホーム\]** タブの **\[切り取り\]**、**\[コピー\]**、および **\[貼り付け\]** の各コマンドをすべて **\[クリップボード\]** パネルに配置します。  パネルをカスタマイズするには、**\[Panel1\]** を右クリックしてから **\[プロパティ\]** をクリックします。  **\[プロパティ\]** ウィンドウで、**\[キャプション\]** を「`お気に入り`」に変更します。  
  
     パネルの **\[イメージ インデックス\]** を指定できます。  この番号により、リボン パネルをクイック アクセス ツール バーに追加した場合に表示されるアイコンが指定されます。  このアイコンは、リボン パネルそのものには表示されません。  
  
4.  リボンのカテゴリとパネルが正しく作成されたことを確認するために、リボン コントロールをプレビューします。  **\[Ribbon エディター ツール バー\]** の **\[Ribbon のテスト\]** をクリックします。  **\[カスタム\]** タブと **\[お気に入り\]** パネルがリボンに表示されます。  
  
### リボン パネルに要素を追加するには  
  
1.  前の手順で作成したパネルに要素を追加するには、**\[ツールボックス\]** の **\[リボン エディター\]** セクションからデザイン ビュー内のパネルにコントロールをドラッグします。  
  
2.  まず、**\[印刷\]** ボタンを追加します。  **\[印刷\]** ボタンには、既定のプリンターを使用して印刷する **\[クイック印刷\]** コマンドを含むサブメニューを指定します。  このアプリケーションに対して、両方のコマンドが既に定義されています。  これらはアプリケーションのメニュー内にあります。  
  
     **\[印刷\]** ボタンを作成するために、Button ツールをパネルにドラッグします。  
  
     **\[プロパティ\]** ウィンドウで、**\[ID\]** プロパティを定義済みの **\[ID\_FILE\_PRINT\]** に変更します。  **\[キャプション\]** を「`印刷`」に変更します。  **\[イメージ インデックス\]** を「`4`」に変更します。  
  
     **\[クイック印刷\]** ボタンを作成するには、**\[メニュー項目\]** の隣にあるプロパティの値列をクリックしてから、省略記号 \(**...**\) をクリックします。  **\[項目エディター\]** で、ラベルのない **\[追加\]** をクリックしてメニュー項目を作成します。  **\[プロパティ\]** ウィンドウで、**\[キャプション\]**、**\[ID\]**、**\[イメージ\]** を、それぞれ「`クイック印刷`」、「`ID_FILE_PRINT_DIRECT`」、「`5`」に変更します。  イメージのプロパティは IDB\_FILESMALL ビットマップ リソースの中にある \[高速印刷\] アイコンを指定します。  
  
3.  ボタンがリボン パネルに追加されたことを確認するには、アプリケーションをビルドして実行します。  ソリューションをビルドするには、**\[ビルド\]** メニューの **\[ソリューションのビルド\]** をクリックします。  アプリケーションが正常にビルドされたら、**\[デバッグ\]** メニューの **\[デバッグ開始\]** をクリックして、アプリケーションを実行します。  リボンの **\[カスタム\]** タブの **\[お気に入り\]** パネルに **\[印刷\]** ボタンとコンボ ボックスが表示されます。  
  
## 次の手順  
 [方法: クイック アクセス ツール バーをカスタマイズする](../mfc/how-to-customize-the-quick-access-toolbar.md)  
  
 [方法: アプリケーション ボタンをカスタマイズする](../mfc/how-to-customize-the-application-button.md)  
  
 エンド ツー エンドのサンプルについては、["Samples \(MFC Feature Pack\) \(サンプル \(MFC Feature Pack\)\)"](../top/visual-cpp-samples.md) を参照してください。  
  
## 参照  
 [チュートリアル](../mfc/walkthroughs-mfc.md)   
 ["Samples \(MFC Feature Pack\) \(サンプル \(MFC Feature Pack\)\)"](../top/visual-cpp-samples.md)