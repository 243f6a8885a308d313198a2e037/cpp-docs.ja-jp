---
title: "2.3 parallel Construct | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
ms.assetid: 190eacdf-2c16-4c06-8cb7-ac60eb211425
caps.latest.revision: 7
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# 2.3 parallel Construct
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

次のディレクティブを複数のスレッドで同時に実行されるプログラムの一部である並列領域を定義します。  これは並列実行を開始する基本的な構造です。  
  
```  
#pragma omp parallel [clause[ [, ]clause] ...] new-line  
   structured-block  
```  
  
 *句は* 次のいずれかです :  
  
 **\(** の  *スカラー式* **\)**  
  
 **\(プライベート**   *変数*  の  *リスト* **\)**  
  
 **\(firstprivate**  *変数*  の  *リスト* **\)**  
  
 **既定値 \(共有 &#124; なし\)**  
  
 **\(共有**   *変数*  の  *リスト* **\)**  
  
 **\(copyin**  *変数*  の  *リスト* **\)**  
  
 **\(縮小**  の  *演算子の* **:**  *変数*  の  *リスト* **\)**  
  
 **\(num\_threads** の  *整数式* **\)**  
  
 スレッドが parallel コンストラクトを検出するとスレッドのチームでは次の条件の 1 つが当てはまる場合は作成されます :  
  
-   **If** の句はありません。  
  
-   **If** の式はゼロ以外の値に評価されます。  
  
 このスレッドは 0 のスレッド番号を持つチームのマスター スレッドはしチームのすべてのスレッドはマスター スレッドが領域を並列実行します。  **If** の式の値がの場合領域がシリアル化されます。  
  
 要求されるスレッドの数を確認するには次の規則が順番に見なされます。  条件を満たす最初の規則が適用されます :  
  
1.  **num\_threads** の句がの場合整数式の値が要求するスレッドの数です。  
  
2.  **omp\_set\_num\_threads** ライブラリ関数を呼び出した場合は最後に実行した呼び出しの引数の値は要求したスレッドの数です。  
  
3.  環境変数 **OMP\_NUM\_THREADS** が定義されている場合この環境変数の値は要求されたスレッドの数です。  
  
4.  上記のメソッドでも使用されていない場合は要求されたスレッドの数は実装定義されます。  
  
 **num\_threads** の句がある場合に適用されている並列領域に対してのみ **omp\_set\_num\_threads** ライブラリ関数または **OMP\_NUM\_THREADS** 環境変数で要求するスレッドの数よりも優先されます。  後続の並列領域は影響を受けません。  
  
 並列領域を実装するスレッドの数はスレッドの数の動的な変更が有効かどうかによって決まります。  動的調整を無効にするとスレッドの要求された数は並列領域を実行します。  動的変更が有効になっているスレッドの要求された数は並列領域を実行できるスレッドの最大数です。  
  
 スレッドの数の動的な変更が無効になり並列領域に要求するスレッドの数が提供ランタイム システムができる数を超えると並列領域が発生した場合プログラムの動作は実装定義されます。  実装はたとえばプログラムの実行が中断される場合もありますが並列領域をシリアル化する場合があります。  
  
 **omp\_set\_dynamic** ライブラリ関数と **OMP\_DYNAMIC** の環境変数がスレッド数を動的に調整を有効または無効にすることができます。  
  
 実際にスレッドをホストする物理プロセッサの数は必ず実装定義されます。  作成するとチーム内のスレッドの数は並列領域の期間にわたって一定です。  これはユーザーが自動的に 1 個の並列領域間でランタイム システムによって明示的に変更できます。  
  
 並列領域の動的範囲に含まれるステートメントは各スレッドによって実行され各スレッドが他のスレッドとは異なるパスのステートメントを実行できます。  並列領域の構文の範囲外にあるディレクティブはデタッチされたディレクティブと呼ばれます。  
  
 並列領域の端に暗黙的なバリアがあります。  チームのマスター スレッドが並列領域に実行が継続されます。  
  
 並列領域を実行しているチームのスレッドが別の parallel コンストラクトが発生した場合は新しいチームを作成しその新しいチームのマスターになります。  入れ子になった並列領域が既定でシリアル化されます。  したがって既定では入れ子になった並列領域は1 種類のスレッドで構成されたチームによって実装されます。  既定の動作はランタイム ライブラリ関数 **omp\_set\_nested** または環境変数 **OMP\_NESTED** を使用して変更できます。  ただし入れ子になった並列領域を担当するチーム内のスレッドの数は実装定義されます。  
  
 **並列**  のディレクティブに制限 : は次のとおりです。  
  
-   最大で 1 **If** の二つの句ではディレクティブで使用できます。  
  
-   この場合は式または **num\_threads** の式が実行されていないかどうかの内側の副作用。  
  
-   並列領域内で実行される **throw** によっては構造化ブロックの動的スコープ内で再開する例外をスローした同じスレッドでキャッチされない場合があります。  
  
-   **num\_threads** の一つの句だけがディレクティブに表示できます。  **num\_threads** の式は並列領域のコンテキストの外側に評価され正の整数値に評価される必要があります。  
  
-   **If**  と **num\_threads** の句の評価の順序が指定されていません。  
  
## cref:  
  
-   **プライベート  firstprivate  既定   共有  copyin** と  **リダクション**  の句はページの 25 [セクション 2.7.2](../Topic/2.7.2%20Data-Sharing%20Attribute%20Clauses.md) が表示されます。  
  
-   **OMP\_NUM\_THREADS** の環境変数ページの 48 [セクション 4.2](../../parallel/openmp/4-2-omp-num-threads.md)。  
  
-   **omp\_set\_dynamic** ライブラリ関数はページの 39 [セクション 3.1.7](../../parallel/openmp/3-1-7-omp-set-dynamic-function.md) が表示されます。  
  
-   **OMP\_DYNAMIC** の環境変数はページの 49 [セクション 4.3](../../parallel/openmp/4-3-omp-dynamic.md) が表示されます。  
  
-   **omp\_set\_nested** の関数はページの 40 [セクション 3.1.9](../../parallel/openmp/3-1-9-omp-set-nested-function.md) が表示されます。  
  
-   **OMP\_NESTED** の環境変数はページの 49 [セクション 4.4](../Topic/4.4%20OMP_NESTED.md) が表示されます。  
  
-   **omp\_set\_num\_threads** ライブラリ関数はページの 36 [セクション 3.1.1](../../parallel/openmp/3-1-1-omp-set-num-threads-function.md) が表示されます。