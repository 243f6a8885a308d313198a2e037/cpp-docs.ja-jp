---
title: 'MFC: ドキュメントとビューを用いないデータベース クラスの使用 |Microsoft ドキュメント'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- ODBC applications [C++], without views
- documents [C++], applications without
- ODBC applications [C++]
- document/view architecture [C++], in databases
- files [C++], MFC
- database classes [C++], MFC
- CRecordView class, using in database applications
- database applications [C++], without views
- database applications [C++], application wizard options
- application wizards [C++], creating database applications
- ODBC [C++], file support in database applications
- ODBC applications [C++], without documents
- database applications [C++], without documents
- user interface [C++], drawing information
ms.assetid: 15bf52d4-91cf-4b1d-8b37-87c3ae70123a
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: ba2e59b53524975f87e4ad7ffe99b9a4a3cc870d
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/04/2018
ms.locfileid: "33093897"
---
# <a name="mfc-using-database-classes-without-documents-and-views"></a>MFC: ドキュメントとビューを用いないデータベース クラスの使用
場合があります、データベース アプリケーションのフレームワークのドキュメント/ビュー アーキテクチャを使用しない場合があります。 このトピックでは、次の内容について説明します。  
  
-   [ドキュメントを使用する必要がない場合](#_core_when_you_don.92.t_need_documents)ドキュメントのシリアル化などです。  
  
-   [アプリケーション ウィザードのオプション](#_core_appwizard_options_for_documents_and_views)シリアル化したりせずにアプリケーションをサポートするドキュメントに関連する**ファイル**メニューなどのコマンド**新規**、**開く**、**保存**、および**付けて**です。  
  
-   [最小限のドキュメントを使用するアプリケーションを使用する方法](#_core_applications_with_minimal_documents)です。  
  
-   [なしのドキュメントまたはビューを含むアプリケーションを構成する方法](#_core_applications_with_no_document)です。  
  
##  <a name="_core_when_you_don.92.t_need_documents"></a> ドキュメントを必要するときに  
 一部のアプリケーションでは、ドキュメントの異なる概念があります。 これらのアプリケーション通常、ほとんどすべてのファイルの記憶域からをメモリに読み込むと、**ファイルを開く**コマンド。 更新されたファイルに書き込みます記憶域をすべて一度に、**ファイルの保存の**または**名前を付けて保存**コマンド。 データ ファイルは、どのようなユーザーに表示されます。  
  
 ただし、アプリケーションの一部のカテゴリには、ドキュメントは不要です。 データベース アプリケーションは、トランザクションの観点から動作します。 アプリケーションでは、データベースからレコードを選択し、により、ユーザーは、多くの場合、1 つずつに表示します。 ユーザーには、通常、メモリ内で 1 つだけ可能性のある 1 つ現在レコードです。  
  
 アプリケーションでデータを格納するため、ドキュメントが必要ない場合は、フレームワークのドキュメント/ビュー アーキテクチャの一部またはすべてを提供できます。 省略する作業がどの程度は、必要に応じて方法によって異なります。 できます。  
  
-   シリアル化などの通常のドキュメントの機能を持つラベルは、データ ソースへの接続を保存する場所として、最小限のドキュメントを使用します。 これは、機能は、データのいくつかのビューを目的し、すべて同時に更新すること、すべてのビューを同期するために必要なときに便利です。  
  
-   先に描画する、直接ビューを使用するのではなく、フレーム ウィンドウを使用します。 この例では、ドキュメントを除外し、フレーム ウィンドウ オブジェクトにすべてのデータまたはデータ接続を格納します。  
  
##  <a name="_core_appwizard_options_for_documents_and_views"></a> ドキュメントとビューのアプリケーション ウィザードのオプション  
 MFC アプリケーション ウィザードが、いくつかのオプション**データベース サポートを選択して**、これは次の表に一覧表示されます。 MFC アプリケーション ウィザードを使用してアプリケーションを作成する場合、これらすべてのオプションは、ドキュメントとビューのアプリケーションを作成します。 いくつかのオプションは、ドキュメントと不要なドキュメント機能を省略するビューを提供します。 詳細については、次を参照してください。[データベースのサポート、MFC アプリケーション ウィザード](../mfc/reference/database-support-mfc-application-wizard.md)です。  
  
|オプション|表示|ドキュメント|  
|------------|----------|--------------|  
|**None**|`CView` の派生クラスです。|データベースのサポートを提供しません。 これは、既定の設定です。<br /><br /> 選択した場合、**ドキュメント/ビュー アーキテクチャ サポート** オプションを選択、[アプリケーションの種類、MFC アプリケーション ウィザード](../mfc/reference/application-type-mfc-application-wizard.md) ページで、シリアル化を含むドキュメントを完全サポートを取得し、 `New`、 **開いている**、**保存**、および**名前を付けて保存**コマンドを使って、**ファイル**メニュー。 参照してください[ドキュメントを持たないアプリケーション](#_core_applications_with_no_document)です。|  
|**ヘッダー ファイルのみ**|`CView` の派生クラスです。|アプリケーションの基本的なレベルのデータベースのサポートを提供します。<br /><br /> Afxdb.h が含まれます。 リンク ライブラリを追加しますが、すべてのデータベースに固有のクラスを作成できません。 レコード セットを後で作成しを使用して確認およびレコードを更新できます。|  
|**ファイル サポートのないデータベース ビュー**|を派生 `CRecordView`|ドキュメントのサポートがシリアル化はサポートされません。 ドキュメントはレコード セットを格納でき、複数のビューを調整シリアル化をサポートしていませんまたは`New`、**開く**、**保存**、および**名前を付けて保存**コマンド。 参照してください[最小限のドキュメントを持つアプリケーション](#_core_applications_with_minimal_documents)です。 データベース ビューを含める場合は、データのソースを指定する必要があります。<br /><br /> データベースのヘッダー ファイル、リンク ライブラリ、レコード ビュー、およびレコード セットが含まれます。 (アプリケーションに対してのみ使用可能な**ドキュメント/ビュー アーキテクチャ サポート**で選択したオプション、[アプリケーションの種類、MFC アプリケーション ウィザード](../mfc/reference/application-type-mfc-application-wizard.md)ページです)。|  
|**ファイルのサポートのあるデータベース ビュー**|を派生 `CRecordView`|シリアル化を含むドキュメントの完全なサポートを提供し、ドキュメントに関連する**ファイル**メニュー コマンド。 データベース アプリケーションでファイルごとのため必要はありませんシリアル化ではなく、通常、レコード単位で動作します。 ただし、シリアル化のための特別な用途があります。 参照してください[最小限のドキュメントを持つアプリケーション](#_core_applications_with_minimal_documents)です。 データベース ビューを含める場合は、データのソースを指定する必要があります。<br /><br /> データベースのヘッダー ファイル、リンク ライブラリ、レコード ビュー、およびレコード セットが含まれます。 (アプリケーションに対してのみ使用可能な**ドキュメント/ビュー アーキテクチャ サポート**で選択したオプション、[アプリケーションの種類、MFC アプリケーション ウィザード](../mfc/reference/application-type-mfc-application-wizard.md)ページです)。|  
  
 シリアル化とシリアル化のための別の使用に代わる方法の詳細については、次を参照してください。[シリアル化: シリアル化とします。データベースの入力/出力](../mfc/serialization-serialization-vs-database-input-output.md)です。  
  
##  <a name="_core_applications_with_minimal_documents"></a> 最小限のドキュメント アプリケーション  
 MFC アプリケーション ウィザードでは、フォーム ベースのデータ アクセス アプリケーションをサポートする 2 つのオプションがあります。 各オプションを作成、 `CRecordView`-派生ビュー クラスおよびドキュメント。 ドキュメントからのままに異なります。  
  
###  <a name="_core_a_document_without_file_support"></a> ファイルをサポートしないドキュメント  
 アプリケーション ウィザードのデータベース オプションを選択して**ファイル サポートのないデータベース ビュー**ドキュメントのシリアル化を必要としない場合。 ドキュメントには、次にさまざまな目的があります。  
  
-   格納する便利な場所である、`CRecordset`オブジェクト。  
  
     この使用法は通常のドキュメントの概念に対応して: ドキュメントのデータを格納する (または、この場合は、一連のレコード) のビューがドキュメントのビューとします。  
  
-   場合は、アプリケーションでは、複数のレコード ビュー) などの複数のビューでは、ドキュメントは、ビューの調整をサポートします。  
  
     複数のビューでは、同じデータを表示を使って、`CDocument::UpdateAllViews`任意のビューには、データが変更されたときに、すべてのビューへの更新を調整するメンバー関数。  
  
 通常、単純なフォーム ベースのアプリケーションでは、このオプションを使用します。 アプリケーションのウィザードは、自動的にアプリケーションなどの便利な構造をサポートします。  
  
###  <a name="_core_a_document_with_file_support"></a> ファイルをサポート ドキュメント  
 アプリケーション ウィザードのデータベース オプションを選択して**ファイル サポートのあるデータベース ビュー**ドキュメントに関連する用途がある場合**ファイル**メニュー コマンドやドキュメントのシリアル化します。 プログラムのデータ アクセス部分では、できるドキュメントを使用する、同じ方法で」の説明に従って[ファイルをサポートしないドキュメント](#_core_a_document_without_file_support)です。 たとえば、ドキュメントのシリアル化の機能を使用するユーザーの設定やその他の有用な情報を格納するシリアル化されたユーザー プロファイルのドキュメントを読み書きします。 詳細については、次を参照してください。[シリアル化: シリアル化とします。データベースの入力/出力](../mfc/serialization-serialization-vs-database-input-output.md)です。  
  
 アプリケーション ウィザードでは、このオプションが、ドキュメントをシリアル化するコードを記述する必要があります。 ドキュメント データ メンバーにシリアル化された情報を格納します。  
  
##  <a name="_core_applications_with_no_document"></a> ドキュメントを持たないアプリケーション  
 ドキュメントまたはビューを使用しないアプリケーションを作成したい場合があります。 データを格納するドキュメントを使わない場合 (など、`CRecordset`オブジェクト)、フレーム ウィンドウ クラス、または、アプリケーション クラスにします。 その他の要件は、アプリケーションがユーザー インターフェイスを表示するかどうかによって異なります。  
  
###  <a name="_core_database_support_with_a_user_interface"></a> ユーザー インターフェイスを持つデータベースのサポート  
 (その他のよりも、コンソール コマンド ライン インターフェイスなど) のユーザー インターフェイスがあれば、アプリケーションは、ビューではなく、フレーム ウィンドウのクライアント領域に直接を描画します。 このようなアプリケーションが使用しない`CRecordView`、 `CFormView`、または`CDialog`通常は、主要なユーザー インターフェイスを使用して`CDialog`通常ダイアログ。  
  
###  <a name="_core_writing_applications_without_documents"></a> ドキュメントを使用しないアプリケーションの作成  
 アプリケーションのウィザードでは、ドキュメントを使用しないアプリケーションの作成はサポートされていません、する必要があります、自分で作成`CWinApp`-クラスを派生し、必要な場合も作成、`CFrameWnd`または`CMDIFrameWnd`クラスです。 オーバーライド`CWinApp::InitInstance`としてアプリケーション オブジェクトを宣言します。  
  
```  
CYourNameApp theApp;  
```  
  
 フレームワークでは、メッセージ マップ機構とその他の多くの機能も提供します。  
  
###  <a name="_core_database_support_separate_from_the_user_interface"></a> データベースのユーザー インターフェイスとは別のサポート  
 一部のアプリケーションでは、ユーザー インターフェイスのない、または最低限の 1 つだけ必要があります。 たとえば、作成するいるとします。  
  
-   その他のアプリケーション (クライアント) を呼び出し、アプリケーションとデータ ソース間でデータの特別な処理を中間のデータ アクセス オブジェクト。  
  
-   1 つのデータベース形式から別または計算を行うし、バッチ更新を実行する 1 つにデータを移動するアプリケーションなど、ユーザーの介入なしのデータを処理するアプリケーション。  
  
 ドキュメントを所有していないため、`CRecordset`オブジェクト、多くの場合、埋め込みデータ メンバーとして格納する、 `CWinApp`-アプリケーション クラスを派生します。 代替手段は、次のとおりです。  
  
-   永続的な状態に維持しない`CRecordset`すべてのオブジェクトします。 渡すことができます**NULL**レコード セット クラスのコンス トラクターにします。 フレームワークが一時的なを作成する場合は、`CDatabase`オブジェクトのレコード セットの情報を使用して`GetDefaultConnect`メンバー関数。 これは、最も可能性の高い方法です。  
  
-   作成、`CRecordset`オブジェクトのグローバル変数。 この変数が動的に作成したレコード セット オブジェクトへのポインターにする必要があります、`CWinApp::InitInstance`をオーバーライドします。 これは、フレームワークが初期化される前に、オブジェクトを作成する際に回避できます。  
  
-   レコード セット オブジェクトを使用して、ドキュメントまたはビューのコンテキスト内と同様です。 メンバーに、アプリケーションまたはフレーム ウィンドウ オブジェクトの関数に対応するレコード セットを作成します。  
  
## <a name="see-also"></a>関連項目  
 [MFC データベース クラス](../data/mfc-database-classes-odbc-and-dao.md)