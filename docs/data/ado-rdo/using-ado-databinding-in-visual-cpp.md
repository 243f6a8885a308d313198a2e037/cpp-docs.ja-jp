---
title: "Visual C++ で ADO データ バインドを使用する | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "ADO [C++], データ バインド"
  - "バインド コントロール [C++], ADO"
  - "バインド コントロール [C++], RDO"
  - "データ バインディング [C++], ADO"
  - "データ バインディング [C++], RDO"
ms.assetid: ad193919-3437-41ee-b41c-9d353f6274e5
caps.latest.revision: 7
caps.handback.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Visual C++ で ADO データ バインドを使用する
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

Visual C\+\+ で ADO データ バインディングを使用するには、次の手順に従ってください。  
  
-   ADO データ連結コントロールを追加します。  
  
-   データ ソースをポイントします。  
  
-   レコード ソース \(SQL クエリまたはデータ取得言語\) を指定します。  
  
-   ADO データ連結コントロールを追加します。  
  
-   この ADO データ連結コントロールを ADO データ コントロールに接続します。  
  
-   ADO データ コントロールのレコード ソースに連結するフィールドを選択します。  
  
### Visual C\+\+ で ADO データ連結を使用するには  
  
1.  MFC アプリケーション ウィザードで、MFC ダイアログ アプリケーションまたは MFC フォームビュー アプリケーションを作成します。  
  
2.  ダイアログ ボックスに Microsoft ADO データ コントロールを追加します。「[Visual C\+\+ アプリケーションにコントロールを挿入する](../../data/ado-rdo/inserting-the-control-into-a-visual-cpp-application.md)」を参照してください。  
  
3.  ADO データ コントロールから OLE DB データ ソースをポイントします。  
  
    1.  ADO データ コントロールを右クリックし、**\[プロパティ\]** をクリックします。  
  
    2.  \[コントロール\] タブで、\[接続文字列を使用する\] をクリックします。  指定されたプロバイダーを使用するか、そのプロバイダーを削除します。  
  
    3.  **\[ビルド\]** をクリックします。  \[接続文字列を使用する\] でプロバイダーを削除した場合は、ここで新しいプロバイダーを定義できます。  プロバイダーの定義後に、ADO データ コントロールのプロパティに再度アクセスし、**\[ビルド\]** を再度クリックして、操作を続行します。  
  
         \[接続文字列を使用する\] でプロバイダーを定義してから **\[ビルド\]** をクリックした場合は、ここでデータ リンク プロパティを定義できます。  新しいリンクの作成ウィザードが表示されます。  
  
    4.  必要に応じて \[プロバイダー\] を変更し、プロバイダーに合わせて \[場所\] および **\[データ ソース\]** の値を定義します。  たとえば、SQL Server プロバイダーを使用する場合は、\[場所\] でデータベース サーバーを指定し、**\[データ ソース\]** でデータベースを指定します。  ODBC プロバイダーを使用する場合は、ODBC DSN に合わせて **\[データ ソース\]** を設定します。  
  
    5.  データ ソースによっては、\[認証\] タブをクリックし、\[ユーザー名\] および **\[パスワード\]** の値を設定する必要があります。  
  
    6.  **\[接続\]** タブをクリックし、\[接続のテスト\] をクリックしてデータ ソースをテストします。  \[結果\] ウィンドウの最後までスクロールして、テストに合格したかどうかを調べてください。  不合格の場合は、データ ソースの構成を調べます。  一般的なエラーの原因には、無効なパスワードや、\[場所\] フィールドおよび **\[データ ソース\]** フィールドの正しくない値があります。  
  
    7.  新しいリンクの作成ウィザードを終了し、ADO データ コントロールのプロパティ シートに戻ります。  
  
4.  `RecordSource` タブの \[コマンド テキスト \(SQL\)\] にクエリを入力します。  このクエリの結果にデータ連結コントロールを連結できます。  通常、クエリは SQL です。  ただし、SQL を使用しない OLE DB プロバイダーもあります。  
  
5.  必要に応じて、ADO データ コントロールのほかのプロパティを設定し、ADO データ コントロールのプロパティ シートを閉じます。  
  
6.  データ連結コントロールを追加します。  ここでは、DataGrid コントロールを追加します \(DataGrid コントロールは、RDO DBGrid コントロールとは異なります\)。  
  
7.  DataGrid のプロパティを設定します。  
  
    1.  DataGrid を右クリックし、**\[プロパティ\]** をクリックします。  
  
    2.  **\[全ページ\]** タブをクリックし、**DataSource** プロパティを ADO データ コントロールに設定します。  **DataSource** プロパティのドロップダウン リストをクリックし、この ADO データ コントロールの ID を選択します。  既定の ID 名は、IDC\_ADODC1 です。  
  
8.  Ctrl キーを押しながら T キーを押して、テスト モードを実行します。  データをスクロールできるようになります。  テスト モードを終了するには、**Esc** キーを押すか、ダイアログ ボックスを閉じます。  
  
 プログラムをコンパイルして実行すると、同じようにデータをスクロールできるようになります。  
  
## 参照  
 [ADO データ バインド](../../data/ado-rdo/ado-databinding.md)   
 [Visual C\+\+ で ActiveX コントロールによるデータ連結を行う](../../data/ado-rdo/databinding-with-activex-controls-in-visual-cpp.md)