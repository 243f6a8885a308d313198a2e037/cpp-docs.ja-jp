---
title: "単純なコンシューマーの作成 |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- OLE DB consumers, creating
ms.assetid: ae32d657-72ea-4db8-9839-75cb5cff68ae
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 553d4f8875812aa9453ec39e0e3223bd3463a31a
ms.sourcegitcommit: d51ed21ab2b434535f5c1d553b22e432073e1478
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/23/2018
---
# <a name="creating-a-simple-consumer"></a>単純なコンシューマーの作成
ATL プロジェクト ウィザードと ATL OLE DB コンシューマー ウィザードを使用すると、OLE DB テンプレート コンシューマーを生成できます。  
  
#### <a name="to-create-a-console-application-for-an-ole-db-consumer"></a>OLE DB コンシューマーのコンソール アプリケーションを作成するには  
  
1.  **[ファイル]** メニューの **[新規作成]**をポイントし、 **[プロジェクト]**をクリックします。  
  
     **[新しいプロジェクト]** ダイアログ ボックスが表示されます。  
  
2.  プロジェクトの種類 ペインで、をクリックして、 **Visual C プロジェクト**フォルダーをクリックして、 **Win32 プロジェクト**のテンプレート ペインのアイコン。 **名前**ボックスに、たとえば、プロジェクトの名前を入力**MyCons**です。  
  
3.  **[OK]**をクリックします。  
  
     Win32 プロジェクト ウィザードが表示されます。  
  
4.  **アプリケーション設定** ページで、**コンソール アプリケーション**、し、 **ATL のサポートを追加**です。  
  
5.  をクリックして**完了**ウィザードを終了し、プロジェクトを生成します。  
  
 次に、ATL OLE DB コンシューマー ウィザードを使用して、OLE DB コンシューマー オブジェクトを追加します。  
  
#### <a name="to-create-a-consumer-with-the-atl-ole-db-consumer-wizard"></a>ATL OLE DB コンシューマー ウィザードを使用してコンシューマーを作成するには  
  
1.  クラス ビュー ウィンドウで右クリックし、`MyCons`プロジェクト。  
  
2.  ショートカット メニューをクリックして**追加**、クリックして**クラスの追加**です。  
  
     **クラスの追加** ダイアログ ボックスが表示されます。  
  
3.  [カテゴリ] ウィンドウで、をクリックして**Visual C**をクリックして、 **ATL OLE DB コンシューマー**アイコンをクリックして [テンプレート] ペイン、**開いている**です。  
  
     ATL OLE DB コンシューマー ウィザードが表示されます。  
  
4.  クリックして、**データソース**ボタンをクリックします。  
  
     **データ リンク プロパティ** ダイアログ ボックスが表示されます。  
  
5.  **データ リンク プロパティ** ダイアログ ボックスで、次の操作します。  
  
    -   **プロバイダー** ] タブの [OLE DB プロバイダーを指定します。  
  
    -   **接続**タブで、サーバーでサーバー名、ログオン ID、およびデータ ソースおよびデータベースのパスワードを指定します。  
  
    > [!NOTE]
    >  セキュリティの問題がある、**パスワードを保存する**の機能、**データ リンク プロパティ** ダイアログ ボックス。 **、サーバーにログオン情報を入力して**、2 つのオプション ボタンがある: **Windows NT 統合セキュリティ**と**、特定のユーザー名とパスワードを使用して**です。  
  
    > [!NOTE]
    >  選択した場合**、特定のユーザー名とパスワードを使用して**、パスワードを保存するオプションがある (を使用して、**パスワードを保存する** チェック ボックスを)。 ただし、このオプションは安全ではありません。 選択することをお勧め**Windows NT 統合セキュリティ**; このオプションでは、Windows NT を使用して、id を確認します。  
  
    > [!NOTE]
    >  、Windows NT 統合セキュリティを使用できない場合は、ユーザー パスワードの入力を求めるまたはそれを保護するためのセキュリティ機構の場所にパスワードを保存する中間層アプリケーションを使用する必要があります (の代わりにソース コードで)。  
  
     プロバイダーとその他の設定を選択すると、をクリックして**Test-connection**を前のダイアログ ボックスのページで選択内容を確認します。 場合、**結果**レポートをボックス`Test connection succeeded`、 をクリックして**OK**データ リンクを作成します。  
  
     **データベース オブジェクトの選択** ダイアログ ボックスが表示されます。  
  
6.  ツリー コントロールを使用すると、テーブル、ビュー、またはストアド プロシージャを選択できます。 この手順のためには、Northwind データベースから、Products テーブルを選択します。  
  
7.  **[OK]**をクリックします。 ATL OLE DB コンシューマー ウィザードに戻ります。  
  
8.  ウィザードの完了の名`Class`と**.h ファイル**のテーブル、ビュー、名前に基づいているまたはストアド プロシージャを選択します。 場合は、これらの名前を編集できます。  
  
9. クリア、**属性**コンシューマー コードを使用して、ウィザードで作成できるようにチェック ボックスをオン[OLE DB テンプレート クラス](../../data/oledb/ole-db-consumer-templates-reference.md)、既定ではなく[OLE DB コンシューマー属性](../../windows/ole-db-consumer-attributes.md)です。  
  
10. **型****コマンド**です。  
  
     ウィザードで作成、 [CCommand](../../data/oledb/ccommand-class.md)-選択した場合、コンシューマーをベース**コマンド**または[CTable](../../data/oledb/ctable-class.md)-選択した場合、コンシューマーをベース**テーブル**です。 テーブルまたはコマンド クラスは、選択したオブジェクトの後という名前が、名前を編集することができます。  
  
11. **サポート**のままにして、**変更**、**挿入**、および**削除**ボックスをオフします。  
  
     選択、**変更**、**挿入**、および**削除**必要な場合に、変更、挿入、および行セット内のレコードの削除をサポートするためにチェック ボックスです。 ストアのデータへのデータの書き込みの詳細についてを参照してください[行セットの更新](../../data/oledb/updating-rowsets.md)です。  
  
12. をクリックして**完了**コンシューマーを作成します。  
  
 ウィザードが生成されますコマンド クラスとユーザー レコード クラスでは、ように[コンシューマー クラス](../../data/oledb/consumer-wizard-generated-classes.md)です。 コマンド クラスはで入力した名前になります、`Class`ボックス、ウィザードに (この場合、 `CProducts`) とユーザー レコード クラスは、フォームの名前が"*ClassName*アクセサー"(この場合、 `CProductsAccessor`)。  
  
> [!NOTE]
>  ウィザードでは、次の行を Products.h にします。  
  
```  
#error Security Issue: The connection string may contain a password  
```  
  
> [!NOTE]
>  この行は、コンシューマー アプリケーションをコンパイルをされなくなり、パスワードをハードコーディングの接続文字列を確認することを知らせます。 接続文字列を確認するには後に、、次のコード行を削除できます。  
  
## <a name="see-also"></a>参照  
 [ウィザードを使用した OLE DB コンシューマーの作成](../../data/oledb/creating-an-ole-db-consumer-using-a-wizard.md)