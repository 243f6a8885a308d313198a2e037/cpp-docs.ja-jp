---
title: "OLE DB オブジェクト モデル |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 2cd8fb90b7418b45f6bc011e8d4d0db6e04c08df
ms.sourcegitcommit: d51ed21ab2b434535f5c1d553b22e432073e1478
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/23/2018
---
# <a name="ole-db-object-model"></a>OLE DB オブジェクト モデル
OLE DB オブジェクト モデルには、次のオブジェクトまたはコンポーネントが構成されています。 最初の 4 つのオブジェクトまたはコンポーネントの一覧 (データ ソース、セッション、コマンド、および行セット) を使用すると、データ ソースに接続し、それを表示できます。 アクセサーから始まる残りの部分は、データが表示されるときの操作に関連します。  
  
## <a name="data-sources"></a>データ ソース  
 データ ソース オブジェクトを使用すると、ファイルまたはデータベース管理システムなどのデータ ソースに接続できます。 データ ソース オブジェクト作成の接続を管理、およびアクセス許可と認証情報 (ログイン名とパスワード) などが含まれています。 データ ソース オブジェクトには、1 つまたは複数のセッションを作成できます。  
  
## <a name="sessions"></a>セッション  
 セッションでは、クエリおよびデータを取得するデータ ソースと特定の相互作用を管理します。 各セッションは、1 つのトランザクションです。 トランザクションは、ACID テストによって定義された分割不可能な作業単位です。 ACID の定義では、次を参照してください。[トランザクション](#vcconoledbcomponents_transactions)です。  
  
 セッションは、行セットを開くと、それを作成したデータ ソース オブジェクトを返すなどの重要なタスクを実行します。 セッションでは、メタデータ、またはデータ ソース自体を (テーブル情報など) に関する情報を返すこともできます。  
  
 セッションは、1 つまたは複数のコマンドを作成できます。  
  
## <a name="commands"></a>コマンド  
 コマンドは、SQL ステートメントなどのテキスト コマンドを実行します。 テキスト コマンドが、SQL など、行セットを指定するかどうかは**選択**ステートメントでは、コマンドは、行セットを作成します。  
  
 コマンドは、単に、(など、SQL ステートメント) に渡された文字列、コンシューマーからデータ ソース オブジェクトの実行、プロバイダーの基になるデータ ストアでは、テキスト コマンドのコンテナーです。 通常、テキスト コマンドは、SQL**選択**ステートメント (ためにこの例では、SQL**選択**行セットを指定コマンドは、行セットを自動的に作成されます)。  
  
## <a name="rowsets"></a>行セット  
 行セットは、表形式でデータを公開します。 インデックスは、行セットの特殊なケースです。 セッションまたはコマンドからは、行セットを作成できます。  
  
### <a name="schema-rowsets"></a>スキーマ行セット  
 スキーマには、データベースに関するメタデータ (構造情報) が含まれます。 スキーマ行セットは、スキーマ情報が含まれている行セットです。 DBMS の一部の OLE DB プロバイダーは、スキーマ行セット オブジェクトをサポートします。 スキーマ行セットの詳細については、次を参照してください。[のスキーマ行セットのメタデータの取得](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)と[スキーマ行セット クラスと Typedef クラス](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)です。  
  
### <a name="view-objects"></a>オブジェクトの表示  
 ビュー オブジェクトは、行と行セットから列のサブセットを定義します。 独自のデータは含まれていません。 オブジェクトを表示するには、複数の行セットからデータを組み合わせることはできません。  
  
## <a name="accessors"></a>アクセサー  
 OLE DB だけでは、アクセサーの概念を使用します。 アクセサーは、コンシューマーにデータを格納する方法について説明します。 行セットのフィールド (列) と、コンシューマー内で宣言したデータ メンバーの間、一連バインド (列マップと呼ばれます) にはが含まれています。  
  
##  <a name="vcconoledbcomponents_transactions"></a> トランザクション  
 トランザクション オブジェクトは、コミットまたは最も低いレベル以外に入れ子になったトランザクションを中止するときに使用されます。 トランザクションは、ACID テストによって定義された分割不可能な作業単位です。 ACID を意味します。  
  
-   原子性: は、小さな作業単位に分割できません。  
  
-   Concurrency: 一度に 1 つ以上のトランザクションに発生します。  
  
-   分離: 1 つのトランザクションは、別の作業で加えられた変更に関する知識を制限されています。  
  
-   : の持続性トランザクションは、永続的な変更を加えます。  
  
## <a name="enumerators"></a>列挙子  
 列挙子は、使用可能なデータ ソースとその他の列挙子を検索します。 特定のデータ ソースのカスタマイズされていないコンシューマーでは、列挙子を使用して、使用するデータ ソースを検索します。  
  
 Microsoft Data Access SDK に付属して、ルート列挙子は、データ ソースとその他の列挙子を探して、レジストリを走査します。 他の列挙子は、プロバイダー固有の方法で、レジストリや検索を走査します。  
  
## <a name="errors"></a>エラー  
 OLE DB にあるオブジェクトに対する任意のインターフェイスは、エラーを生成できます。 エラーには、省略可能なカスタム エラー オブジェクトを含む、エラーに関する追加情報が含まれています。 この情報は、HRESULT に含まれます。  
  
## <a name="notifications"></a>通知  
 通知は、(での共有は、コンシューマーが、同じトランザクション内で動作するいると見なすこと) の行セットを共有する協調のコンシューマー グループによって使用されます。 通知は、協調動作するコンシューマーは行セットを共有ピアのによって実行される行セットに対する操作の通知を有効にします。  
  
## <a name="see-also"></a>参照  
 [OLE DB プログラミング](../../data/oledb/ole-db-programming.md)   
 [OLE DB プログラミングの概要](../../data/oledb/ole-db-programming-overview.md)