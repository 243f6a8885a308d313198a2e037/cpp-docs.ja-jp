---
title: "OLE DB オブジェクト モデル | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "OLE DB, オブジェクト モデル"
  - "行セット, OLE DB オブジェクト モデル"
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
caps.latest.revision: 8
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 8
---
# OLE DB オブジェクト モデル
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

OLE DB オブジェクト モデルは、次に示すオブジェクトまたはコンポーネントから構成されます。  最初の 4 つのオブジェクトまたはコンポーネント \(データ ソース、セッション、コマンド、および行セット\) を使用して、データ ソースに接続し、表示できます。  アクセサー以降の残りのオブジェクトまたはコンポーネントは、表示された場合のデータの処理に関係します。  
  
## データ ソース  
 データ ソース オブジェクトを使用して、ファイルや DBMS などのデータ ソースに接続できます。  データ ソース オブジェクトは、接続を作成および管理し、権限と認証情報 \(ログイン名やパスワードなど\) を格納します。  データ ソース オブジェクトは、1 つ以上のセッションを作成できます。  
  
## セッション  
 セッションは、データ ソースとの特定の対話を管理し、データを照会して取得します。  各セッションは単一のトランザクションです。  トランザクションは、ACID テストによって定義される、分割不能な作業単位です。  ACID の定義については、「[トランザクション](#vcconoledbcomponents_transactions)」を参照してください。  
  
 セッションは、行セットを開いたり、作成元のデータ ソース オブジェクトを返したりするなどの重要なタスクを実行します。  セッションは、メタデータ、つまりデータ ソース自体に関する情報 \(テーブル情報など\) も返すことができます。  
  
 セッションは、1 つ以上のコマンドを作成できます。  
  
## コマンド  
 コマンドは、SQL ステートメントなどのテキスト コマンドを実行します。  SQL **SELECT** ステートメントなどのように、テキスト コマンドで行セットが指定されている場合、コマンドは行セットを作成します。  
  
 コマンドは、テキスト コマンドの単なるコンテナーです。テキスト コマンドは、プロバイダーの基になるデータ ストアで実行するために、コンシューマーからデータ ソース オブジェクトに渡される文字列 \(SQL ステートメントなど\) です。  通常、テキスト コマンドは SQL **SELECT** ステートメントです。この場合、SQL **SELECT** は行セットを指定するため、コマンドでは自動的に行セットが作成されます。  
  
## 行セット  
 行セットは表形式のデータを公開します。  インデックスは特殊な行セットです。  行セットはセッションまたはコマンドから作成できます。  
  
### スキーマ行セット  
 スキーマには、データベースに関するメタデータ \(構造情報\) が含まれます。  スキーマ行セットは、スキーマ情報を含む行セットです。  DBMS 用の一部の OLE DB プロバイダーは、スキーマ行セット オブジェクトをサポートします。  スキーマ行セットの詳細については、「[スキーマ行セットを使用したメタデータの取得](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)」および「[スキーマ行セット クラスと Typedef クラス](../Topic/Schema%20Rowset%20Classes%20and%20Typedef%20Classes.md)」を参照してください。  
  
### ビュー オブジェクト  
 ビュー オブジェクトは、行のサブセットと行セットの列を定義します。  ビュー オブジェクト自体のデータは含まれません。  ビュー オブジェクトは、複数の行セットのデータを結合することはできません。  
  
## アクセサー  
 アクセサーの概念を使用するのは OLE DB だけです。  アクセサーは、コンシューマーでのデータの格納方法を記述します。  アクセサーには、行セット フィールド \(列\) とコンシューマーで宣言されるデータ メンバーとの間の連結 \(列マップと呼ぶ\) のセットが含まれます。  
  
##  <a name="vcconoledbcomponents_transactions"></a> トランザクション  
 トランザクション オブジェクトは、最下位レベル以外で入れ子になっているトランザクションをコミットまたは中止するときに使用されます。  トランザクションは、ACID テストによって定義される、分割不能な作業単位です。  ACID は、以下の性質を意味します。  
  
-   分割不能性 : より小さい作業単位に分割できません。  
  
-   同時実行 : 複数のトランザクションが同時に発生できます。  
  
-   分離性 : トランザクションは、別のトランザクションによって行われた変更に関してはわずかな知識しか得られません。  
  
-   持続性 : トランザクションによって行われる変更は永続的です。  
  
## 列挙子  
 列挙子は、使用できるデータ ソースとほかの列挙子を検索します。  特定のデータ ソース用にカスタマイズされていないコンシューマーは、列挙子を使用して、使用するデータ ソースを検索します。  
  
 Microsoft Data Access SDK に付属しているルート列挙子は、レジストリを走査してデータ ソースとほかの列挙子を検索します。  ほかの列挙子は、レジストリを走査するか、プロバイダー固有の方式で検索します。  
  
## エラー  
 OLE DB オブジェクトのインターフェイスではエラーが生成されることがあります。  エラーには、オプションのカスタム エラー オブジェクトを含む、エラーに関する追加情報が含まれます。  この情報は、HRESULT に格納されます。  
  
## 通知  
 通知は、行セットを共有する、相互に協調するコンシューマーのグループによって使用されます \(この場合、共有とは、コンシューマーが同じトランザクション内で動作すると想定されていることを意味します\)。  通知により、行セットを共有する協調コンシューマーには、それぞれのピアが行セットに対して実行したアクションが通知されます。  
  
## 参照  
 [OLE DB プログラミング](../../data/oledb/ole-db-programming.md)   
 [OLE DB プログラミングの概要](../../data/oledb/ole-db-programming-overview.md)