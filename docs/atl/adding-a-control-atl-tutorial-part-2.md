---
title: "コントロールの追加 (ATL チュートリアル、パート 2) | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "get-started-article"
dev_langs: 
  - "C++"
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
caps.latest.revision: 15
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 10
---
# コントロールの追加 (ATL チュートリアル、パート 2)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

このステップでは、コントロールをプロジェクトに追加し、ビルドして、Web ページでテストします。  
  
## 手順  
  
#### オブジェクトを ATL プロジェクトに追加するには  
  
1.  クラス ビューで、Polygon プロジェクトを右クリックします。  
  
2.  ショートカット メニューの **\[追加\]** をポイントし、サブメニューの **\[クラス\]** をクリックします。  
  
     **\[クラスの追加\]** ダイアログ ボックスが表示されます。  さまざまなオブジェクトのカテゴリが、左側にツリー構造で表示されます。  
  
3.  **\[ATL\]** フォルダーをクリックします。  
  
4.  右側にあるテンプレートの一覧から、**\[ATL コントロール\]** を選択します。  **\[追加\]** をクリックします。  ATL コントロール ウィザードが開き、コントロールを構成できます。  
  
5.  短い名前として、「`PolyCtl`」と入力します。他のフィールドは自動的に入力が完了しています。  一部変更を行う必要があるため、まだ **\[完了\]** はクリックしないでください。  
  
 ATL コントロール ウィザードの **\[名前\]** ページには、次のフィールドが含まれています。  
  
|フィールド|内容|  
|-----------|--------|  
|**\[短い名前\]**|コントロール用に入力した名前。|  
|**\[クラス\]**|コントロールを実装するために作成された C\+\+ クラス名。|  
|**\[.h ファイル\]**|C\+\+ クラスの定義を格納するために作成されたファイル。|  
|**\[.cpp ファイル\]**|C\+\+ クラスの実装を格納するために作成されたファイル。|  
|**\[CoClass\]**|このコントロールのコンポーネント クラスの名前。|  
|**インターフェイス**|コントロールがカスタム プロパティとメソッドを実装するインターフェイスの名前。|  
|**型**|コントロールの説明。|  
|**\[ProgID\]**|コントロールの CLSID を検索するために使用できる、判読可能な名前。|  
  
 ATL コントロール ウィザードで、いくつか追加設定を行う必要があります。  
  
#### 詳細なエラー情報と接続ポイントのサポートを有効にするには  
  
1.  **\[オプション\]** をクリックして **\[オプション\]** ページを開きます。  
  
2.  **\[接続ポイント\]** チェック ボックスをオンにします。  これにより、アウトゴーイング インターフェイスのサポートが IDL ファイルに作成されます。  
  
 また、コントロールを挿入可能にすることもできます。挿入可能とは、Excel や Word など、埋め込みオブジェクトをサポートするアプリケーションに埋め込むことができることを示します。  
  
#### コントロールを挿入可能にするには  
  
1.  **\[外観\]** をクリックし、**\[外観\]** ページを開きます。  
  
2.  **\[挿入可能\]** チェック ボックスをオンにします。  
  
 このオブジェクトによって表示される多角形には、単色による塗りつぶしを適用するため、"`Fill Color`" ストック プロパティを追加する必要があります。  
  
#### "塗りつぶしの色" ストック プロパティを追加するには、コントロールを作成します。  
  
1.  **\[ストック プロパティ\]** をクリックして **\[ストック プロパティ\]** ページを開きます。  
  
2.  **\[サポートなし\]** で、使用可能なストック プロパティの一覧をスクロール ダウンします。  "`Fill Color`" をダブルクリックして、**\[サポートあり\]** の一覧に移動します。  
  
3.  コントロールのオプションはこれで完了です。  **\[完了\]** をクリックします。  
  
 ウィザードによってコントロールが作成されると、コードの変更とファイルの追加がいくつか発生します。  次のファイルが作成されています。  
  
|ファイル|説明|  
|----------|--------|  
|PolyCtl.h|C\+\+ クラス `CPolyCtl` のほとんどの実装が格納されています。|  
|PolyCtl.cpp|`CPolyCtl` の残りの部分が格納されています。|  
|PolyCtl.rgs|コントロールの登録に使用するレジストリ スクリプトが格納されたテキスト ファイル。|  
|PolyCtl.htm|新しく作成されたコントロールへの参照が含まれた Web ページ。|  
  
 ウィザードにより、次のコード変更も行われています。  
  
-   コントロールのサポートに必要な ATL ファイルをインクルードするための `#include` ステートメントが、stdafx.h ファイルおよび stdafx.cpp ファイルに追加されています。  
  
-   新しいコントロールの詳細を含めるために Polygon.idl が変更されています。  
  
-   Polygon.cpp のオブジェクト マップに新しいコントロールが追加されています。  
  
 これで、コントロールをビルドして動作を確認できます。  
  
## コントロールのビルドとテスト  
  
#### コントロールをビルドおよびテストするには  
  
1.  **\[ビルド\]** メニューの **\[多角形のビルド\]** をクリックします。  
  
     コントロールのビルドが完了したら、**ソリューション エクスプローラー**で PolyCtl.htm を右クリックし、**\[ブラウザーで表示\]** をクリックします。  コントロールを含む HTML Web ページが表示されます。  ページには、"ATL 8.0 test page for object PolyCtl" \(オブジェクト PolyCtl の ATL 8.0 テスト ページ\) というタイトルと "**PolyCtl**" というテキストが表示されます。  これは、追加したコントロールです。  
  
> [!NOTE]
>  このチュートリアルの完了時に、エラー メッセージが表示されて DLL ファイルを作成できない場合は、PolyCtl.htm ファイルと ActiveX コントロール テスト コンテナーを閉じ、ソリューションを再度ビルドします。  それでも DLL を作成できない場合は、コンピューターを再起動するか、ログオフします \(ターミナル サービスを使用している場合\)。  
  
 次は、カスタム プロパティをコントロールに追加します。  
  
 [ステップ 1 に戻る](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [ステップ 3 に進む](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)  
  
## 参照  
 [チュートリアル](../Topic/Active%20Template%20Library%20\(ATL\)%20Tutorial.md)