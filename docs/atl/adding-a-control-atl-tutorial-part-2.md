---
title: コントロール (ATL チュートリアル、パート 2) の追加 |Microsoft ドキュメント
ms.custom: get-started-article
ms.date: 11/04/2016
ms.technology:
- cpp-atl
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: d3b8c7eb59579363ce3580c7319b80be2557a30d
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/03/2018
ms.locfileid: "32358577"
---
# <a name="adding-a-control-atl-tutorial-part-2"></a>コントロールの追加 (ATL チュートリアル、パート 2)
このステップでは、コントロールをプロジェクトに追加し、ビルドして、Web ページでテストします。  
  
## <a name="procedures"></a>手順  
  
#### <a name="to-add-an-object-to-an-atl-project"></a>オブジェクトを ATL プロジェクトに追加するには  
  
1.  クラス ビューで、Polygon プロジェクトを右クリックします。  
  
2.  をポイント**追加**クリックしてショートカット メニューの **新しい項目の**サブメニューにします。  
  
     **[新しい項目の追加]** ダイアログ ボックスが表示されます。 さまざまなオブジェクトのカテゴリが、左側にツリー構造で表示されます。  
  
3.  クリックして、 **ATL**フォルダーです。  
  
4.  、右側にあるテンプレートの一覧から選択**ATL コントロール**です。 **[追加]** をクリックします。 ATL コントロール ウィザードが開き、コントロールを構成できます。  
  
5.  型`PolyCtl`短い名前とその他のフィールドが自動的に完了したことに注意してください。 クリックしてしないでください**完了**変更を加える必要があるため、まだです。  
  
 ATL コントロール ウィザードの**名**ページには、次のフィールドが含まれています。  
  
|フィールド|目次|  
|-----------|--------------|  
|**短い名前**|コントロール用に入力した名前。|  
|**クラス**|コントロールを実装するために作成された C++ クラス名。|  
|**.h ファイル**|C++ クラスの定義を格納するために作成されたファイル。|  
|**.cpp ファイル**|C++ クラスの実装を格納するために作成されたファイル。|  
|**コクラス**|このコントロールのコンポーネント クラスの名前。|  
|**Interface**|コントロールがカスタム プロパティとメソッドを実装するインターフェイスの名前。|  
|**Type**|コントロールの説明。|  
|**ProgID**|コントロールの CLSID を検索するために使用できる、判読可能な名前。|  
  
 ATL コントロール ウィザードで、いくつか追加設定を行う必要があります。  
  
#### <a name="to-enable-support-for-rich-error-information-and-connection-points"></a>詳細なエラー情報と接続ポイントのサポートを有効にするには  
  
1.  をクリックして**オプション**を開くには、**オプション**ページ。  
  
2.  選択、**コネクション ポイント**チェック ボックスをオンします。 これにより、アウトゴーイング インターフェイスのサポートが IDL ファイルに作成されます。  
  
 また、コントロールを挿入可能にすることもできます。挿入可能とは、Excel や Word など、埋め込みオブジェクトをサポートするアプリケーションに埋め込むことができることを示します。  
  
#### <a name="to-make-the-control-insertable"></a>コントロールを挿入可能にするには  
  
1.  をクリックして**外観**を開くには、**外観**ページ。  
  
2.  選択、 **Insertable**チェック ボックスをオンします。  
  
 このオブジェクトによって表示される多角形には、単色による塗りつぶしを適用するため、"`Fill Color`" ストック プロパティを追加する必要があります。  
  
#### <a name="to-add-a-fill-color-stock-property-and-create-the-control"></a>"塗りつぶしの色" ストック プロパティを追加するには、コントロールを作成します。  
  
1.  をクリックして**ストック プロパティ**を開くには、**ストック プロパティ**ページ。  
  
2.  **はサポートされていません**、使用可能なストック プロパティの一覧を下にスクロールします。 ダブルクリックして`Fill Color`に移動する、**サポートされている** ボックスの一覧です。  
  
3.  コントロールのオプションはこれで完了です。 **[完了]** をクリックします。  
  
 ウィザードによってコントロールが作成されると、コードの変更とファイルの追加がいくつか発生します。 次のファイルが作成されています。  
  
|ファイル|説明|  
|----------|-----------------|  
|PolyCtl.h|C++ クラス `CPolyCtl` のほとんどの実装が格納されています。|  
|PolyCtl.cpp|`CPolyCtl` の残りの部分が格納されています。|  
|PolyCtl.rgs|コントロールの登録に使用するレジストリ スクリプトが格納されたテキスト ファイル。|  
|PolyCtl.htm|新しく作成されたコントロールへの参照が含まれた Web ページ。|  
  
 ウィザードにより、次のコード変更も行われています。  
  
-   コントロールのサポートに必要な ATL ファイルをインクルードするための `#include` ステートメントが、stdafx.h ファイルおよび stdafx.cpp ファイルに追加されています。  
  
-   新しいコントロールの詳細を含めるために Polygon.idl が変更されています。  
  
-   Polygon.cpp のオブジェクト マップに新しいコントロールが追加されています。  
  
 これで、コントロールをビルドして動作を確認できます。  
  
## <a name="building-and-testing-the-control"></a>コントロールのビルドとテスト  
  
#### <a name="to-build-and-test-the-control"></a>コントロールをビルドおよびテストするには  
  
1.  **ビルド** メニューのをクリックして**多角形のビルド**です。  
  
     コントロールには、ビルドが完了すると後で PolyCtl.htm を右クリックして**ソリューション エクスプ ローラー**選択**ブラウザーで表示**です。 コントロールを含む HTML Web ページが表示されます。 「オブジェクト PolyCtl の ATL 8.0 テスト ページ」タイトルとテキスト ページが表示されます**PolyCtl**です。 これは、追加したコントロールです。  
  
> [!NOTE]
>  このチュートリアルの完了時に、エラー メッセージが表示されて DLL ファイルを作成できない場合は、PolyCtl.htm ファイルと ActiveX コントロール テスト コンテナーを閉じ、ソリューションを再度ビルドします。 それでも DLL を作成できない場合は、コンピューターを再起動するか、ログオフします (ターミナル サービスを使用している場合)。  
  
 次は、カスタム プロパティをコントロールに追加します。  
  
 [手順 1 に戻る](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [ステップ 3 に進む](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)  
  
## <a name="see-also"></a>関連項目  
 [チュートリアル](../atl/active-template-library-atl-tutorial.md)

