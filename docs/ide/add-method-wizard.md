---
title: "メソッド追加ウィザード | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.codewiz.method.overview"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "メソッド追加ウィザード [C++]"
  - "メソッド [C++], 追加 (ウィザードを使用して)"
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# メソッド追加ウィザード
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

このウィザードを使用して、インターフェイスにメソッドを追加します。  メソッドを追加するプロジェクトの種類またはインターフェイスの種類に応じて、ウィザードにはさまざまなオプションが表示されます。  
  
## 名前  
 **\[戻り値の型\]**  
 メソッドから戻るデータ型です。  `HRESULT` は、エラーを返すための標準的な方法を提供するため、すべてのインターフェイスの種類でこの値が推奨値です。  
  
|インターフェイスの種類|Description|  
|-----------------|-----------------|  
|デュアル インターフェイス|`HRESULT`.  変更できません。|  
|カスタム インターフェイス|`HRESULT`.  変更できません。|  
|ローカル カスタム インターフェイス|戻り値の型を指定するか、一覧から選択します。|  
|ディスパッチ インターフェイス|戻り値の型を指定するか、一覧から選択します。|  
|MFC ActiveX コントロール ディスパッチ インターフェイス|ストック メソッドを実装する場合、戻り値の型は適切な値に設定され、変更できません。  \[メソッド名\] ボックスの一覧からメソッドを選択した場合は、\[メソッドの型\] の \[カスタム\] をクリックして戻り値の型を一覧から選択します。|  
  
 **\[メソッド名\]**  
 メソッドの名前を設定します。  
  
|インターフェイスの種類|Description|  
|-----------------|-----------------|  
|ATL デュアル インターフェイス、カスタム インターフェイス、およびローカル カスタム インターフェイス|メソッド名を指定します。|  
|MFC ディスパッチ インターフェイス|メソッド名を指定するか、表示されたメソッド名の一覧から選択します。  一覧から名前を選択した場合は、\[戻り値の型\] ボックスに適切な値が表示されます。この値は変更できません。|  
|MFC ActiveX コントロール ディスパッチ インターフェイス|メソッド名を指定するか、[DoClick](../Topic/COleControl::DoClick.md) と [Refresh](../Topic/COleControl::Refresh.md) のいずれかのストック メソッドを選択します。  詳細については、「[MFC ActiveX コントロール : ストック メソッドの追加](../mfc/mfc-activex-controls-adding-stock-methods.md)」を参照してください。|  
  
 **\[メソッドの型\]**  
 MFC ActiveX コントロールでだけ有効です。  一覧からメソッドを選択せずに、\[メソッド名\] ボックスでメソッド名を指定した場合、このボックスは無効です。  
  
 \[メソッド名\] ボックスからメソッドを選択した場合は、ストック実装またはカスタム実装のいずれかを選択します。  
  
|メソッドの型|Description|  
|------------|-----------------|  
|**ストック**|既定値です。  \[メソッド名\] ボックスで選択したメソッドのストック実装が挿入されます。  \[ストック\] を選択した場合、\[戻り値の型\] は変更できません。|  
|**Custom**|\[メソッド名\] ボックスで選択したメソッドのスタブ実装が挿入されます。  戻り値の型を設定することも、\[戻り値の型\] ボックスから選択することもできます。|  
  
 **\[内部名\]**  
 MFC ディスパッチ インターフェイスに追加されたカスタム メソッドでのみ有効です。  ディスパッチ マップ、ヘッダー ファイル \(.h\)、実装ファイル \(.cpp\) で使用される名前を設定します。  既定では、\[メソッド名\] と同じ名前になります。  MFC ディスパッチ インターフェイスで作業している場合や MFC ActiveX コントロール ディスパッチ インターフェイスにカスタム メソッドを追加している場合は、メソッド名を変更できます。  
  
|インターフェイスの種類|Description|  
|-----------------|-----------------|  
|ATL デュアル インターフェイス、カスタム インターフェイス、およびローカル カスタム インターフェイス|使用できません。|  
|MFC ディスパッチ インターフェイス|既定ではメソッド名になります。  この内部名は編集できます。|  
|MFC ActiveX コントロール ディスパッチ インターフェイス|内部名はカスタム メソッドでのみ設定できます。  ストック メソッドでは内部名は使用しません。|  
  
 **\[パラメーターの属性\]**  
 \[パラメーター名\] で指定されたパラメーターの追加の属性を設定します。  
  
|パラメーターの属性|Description|使用できる組み合わせ|  
|---------------|-----------------|----------------|  
|**In**|呼び出し元のプロシージャから呼び出し先のプロシージャにパラメーターが渡されることを示します。|**in** のみ<br /><br /> **in** および **out**|  
|**out**|呼び出し先のプロシージャから呼び出し元のプロシージャに \(サーバーからクライアントに\) ポインター パラメーターが返されることを示します。|**out** のみ<br /><br /> **in** および **out**<br /><br /> **out** および **retval**|  
|**retval**|メンバーの戻り値をパラメーターが受け取ることを示します。|**retval** および **out**|  
  
 **\[パラメーターの型\]**  
 パラメーターのデータ型を設定します。  一覧から型を選択します。  
  
 **\[パラメーター名\]**  
 メソッドを通じて渡すパラメーターの名前を設定します。  パラメーター名を入力したら、\[追加\] をクリックして、メソッドを通じて渡されるパラメーターの一覧に追加する必要があります。  パラメーター名を指定しない場合、パラメーターのすべての属性 \(ATL のみ\) と \[パラメーターの型\] の選択項目がウィザードで無視されます。  
  
 \[追加\] をクリックすると、入力したパラメーター名が **\[パラメーターの一覧\]** に表示されます。  
  
 **メモ** パラメーター名を指定し、\[追加\] をクリックする前に \[完了\] をクリックした場合、パラメーターはメソッドに追加されません。  メソッドを見つけて、パラメーターを手動で挿入する必要があります。  
  
 **\[追加\]**  
 \[パラメーター名\] で指定したパラメーターおよびその型と属性を **\[パラメーターの一覧\]** に追加します。  パラメーターを一覧に追加するには \[追加\] をクリックする必要があります。  
  
 **\[削除\]**  
 \[パラメーターの一覧\] で選択したパラメーターを一覧から削除します。  
  
 **\[パラメーターの一覧\]**  
 メソッドに現在追加されているすべてのパラメーター、およびその修飾子と型を表示します。  パラメーターを追加すると、ウィザードは **\[パラメーターの一覧\]** を更新して、各パラメーターおよびその修飾子と型を再表示します。  
  
## 参照  
 [メソッドの追加](../ide/adding-a-method-visual-cpp.md)   
 [\[IDL 属性\] \(メソッド追加ウィザード\)](../Topic/IDL%20Attributes,%20Add%20Method%20Wizard.md)